<!-- NAME: main.tpl -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
  <head>
    <title>L i n u x [inetdoc]: (Guides) </title>
    <meta HTTP-EQUIV="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="Content-Language" content="fr">
    <meta name="description" content="inet doc linux">
    <meta name="author" content="philippe.latu@linux-france.org">
    <meta name="copyright" content="(c)2000 Philippe Latu">
    <meta name="publisher" content="philippe.latu@linux-france.org">
    <meta name="keywords" content="documentation, ethernet, formation, guide, ieee, ifconfig, inet, interface, ip, iproute2, iptables, isdn, IUT, IUP, latu, linux, net, OSI, ping, reseau, RNIS, route, routage, TCP, TCP/IP, UDP">
    <meta name="audience" content="All, Tous">
    <meta name="robots" content="INDEX,FOLLOW">
    <link rel="STYLESHEET" type="text/css" href="/prj/inetdoc/style/docstyle.css">
    <script language="javascript" type="text/javascript">
      <!-- for javascript enabled browser's only
        if (top.location != location) top.location.href = location.href;
	
        function popup(form) {
          optionIndex = form.banner.SelectedIndex;
          if (optionIndex == 0) return;
          location.href = form.banner.options[form.banner.selectedIndex].value;
          }
      // end script hiding -->
    </script>
  </head>
<BODY BGCOLOR="#FFFFFF" TEXT="#990000" LINK="#990000" VLINK="#990000" ALINK="#990000" leftMargin="0" topMargin="0" marginheight="0" marginwidth="0">
<TABLE width=100% border=0 cellspacing=2 cellpadding=0 align=center>
  <TR>
    <TD width=25% bgcolor=#990000 align=center valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
        <TR align=right> 
	  <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
      	</TR>
	<TR>
	  <TD bgcolor=#990000 align=center>
	    <a class="nodecor" href="/prj/inetdoc">
              <IMG src="/prj/inetdoc/images/upleft.png" border=0 width=158 height=96 hspace=10 alt="logo">
      	    </a>
	  <TD>
	</TR>
      </TABLE>
    </TD>
    <TD width=75% bgcolor=#FFFFFF align=left valign=top>
      <!-- banner menu start -->
      <form>
        <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
	  <!-- 1st row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor=#FF9966>
	      <TABLE width="100%" border="0" cellspacing="3" cellpadding="0" width="100%">
	        <TR>
		  <th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/">&nbsp;Accueil</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/articles/">&nbsp;Articles</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/courses/">&nbsp;Cours</a>
</th>
<th align="left" valign="top" bgcolor="white">
  <a class="reduced" href="/prj/inetdoc/i/net/guides/">&nbsp;Guides</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/formation/">&nbsp;Formation</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/download/">&nbsp;Téléchargement</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/source/">&nbsp;Source</a>
</th>

		</TR>
	      </TABLE>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#FFFFFF><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <!-- 2nd row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor=#FFCC66>
	      <FONT color=#990000 size=-1 face="Arial, 'Myriad Web', Syntax, sans-serif"><B>
	       <SELECT name="banner" onChange="popup(this.form)">
	         <OPTION value="/prj/inetdoc/i/net/../../download/netfilter-hacking-HOWTO.pdf">
  Téléchargement netfilter hacking HOWTO VF
</OPTION>
<OPTION value="/prj/inetdoc/i/net/guides/">
  Autres guides
</OPTION>

	       </SELECT>
	      </B></FONT>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#FFFFFF><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <!-- 3rd row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor="#990000" align="left" valign="middle" width="100%" height="100%">
	      <div class="browse"><font size=1>&nbsp;&nbsp;Références : <a href="http://netfilter.samba.org/" class="browse"><font size=1>Netfilter Home</font></a>&nbsp;
</font></div>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	</TABLE>
      </form>
      <!-- banner menu end -->
    </TD>
  </TR>
  <TR>
    <TD width=25% bgcolor=#330066 align=left valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
        <TR align=right> 
	  <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	</TR>
	<TR>
	  <TD bgcolor=#330066 align=center>
	    &nbsp;<!-- no Toc section in guides/netfilter-hacking-HOWTO/netfilter-hacking-HOWTO.html -->
      	    <br>
      	    <TABLE width=100% border=0 cellpadding=0 cellspacing=4>
              <TR>
	  	<TD bgcolor=#000000 align=center>
	    	  <TABLE width=100% border=0 cellpadding=2 cellspacing=1>
              	    <TR>
	              <TH bgcolor=#FFCC66 align="center" valign="top" class="toc-title">
		        <a class="toc-title" href="mailto:philippe.latu@linux-france.org">
	        	  Contact<img src="/prj/inetdoc/images/envelope.gif" border=0 width=50 height=35 align="middle" alt="mail">
		  	</a>
		      </TH>
              	    </TR>
              	    <TR>
	              <TD bgcolor=#FFCC99 align=center valign=top class="toc-item">
		        &nbsp;<a class="toc-item" href="/prj/inetdoc/log/">Carnet de bord</a>
		      </TD>
              	    </TR>
              	    <TR>
	              <TD bgcolor=#FFCC99 align=center valign=top class="toc-item">
		  	&nbsp;<a class="toc-item" href="/prj/inetdoc/legal/">Notice légale</a>
		      </TD>
              	    </TR>
            	  </TABLE>
	  	</TD>
              </TR>
      	    </TABLE>
          </TD>
        </TR>
      </TABLE>
    </TD>
    <TD width=75% bgcolor=#FFFFFF align=left valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=8 align=center>
        <TR>
	  <TD bgcolor=#FFFFFF align=left valign=top>
            <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 1st March 2002), see www.w3.org">
<meta name="GENERATOR" content="LinuxDoc-Tools 0.9.21">
<title>Linux netfilter Hacking HOWTO: Motivation</title>
<link href="netfilter-hacking-HOWTO-9.html" rel="next">
<link href="netfilter-hacking-HOWTO-7.html" rel="previous">
<link href="netfilter-hacking-HOWTO.html#toc8" rel="contents">
</head>
<body>
<a href="netfilter-hacking-HOWTO-9.html">Page suivante</a> <a href=
"netfilter-hacking-HOWTO-7.html">Page précédente</a> <a href=
"netfilter-hacking-HOWTO.html#toc8">Table des matières</a> 

<hr>
<h2><a name="s8">8.</a> <a href=
"netfilter-hacking-HOWTO.html#toc8">Motivation</a></h2>

<p>Comme j'ai développé ipchains, j'ai réalisé (pendant l'un de ces
moments flash-tout-blanc-pendant-que-j-attend dans un restaurant
chinois à Sydney) que le filtrage de paquets était fait au mauvais
endroit. Je n'arrive plus à le retrouvé maintenant, mais j'ai
envoyé un émail à Alan Cox, qui a en quelque sorte répondu
`pourquoi tu ne finis pas ce que tu as commencé d'abord, même si tu
as probablement raison'. Version courte : le pragmatisme allait
gagner devant `The Right Thing' (`La Bonne Methode').</p>

<p>Après avoir fini ipchains, qui devait être initialement une
modification mineure des parties kernel de ipfwadm, et qui a fini
par être une ré-écriture quasi-totale de la chose, et après avoir
écrit le HOWTO, je me suis rendu compte à quel point toute la
communauté Linux était confuse avec des choses comme le filtrage de
paquets, NAT et port forwarding, et les choses du même genre.</p>

<p>C'est la joie de fournir votre propre support : vous avez une
idée plus précise de ce que les utilisateurs cherchent à faire, et
ce avec quoi ils ont des difficultés. Le Free Software est le plus
gratifiant quand il est dans les mains de la plupart des
utilisateurs (c'est le but hein ?), et ça veut dire le simplifier.
L'architecture, et pas la documentation, était le problème
principal.</p>

<p>Donc j'avais l'expérience avec le code d'ipchains, et une bonne
idée de ce que les gens cherchaient à faire. Mais il y avait deux
problèmes :</p>

<p>D'abord, je n'avais pas envie de me remettre à la sécurité. Être
un consultant en sécurité est toujours une bataille dans votre
cerveau entre votre conscience et votre porte-monnaie. A un niveau
de base, vous vendez le sentiment de sécurité, qui est à l'opposé
de la vrai sécurité. Peut être travailler dans un corps militaire,
où ils comprennent la sécurité, ça aurait été diffèrent.</p>

<p>Le deuxième problème est que les nouveaux utilisateurs ne sont
plus les seuls à poser problème, un nombre grandissant de gros ISPs
utilisent ce truc. J'avais besoin d'informations exactes en
provenance de ces gens, si c'était pour aménager la chose pour les
utilisateurs de demain.</p>

<p>Ces problèmes ont été résolus quand j'ai rencontré David Bonn,
de chez WatchGuard, à Usenix en 1998. Ils cherchaient un codeur
pour le kernel Linux, à la fin on s'est mis d'accord que j'allais
passer un mois dans leurs bureaux à Seattle, et on verra si on
pourra s'arranger sur un accord ou ils sponsoriseraient mon
travail. Le prix a été plus que ce que j'avais demandé, et donc je
n'ai pas souffert de perte de salaire. Ce qui veut dire que je
n'avais pas à me soucier à faire du consulting en externe pour un
bon moment.</p>

<p>Travailler avec WatchGuard m'a donné une exposition avec de
large clients, ce qui était ce de quoi j'avais besoin. Et étant
indépendant d'eux, ça me permettait d'aider les autres (ex: les
compétiteurs de WatchGuard) de manière égale.</p>

<p>Donc j'aurais pu avoir écrit netfilter, et porté ipchains par
dessus, et avoir fini mon boulot. Malheureusement, ça aurait laissé
tout le code de masquerading dans le kernel : et faire en sorte que
le masquerading soit indépendant du filtrage était un but très
important.</p>

<p>Aussi, mon expérience avec la fonction `interface-address'
d'ipfwadm (celle que j'ai retiré d'ipchains), m'a enseigné qu'il
n'y avait aucun espoir d'enlever simplement le code de masquerading
du kernel et d'attendre que quelqu'un le porte sous netfilter pour
moi.</p>

<p>Donc j'avais besoin d'avoir au moins autant de fonctionnalité
que le code présent, et de préférence plus, pour encourager des
utilisateurs marginaux à être les premiers testeurs. Cela veut dire
remplacer les fonctions de proxy transparent (enfin !), de
masquerading et de port-forwarding. En d'autres mots, avoir une
couche de NAT.</p>

<p>Même si j'avais décidé de porter la couche de masquerading
existante, à la place d'écrire une couche de NAT générique, le code
de masquerading montrait son âge, et son manque de maintenance.
Vous voyez, il n'y avait pas de mainteneur du code de masquerading
et ça se voit ! Il semblerait que les utilisateurs sérieux
n'utilisent pas généralement la masquerade, et il y a peu
d'utilisateur à la maison qui serait prêt à maintenir le code de
masquerading. Des gens courageux et braves comme Juan Ciarlante
envoyaient des patchs pour corriger des bugs de temps en temps,
mais ça avait atteint le stage ou (après avoir été
étendu-patché-et-ré-étendu) ou une ré-écriture était
nécessaire.</p>

<p>Notez s'il vous plaît que je n'étais pas celui qui avait écrit
le système de NAT : je n'utilisait pas la masquerading du tout, et
je n'avais pas étudié le code existant à cette époque. C'est
pourquoi ça m'a pris plus longtemps que ça n'aurait du en prendre.
Mais le résultat est assez bien, à mon avis, et j'ai vraiment
appris énormément. Sans aucun doutes la seconde version sera encore
meilleure, une fois que l'on verra comment les gens
l'utilisent.</p>

<hr>
<a href="netfilter-hacking-HOWTO-9.html">Page suivante</a> <a href=
"netfilter-hacking-HOWTO-7.html">Page précédente</a> <a href=
"netfilter-hacking-HOWTO.html#toc8">Table des matières</a>
</body>
</html>


	  </TD>
	</TR>
      </TABLE>
    </TD>
  </TR>
  <TR>
    <TD colspan=2 width=100% bgcolor=#990000 align=left>
      <TABLE width=100% border=0 cellpadding=0 cellspacing=4>
        <TR>
	  <TD bgcolor=#990000 align=right>
	    <div class="filemodtime">
	      <i>Dernière modification le : 30 May 2002 21:11</i>
	    </div>
      	    <a style="text-decoration:none" href="http://www.php.net">
              <img src="/prj/inetdoc/images/php-small-trans-dark.gif" border=0 width=88 height=31 alt="php logo">
      	    </a>
      	    &nbsp;&nbsp;
      	    <a style="text-decoration:none" href="http://www.debian.org">
              <img src="/prj/inetdoc/images/openlogo-25.jpg" border=0 width=25 height=30 alt="debian logo">
      	    </a>
      	    &nbsp;&nbsp;
	    <!-- stat_code_start
	    <a style="text-decoration:none" href="http://www.estat.com/getstats?serial=21701747824">
	      <img src="http://perso.estat.com/cgi-bin/perso/21701747824?page=marque_perso" border=0>
	    </a>
	     stat_code_end -->
	    <!-- eStat -->
	    <SCRIPT LANGUAGE="JavaScript">
	      <!--
	      var _UJS=0;
	      //-->
	    </SCRIPT>
	    <SCRIPT LANGUAGE="JavaScript" SRC="http://perso.estat.com/js/m.js">
	    </SCRIPT>
	    <SCRIPT LANGUAGE="JavaScript">
	      <!--
	      if(_UJS) _estat('21701747824','Page_D_Accueil','Accueil');
	      //-->
	    </SCRIPT>
	    <!-- /eStat -->
	  </TD>
	</TR>
      </TABLE>
    </TD>
  </TR>
</TABLE>
</body>
</html>
<!-- END: main.tpl -->
