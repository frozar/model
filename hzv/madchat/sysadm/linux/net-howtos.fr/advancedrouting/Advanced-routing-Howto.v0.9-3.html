<!-- NAME: main.tpl -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
  <head>
    <title>L i n u x [inetdoc]: (Guides) </title>
    <meta HTTP-EQUIV="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="Content-Language" content="fr">
    <meta name="description" content="inet doc linux">
    <meta name="author" content="philippe.latu@linux-france.org">
    <meta name="copyright" content="(c)2000 Philippe Latu">
    <meta name="publisher" content="philippe.latu@linux-france.org">
    <meta name="keywords" content="documentation, ethernet, formation, guide, ieee, ifconfig, inet, interface, ip, iproute2, iptables, isdn, IUT, IUP, latu, linux, net, OSI, ping, reseau, RNIS, route, routage, TCP, TCP/IP, UDP">
    <meta name="audience" content="All, Tous">
    <meta name="robots" content="INDEX,FOLLOW">
    <link rel="STYLESHEET" type="text/css" href="/prj/inetdoc/style/docstyle.css">
    <script language="javascript" type="text/javascript">
      <!-- for javascript enabled browser's only
        if (top.location != location) top.location.href = location.href;
	
        function popup(form) {
          optionIndex = form.banner.SelectedIndex;
          if (optionIndex == 0) return;
          location.href = form.banner.options[form.banner.selectedIndex].value;
          }
      // end script hiding -->
    </script>
  </head>
<BODY BGCOLOR="#FFFFFF" TEXT="#990000" LINK="#990000" VLINK="#990000" ALINK="#990000" leftMargin="0" topMargin="0" marginheight="0" marginwidth="0">
<TABLE width=100% border=0 cellspacing=2 cellpadding=0 align=center>
  <TR>
    <TD width=25% bgcolor=#990000 align=center valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
        <TR align=right> 
	  <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
      	</TR>
	<TR>
	  <TD bgcolor=#990000 align=center>
	    <a class="nodecor" href="/prj/inetdoc">
              <IMG src="/prj/inetdoc/images/upleft.png" border=0 width=158 height=96 hspace=10 alt="logo">
      	    </a>
	  <TD>
	</TR>
      </TABLE>
    </TD>
    <TD width=75% bgcolor=#FFFFFF align=left valign=top>
      <!-- banner menu start -->
      <form>
        <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
	  <!-- 1st row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor=#FF9966>
	      <TABLE width="100%" border="0" cellspacing="3" cellpadding="0" width="100%">
	        <TR>
		  <th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/">&nbsp;Accueil</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/articles/">&nbsp;Articles</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/courses/">&nbsp;Cours</a>
</th>
<th align="left" valign="top" bgcolor="white">
  <a class="reduced" href="/prj/inetdoc/i/net/guides/">&nbsp;Guides</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/formation/">&nbsp;Formation</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/download/">&nbsp;Téléchargement</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/source/">&nbsp;Source</a>
</th>

		</TR>
	      </TABLE>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#FFFFFF><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <!-- 2nd row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor=#FFCC66>
	      <FONT color=#990000 size=-1 face="Arial, 'Myriad Web', Syntax, sans-serif"><B>
	       <SELECT name="banner" onChange="popup(this.form)">
	         <OPTION value="/prj/inetdoc/i/net/articles/model/tcpip.html">
  Modélisation TCP/IP
</OPTION>
<OPTION value="/prj/inetdoc/i/net/../../download/Advanced-routing-Howto.pdf">
  Téléchargement Linux 2.4 Advanced Routing HOWTO VF
</OPTION>
<OPTION value="/prj/inetdoc/i/net/guides/">
  Autres guides
</OPTION>

	       </SELECT>
	      </B></FONT>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#FFFFFF><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <!-- 3rd row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor="#990000" align="left" valign="middle" width="100%" height="100%">
	      <div class="browse"><font size=1>&nbsp;&nbsp;Références : <a href="http://netfilter.samba.org/" class="browse"><font size=1>Netfilter Home</font></a>&nbsp;|&nbsp;
<a href="http://lartc.org/" class="browse"><font size=1>Linux Advanced Routing & Traffic Control Home</font></a>&nbsp;|&nbsp;
<a href="http://www.linux-france.org/prj/inetdoc/download/Advanced-routing-Howto.pdf" class="browse"><font size=1>Version Française en PDF</font></a>&nbsp;
</font></div>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	</TABLE>
      </form>
      <!-- banner menu end -->
    </TD>
  </TR>
  <TR>
    <TD width=25% bgcolor=#330066 align=left valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
        <TR align=right> 
	  <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	</TR>
	<TR>
	  <TD bgcolor=#330066 align=center>
	    &nbsp;<!-- no Toc section in guides/Advanced-routing-Howto/Advanced-routing-Howto.v0.9.html -->
      	    <br>
      	    <TABLE width=100% border=0 cellpadding=0 cellspacing=4>
              <TR>
	  	<TD bgcolor=#000000 align=center>
	    	  <TABLE width=100% border=0 cellpadding=2 cellspacing=1>
              	    <TR>
	              <TH bgcolor=#FFCC66 align="center" valign="top" class="toc-title">
		        <a class="toc-title" href="mailto:philippe.latu@linux-france.org">
	        	  Contact<img src="/prj/inetdoc/images/envelope.gif" border=0 width=50 height=35 align="middle" alt="mail">
		  	</a>
		      </TH>
              	    </TR>
              	    <TR>
	              <TD bgcolor=#FFCC99 align=center valign=top class="toc-item">
		        &nbsp;<a class="toc-item" href="/prj/inetdoc/log/">Carnet de bord</a>
		      </TD>
              	    </TR>
              	    <TR>
	              <TD bgcolor=#FFCC99 align=center valign=top class="toc-item">
		  	&nbsp;<a class="toc-item" href="/prj/inetdoc/legal/">Notice légale</a>
		      </TD>
              	    </TR>
            	  </TABLE>
	  	</TD>
              </TR>
      	    </TABLE>
          </TD>
        </TR>
      </TABLE>
    </TD>
    <TD width=75% bgcolor=#FFFFFF align=left valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=8 align=center>
        <TR>
	  <TD bgcolor=#FFFFFF align=left valign=top>
            <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 1st February 2002), see www.w3.org">
<meta name="GENERATOR" content="LinuxDoc-Tools 0.9.18">
<title>HOWTO du routage avancé et du contrôle de trafic sous Linux:
Introduction à iproute2</title>
<link href="Advanced-routing-Howto.v0.9-4.html" rel="next">
<link href="Advanced-routing-Howto.v0.9-2.html" rel="previous">
<link href="Advanced-routing-Howto.v0.9.html#toc3" rel="contents">
</head>
<body>
<a href="Advanced-routing-Howto.v0.9-4.html">Page suivante</a> <a
href="Advanced-routing-Howto.v0.9-2.html">Page précédente</a> <a
href="Advanced-routing-Howto.v0.9.html#toc3">Table des matières</a>


<hr>
<h2><a name="s3">3.</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc3">Introduction à
iproute2</a></h2>

<h2><a name="ss3.1">3.1</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc3.1">Pourquoi
iproute2&nbsp;?</a></h2>

<p>La plupart des distributions Linux et des UNIX utilisent
couramment les vénérables commandes "arp", "ifconfig" et "route".
Bien que ces outils fonctionnent, ils montrent quelques
comportements inattendus avec les noyaux Linux des séries 2.2 et
plus. Par exemple, les tunnels GRE font partie intégrante du
routage de nos jours, mais ils nécessitent des outils complètement
différents.</p>

<p>Avec iproute2, les tunnels font partie intégrante des
outils.</p>

<p>Les noyaux Linux des séries 2.2 et plus ont un sous-système
réseau complètement réécrit. Ce nouveau codage de la partie réseau
apporte à Linux des performances et des fonctionnalités qui n'ont
pratiquement pas d'équivalent dans les autres systèmes
d'exploitation. En fait, le nouveau logiciel de filtrage, routage
et de classification possède plus de fonctionnalités que les
logiciels fournis sur beaucoup de routeurs dédiés, de pare-feu et
de produits de mise en forme (shaping) du trafic.</p>

<p>Dans les systèmes d'exploitation existants, au fur et à mesure
que de nouveaux concepts réseau apparaissaient, les développeurs
sont parvenus à les greffer sur les structures existantes. Ce
travail constant d'empilage de couches a conduit à des codes réseau
aux comportements étranges, un peu comme les langues humaines. Dans
le passé, Linux émulait le mode de fonctionnement de SunOS, ce qui
n'était pas l'idéal.</p>

<p>La nouvelle structure d'iproute2 a permis de formuler clairement
des fonctionnalités impossibles à implanter dans le sous-système
réseau précédent.</p>

<h2><a name="ss3.2">3.2</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc3.2">Un tour d'horizon
d'iproute2</a></h2>

<p>Linux possède un système sophistiqué d'allocation de bande
passante appelé Contrôle de trafic (Traffic Control). Ce système
supporte différentes méthodes pour classer, ranger par ordre de
priorité, partager et limiter le trafic entrant et sortant.</p>

<p>Nous commencerons par un petit tour d'horizon des possibilités
d'iproute2.</p>

<h2><a name="ss3.3">3.3</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc3.3">Prérequis</a></h2>

<p>Vous devez être sûr que vous avez installé les outils
utilisateur (NdT&nbsp;: userland tools, par opposition à la partie
"noyau" d'iproute2). Le paquet concerné s'appelle "iproute" sur
RedHat et Debian. Autrement, il peut être trouvé à
<code>ftp://ftp.inr.ac.ru/ip-routing/iproute2-2.2.4-now-ss??????.tar.gz</code>.</p>

<p>Vous pouvez aussi essayer <a href=
"ftp://ftp.inr.ac.ru/ip-routing/iproute2-current.tar.gz">iproute2-current.tar.gz</a>
pour la dernière version.</p>

<p>Certains éléments d'iproute vous imposent l'activation de
certaines options du noyau. Il devra également être noté que toutes
les versions de RedHat jusqu'à la version 6.2 incluse n'ont pas les
fonctionnalités du contrôle de trafic dans le noyau par défaut.</p>

<p>RedHat 7.2 contient tous les éléments par défaut.</p>

<p>Soyez également sûr que vous avez le support netlink, en
utilisant son propre noyau (NdT : compilé par vous). Iproute2 en a
besoin.</p>

<h2><a name="ss3.4">3.4</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc3.4">Explorer votre
configuration courante</a></h2>

<p>Cela peut vous paraître surprenant, mais iproute2 est déjà
configuré&nbsp;! Les commandes courantes <code>ifconfig</code> et
<code>route</code> utilisent déjà les appels système avancés
d'iproute2, mais essentiellement avec les options par défaut
(c'est-à-dire ennuyeuses).</p>

<p>L'outil <code>ip</code> est central, et nous allons lui demander
de nous montrer les interfaces.</p>

<h3><code>ip</code> nous montre nos liens</h3>

<blockquote>
<pre>
<code>[ahu@home ahu]$ ip link list
1: lo: &lt;LOOPBACK,UP&gt; mtu 3924 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: dummy: &lt;BROADCAST,NOARP&gt; mtu 1500 qdisc noop 
    link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff
3: eth0: &lt;BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1400 qdisc pfifo_fast qlen 100
    link/ether 48:54:e8:2a:47:16 brd ff:ff:ff:ff:ff:ff
4: eth1: &lt;BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1500 qdisc pfifo_fast qlen 100
    link/ether 00:e0:4c:39:24:78 brd ff:ff:ff:ff:ff:ff
3764: ppp0: &lt;POINTOPOINT,MULTICAST,NOARP,UP&gt; mtu 1492 qdisc pfifo_fast qlen 10
    link/ppp 
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>La sortie peut varier, mais voici ce qui est affiché pour mon
routeur NAT (NdT&nbsp;: translation d'adresse) chez moi.
J'expliquerai seulement une partie de la sortie, dans la mesure où
tout n'est pas directement pertinent.</p>

<p>La première interface que nous voyons est l'interface loopback.
Bien que votre ordinateur puisse fonctionner sans, je vous le
déconseille. La taille de MTU (unité maximum de transmission) est
de 3924 octets, et loopback n'est pas supposé être mis en file
d'attente, ce qui prend tout son sens dans la mesure où cette
interface est le fruit de l'imagination de votre noyau.</p>

<p>Je vais passer sur l'interface dummy pour l'instant, et il se
peut qu'elle ne soit pas présente sur votre ordinateur. Il y a
ensuite mes deux interfaces physiques, l'une du côté de mon modem
câble, l'autre servant mon segment ethernet à la maison. De plus,
nous voyons une interface ppp0.</p>

<p>Notons l'absence d'adresses IP. Iproute déconnecte les concepts
de "liens" et "d'adresses IP". Avec l'IP aliasing, le concept de
l'adresse IP canonique est devenu, de toute façon, sans
signification.</p>

<p><code>ip</code> nous montre bien, cependant, l'adresse MAC,
l'identifiant matériel de nos interfaces ethernet.</p>

<h3><code>ip</code> nous montre nos adresses IP</h3>

<blockquote>
<pre>
<code>[ahu@home ahu]$ ip address show        
1: lo: &lt;LOOPBACK,UP&gt; mtu 3924 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 brd 127.255.255.255 scope host lo
2: dummy: &lt;BROADCAST,NOARP&gt; mtu 1500 qdisc noop 
    link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff
3: eth0: &lt;BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1400 qdisc pfifo_fast qlen 100
    link/ether 48:54:e8:2a:47:16 brd ff:ff:ff:ff:ff:ff
    inet 10.0.0.1/8 brd 10.255.255.255 scope global eth0
4: eth1: &lt;BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1500 qdisc pfifo_fast qlen 100
    link/ether 00:e0:4c:39:24:78 brd ff:ff:ff:ff:ff:ff
3764: ppp0: &lt;POINTOPOINT,MULTICAST,NOARP,UP&gt; mtu 1492 qdisc pfifo_fast qlen 10
    link/ppp 
    inet 212.64.94.251 peer 212.64.94.1/32 scope global ppp0
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>Cela contient plus d'informations&nbsp;: ip montre toutes nos
adresses, et à quelles cartes elles appartiennent. "inet" signifie
Internet (IPv4). Il y a beaucoup d'autres familles d'adresses, mais
elles ne nous concernent pas pour le moment.</p>

<p>Examinons eth0 de plus près. Il est dit qu'il est relié à
l'adresse internet "10.0.0.1/8". Qu'est-ce que cela signifie&nbsp;?
Le /8 désigne le nombre de bits réservés à l'adresse réseau. Il y a
32 bits, donc il reste 24 bits pour désigner une partie de notre
réseau. Les 8 premiers bits de 10.0.0.1 correspondent à 10.0.0.0,
notre adresse réseau, et notre masque de sous-réseau est
255.0.0.0.</p>

<p>Les autres bits repèrent des machines directement connectées à
cette interface, donc 10.250.3.13 est directement disponible sur
eth0, comme l'est 10.0.0.1 dans notre exemple.</p>

<p>Avec ppp0, le même concept existe, bien que les nombres soient
différents. Son adresse est 212.64.94.251, sans masque de
sous-réseau. Cela signifie que vous avez une liaison point à point
et que toutes les adresses, à l'exception de 212.64.94.251, sont
distantes. Il y a cependant plus d'informations. En effet, on nous
dit que de l'autre côté du lien, il n'y a encore qu'une seule
adresse, 212.64.94.1. Le /32 nous précise qu'il n'y a pas de "bits
réseau".</p>

<p>Il est absolument vital que vous compreniez ces concepts.
Référez-vous à la documentation mentionnée au début de cet HOWTO si
vous avez des doutes.</p>

<p>Vous pouvez aussi noter "qdisc", qui désigne la "Queueing
Discipline" (gestion de la mise en file d'attente). Cela deviendra
vital plus tard.</p>

<h3><code>ip</code> nous montre nos routes</h3>

<p>Nous savons maintenant comment trouver les adresses 10.x.y.z, et
nous sommes capables d'atteindre 212.64.94.1. Cela n'est cependant
pas suffisant, et nous avons besoin d'instructions pour atteindre
le monde. L'Internet est disponible via notre connexion ppp, et il
se trouve que 212.64.94.1 est prêt à propager nos paquets à travers
le monde, et à nous renvoyer le résultat.</p>

<blockquote>
<pre>
<code>[ahu@home ahu]$ ip route show
212.64.94.1 dev ppp0  proto kernel  scope link  src 212.64.94.251 
10.0.0.0/8 dev eth0  proto kernel  scope link  src 10.0.0.1 
127.0.0.0/8 dev lo  scope link 
default via 212.64.94.1 dev ppp0 
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>Cela se comprend de soi-même. Les 4 premières lignes donnent
explicitement ce qui était sous-entendu par <code>ip address
show</code>, la dernière ligne nous indiquant que le reste du monde
peut être trouvé via 212.64.94.1, notre passerelle par défaut. Nous
pouvons voir que c'est une passerelle à cause du mot "via", qui
nous indique que nous avons besoin d'envoyer les paquets vers
212.64.94.1, et que c'est elle qui se chargera de tout.</p>

<p>En référence, voici ce que l'ancien utilitaire "route" nous
propose&nbsp;:</p>

<blockquote>
<pre>
<code>[ahu@home ahu]$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use
Iface
212.64.94.1     0.0.0.0         255.255.255.255 UH    0      0        0 ppp0
10.0.0.0        0.0.0.0         255.0.0.0       U     0      0        0 eth0
127.0.0.0       0.0.0.0         255.0.0.0       U     0      0        0 lo
0.0.0.0         212.64.94.1     0.0.0.0         UG    0      0        0 ppp0
</code>
</pre>
</blockquote>

<br>
<br>
 

<h2><a name="ss3.5">3.5</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc3.5">ARP</a></h2>

<p>ARP est le Protocole de Résolution d'Adresse (Address Resolution
Protocol). Il est décrit dans le <a href=
"http://www.faqs.org/rfcs/rfc826.html">RFC 826</a>. ARP est utilisé
par une machine d'un réseau local pour retrouver l'adresse
matérielle (la localisation) d'une autre machine sur le même
réseau. Les machines sur Internet sont généralement connues par
leur nom auquel correspond une adresse IP. C'est ainsi qu'une
machine sur le réseau foo.com est capable de communiquer avec une
autre machine qui est sur le réseau bar.net. Une adresse IP,
cependant, ne peut pas vous indiquer la localisation physique de la
machine. C'est ici que le protocole ARP entre en jeu.</p>

<p>Prenons un exemple très simple. Supposons que j'aie un réseau
composé de plusieurs machines, dont la machine "foo" d'adresse IP
10.0.0.1 et la machine "bar" qui a l'adresse IP 10.0.0.2.
Maintenant, foo veut envoyer un "ping" vers bar pour voir s'il est
actif, mais foo n'a aucune indication sur la localisation de bar.
Donc, si foo décide d'envoyer un "ping" vers bar, il a besoin
d'envoyer une requête ARP. Cette requête ARP est une façon pour foo
de crier sur le réseau "Bar (10.0.0.2)&nbsp;! Où es-tu&nbsp;?". Par
conséquent, toutes les machines sur le réseau entendront foo crier,
mais seul bar (10.0.0.2) répondra. Bar enverra une réponse ARP
directement à foo&nbsp;; ce qui revient à dire&nbsp;: "Foo
(10.0.0.1)&nbsp;! je suis ici, à l'adresse 00:60:94:E:08:12". Après
cette simple transaction utilisée pour localiser son ami sur le
réseau, foo est capable de communiquer avec bar jusqu'à ce qu'il
(le cache ARP de foo) oublie où bar est situé (typiquement au bout
de 15 minutes sur Unix).</p>

<p>Maintenant, voyons comment cela fonctionne. Vous pouvez
consulter votre cache (table) arp (neighbor) comme ceci&nbsp;:</p>

<blockquote>
<pre>
<code>[root@espa041 /home/src/iputils]# ip neigh show
9.3.76.42 dev eth0 lladdr 00:60:08:3f:e9:f9 nud reachable
9.3.76.1 dev eth0 lladdr 00:06:29:21:73:c8 nud reachable
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>Comme vous pouvez le voir, ma machine espa041 (9.3.76.41) sait
où trouver espa042 (9.3.76.42) et espagate (9.3.76.1). Maintenant,
ajoutons une autre machine dans le cache arp.</p>

<blockquote>
<pre>
<code>[root@espa041 /home/paulsch/.gnome-desktop]# ping -c 1 espa043
PING espa043.austin.ibm.com (9.3.76.43) from 9.3.76.41 : 56(84) bytes of data.
64 bytes from 9.3.76.43: icmp_seq=0 ttl=255 time=0.9 ms

1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.9/0.9/0.9 ms

[root@espa041 /home/src/iputils]# ip neigh show
9.3.76.43 dev eth0 lladdr 00:06:29:21:80:20 nud reachable
9.3.76.42 dev eth0 lladdr 00:60:08:3f:e9:f9 nud reachable
9.3.76.1 dev eth0 lladdr 00:06:29:21:73:c8 nud reachable
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>Par conséquent, lorsque espa041 a essayé de contacter espa043,
l'adresse matérielle de espa043 (sa localisation) a alors été
ajoutée dans le cache ARP. Donc, tant que la durée de vie de
l'entrée correspondant à espa043 dans le cache ARP n'est pas
dépassée, espa041 sait localiser espa043 et n'a plus besoin
d'envoyer de requête ARP.</p>

<p>Maintenant, effaçons espa043 de notre cache ARP.</p>

<blockquote>
<pre>
<code>[root@espa041 /home/src/iputils]# ip neigh delete 9.3.76.43 dev eth0
[root@espa041 /home/src/iputils]# ip neigh show
9.3.76.43 dev eth0  nud failed
9.3.76.42 dev eth0 lladdr 00:60:08:3f:e9:f9 nud reachable
9.3.76.1 dev eth0 lladdr 00:06:29:21:73:c8 nud stale
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>Maintenant, espa041 a à nouveau oublié la localisation d'espa043
et aura besoin d'envoyer une autre requête ARP la prochaine fois
qu'il voudra communiquer avec lui. Vous pouvez aussi voir ci-dessus
que l'état d'espagate (9.3.76.1) est passé en "stale". Cela
signifie que la localisation connue est encore valide, mais qu'elle
devra être confirmée à la première transaction avec cette
machine.</p>

<hr>
<a href="Advanced-routing-Howto.v0.9-4.html">Page suivante</a> <a
href="Advanced-routing-Howto.v0.9-2.html">Page précédente</a> <a
href="Advanced-routing-Howto.v0.9.html#toc3">Table des matières</a>
</body>
</html>


	  </TD>
	</TR>
      </TABLE>
    </TD>
  </TR>
  <TR>
    <TD colspan=2 width=100% bgcolor=#990000 align=left>
      <TABLE width=100% border=0 cellpadding=0 cellspacing=4>
        <TR>
	  <TD bgcolor=#990000 align=right>
	    <div class="filemodtime">
	      <i>Dernière modification le : 4 March 2002 12:04</i>
	    </div>
      	    <a style="text-decoration:none" href="http://www.php.net">
              <img src="/prj/inetdoc/images/php-small-trans-dark.gif" border=0 width=88 height=31 alt="php logo">
      	    </a>
      	    &nbsp;&nbsp;
      	    <a style="text-decoration:none" href="http://www.debian.org">
              <img src="/prj/inetdoc/images/openlogo-25.jpg" border=0 width=25 height=30 alt="debian logo">
      	    </a>
      	    &nbsp;&nbsp;
	    <!-- stat_code_start
	    <a style="text-decoration:none" href="http://www.estat.com/getstats?serial=21701747824">
	      <img src="http://perso.estat.com/cgi-bin/perso/21701747824?page=marque_perso" border=0>
	    </a>
	     stat_code_end -->
	    <!-- eStat -->
	    <SCRIPT LANGUAGE="JavaScript">
	      <!--
	      var _UJS=0;
	      //-->
	    </SCRIPT>
	    <SCRIPT LANGUAGE="JavaScript" SRC="http://perso.estat.com/js/m.js">
	    </SCRIPT>
	    <SCRIPT LANGUAGE="JavaScript">
	      <!--
	      if(_UJS) _estat('21701747824','Page_D_Accueil','Accueil');
	      //-->
	    </SCRIPT>
	    <!-- /eStat -->
	  </TD>
	</TR>
      </TABLE>
    </TD>
  </TR>
</TABLE>
</body>
</html>
<!-- END: main.tpl -->
