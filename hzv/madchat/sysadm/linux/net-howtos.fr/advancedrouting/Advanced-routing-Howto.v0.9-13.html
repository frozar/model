<!-- NAME: main.tpl -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
  <head>
    <title>L i n u x [inetdoc]: (Guides) </title>
    <meta HTTP-EQUIV="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="Content-Language" content="fr">
    <meta name="description" content="inet doc linux">
    <meta name="author" content="philippe.latu@linux-france.org">
    <meta name="copyright" content="(c)2000 Philippe Latu">
    <meta name="publisher" content="philippe.latu@linux-france.org">
    <meta name="keywords" content="documentation, ethernet, formation, guide, ieee, ifconfig, inet, interface, ip, iproute2, iptables, isdn, IUT, IUP, latu, linux, net, OSI, ping, reseau, RNIS, route, routage, TCP, TCP/IP, UDP">
    <meta name="audience" content="All, Tous">
    <meta name="robots" content="INDEX,FOLLOW">
    <link rel="STYLESHEET" type="text/css" href="/prj/inetdoc/style/docstyle.css">
    <script language="javascript" type="text/javascript">
      <!-- for javascript enabled browser's only
        if (top.location != location) top.location.href = location.href;
	
        function popup(form) {
          optionIndex = form.banner.SelectedIndex;
          if (optionIndex == 0) return;
          location.href = form.banner.options[form.banner.selectedIndex].value;
          }
      // end script hiding -->
    </script>
  </head>
<BODY BGCOLOR="#FFFFFF" TEXT="#990000" LINK="#990000" VLINK="#990000" ALINK="#990000" leftMargin="0" topMargin="0" marginheight="0" marginwidth="0">
<TABLE width=100% border=0 cellspacing=2 cellpadding=0 align=center>
  <TR>
    <TD width=25% bgcolor=#990000 align=center valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
        <TR align=right> 
	  <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
      	</TR>
	<TR>
	  <TD bgcolor=#990000 align=center>
	    <a class="nodecor" href="/prj/inetdoc">
              <IMG src="/prj/inetdoc/images/upleft.png" border=0 width=158 height=96 hspace=10 alt="logo">
      	    </a>
	  <TD>
	</TR>
      </TABLE>
    </TD>
    <TD width=75% bgcolor=#FFFFFF align=left valign=top>
      <!-- banner menu start -->
      <form>
        <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
	  <!-- 1st row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor=#FF9966>
	      <TABLE width="100%" border="0" cellspacing="3" cellpadding="0" width="100%">
	        <TR>
		  <th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/">&nbsp;Accueil</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/articles/">&nbsp;Articles</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/courses/">&nbsp;Cours</a>
</th>
<th align="left" valign="top" bgcolor="white">
  <a class="reduced" href="/prj/inetdoc/i/net/guides/">&nbsp;Guides</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/formation/">&nbsp;Formation</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/download/">&nbsp;Téléchargement</a>
</th>
<th align="left" valign="top" bgcolor="#FFCC99">
  <a class="reduced" href="/prj/inetdoc/i/net/source/">&nbsp;Source</a>
</th>

		</TR>
	      </TABLE>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#FFFFFF><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <!-- 2nd row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor=#FFCC66>
	      <FONT color=#990000 size=-1 face="Arial, 'Myriad Web', Syntax, sans-serif"><B>
	       <SELECT name="banner" onChange="popup(this.form)">
	         <OPTION value="/prj/inetdoc/i/net/articles/model/tcpip.html">
  Modélisation TCP/IP
</OPTION>
<OPTION value="/prj/inetdoc/i/net/../../download/Advanced-routing-Howto.pdf">
  Téléchargement Linux 2.4 Advanced Routing HOWTO VF
</OPTION>
<OPTION value="/prj/inetdoc/i/net/guides/">
  Autres guides
</OPTION>

	       </SELECT>
	      </B></FONT>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#FFFFFF><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <!-- 3rd row -->
	  <TR align=right> 
	    <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR>
	    <TD bgcolor="#990000" align="left" valign="middle" width="100%" height="100%">
	      <div class="browse"><font size=1>&nbsp;&nbsp;Références : <a href="http://netfilter.samba.org/" class="browse"><font size=1>Netfilter Home</font></a>&nbsp;|&nbsp;
<a href="http://lartc.org/" class="browse"><font size=1>Linux Advanced Routing & Traffic Control Home</font></a>&nbsp;|&nbsp;
<a href="http://www.linux-france.org/prj/inetdoc/download/Advanced-routing-Howto.pdf" class="browse"><font size=1>Version Française en PDF</font></a>&nbsp;
</font></div>
	    </TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#990000><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=4 alt=""></TD>
	  </TR>
	  <TR align=right> 
	    <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	  </TR>
	</TABLE>
      </form>
      <!-- banner menu end -->
    </TD>
  </TR>
  <TR>
    <TD width=25% bgcolor=#330066 align=left valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=0 align=center>
        <TR align=right> 
	  <TD bgcolor=#FF9966><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=2 alt=""></TD>
	</TR>
	<TR align=right> 
	  <TD bgcolor=#330066><IMG src="/prj/inetdoc/images/blank.gif" width=1 height=1 alt=""></TD>
	</TR>
	<TR>
	  <TD bgcolor=#330066 align=center>
	    &nbsp;<!-- no Toc section in guides/Advanced-routing-Howto/Advanced-routing-Howto.v0.9.html -->
      	    <br>
      	    <TABLE width=100% border=0 cellpadding=0 cellspacing=4>
              <TR>
	  	<TD bgcolor=#000000 align=center>
	    	  <TABLE width=100% border=0 cellpadding=2 cellspacing=1>
              	    <TR>
	              <TH bgcolor=#FFCC66 align="center" valign="top" class="toc-title">
		        <a class="toc-title" href="mailto:philippe.latu@linux-france.org">
	        	  Contact<img src="/prj/inetdoc/images/envelope.gif" border=0 width=50 height=35 align="middle" alt="mail">
		  	</a>
		      </TH>
              	    </TR>
              	    <TR>
	              <TD bgcolor=#FFCC99 align=center valign=top class="toc-item">
		        &nbsp;<a class="toc-item" href="/prj/inetdoc/log/">Carnet de bord</a>
		      </TD>
              	    </TR>
              	    <TR>
	              <TD bgcolor=#FFCC99 align=center valign=top class="toc-item">
		  	&nbsp;<a class="toc-item" href="/prj/inetdoc/legal/">Notice légale</a>
		      </TD>
              	    </TR>
            	  </TABLE>
	  	</TD>
              </TR>
      	    </TABLE>
          </TD>
        </TR>
      </TABLE>
    </TD>
    <TD width=75% bgcolor=#FFFFFF align=left valign=top>
      <TABLE width=100% border=0 cellspacing=0 cellpadding=8 align=center>
        <TR>
	  <TD bgcolor=#FFFFFF align=left valign=top>
            <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 1st February 2002), see www.w3.org">
<meta name="GENERATOR" content="LinuxDoc-Tools 0.9.18">
<title>HOWTO du routage avancé et du contrôle de trafic sous Linux:
Paramètres réseau du noyau</title>
<link href="Advanced-routing-Howto.v0.9-14.html" rel="next">
<link href="Advanced-routing-Howto.v0.9-12.html" rel="previous">
<link href="Advanced-routing-Howto.v0.9.html#toc13" rel="contents">
</head>
<body>
<a href="Advanced-routing-Howto.v0.9-14.html">Page suivante</a> <a
href="Advanced-routing-Howto.v0.9-12.html">Page précédente</a> <a
href="Advanced-routing-Howto.v0.9.html#toc13">Table des
matières</a> 

<hr>
<h2><a name="s13">13.</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc13">Paramètres réseau du
noyau</a></h2>

<p>Le noyau utilise de nombreux paramètres qui peuvent être ajustés
en différentes circonstances. Bien que, comme d'habitude, les
paramètres par défaut conviennent à 99% des installations, nous ne
pourrions pas appeler ce document "HOWTO avancé" sans en dire un
mot.</p>

<p>Les éléments intéressants sont dans /proc/sys/net, jetez-y un
oeil. Tout ne sera pas documenté ici au départ, mais nous y
travaillons.</p>

<p>En attendant, vous pouvez jetter un oeil dans les sources du
noyau Linux et lire le fichier Documentation/filesystems/proc.txt.
La plupart des fonctionnalités y sont expliquées.</p>

<h2><a name="ss13.1">13.1</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc13.1">Filtrage du Chemin
Inverse (Reverse Path Filtering)</a></h2>

<p>Par défaut, les routeurs routent tout, même les paquets qui
visiblement n'appartiennent pas à votre réseau. Un exemple courant
est l'espace des adresses IP privées s'échappant sur Internet. Si
vous avez une interface avec une route pour 195.96.96.0/24 dessus,
vous ne vous attendrez pas à voir arriver des paquets venant de
212.64.94.1.</p>

<p>Beaucoup d'utilisateurs veulent désactiver cette fonctionnalité.
Les développeurs du noyau ont permis de le faire facilement. Il y a
des fichiers dans /proc où vous pouvez ordonner au noyau de le
faire pour vous. La méthode est appelée "Reverse Path Filtering"
(Filtrage par chemin inverse). Pour faire simple, si la réponse à
ce paquet ne sort pas par l'interface par laquelle il est entré,
alors c'est un paquet "bogué" et il sera ignoré.</p>

<p>Les instructions suivantes vont activer cela pour toutes les
interfaces courantes et futures.</p>

<blockquote>
<pre>
<code># for i in /proc/sys/net/ipv4/conf/*/rp_filter ; do
&gt;  echo 2 &gt; $i 
&gt; done
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>En reprenant l'exemple du début, si un paquet arrivant sur le
routeur Linux par eth1 prétend venir du réseau Bureau+FAI, il sera
éliminé. De même, si un paquet arrivant du réseau Bureau prétend
être de quelque part à l'extérieur du pare-feu, il sera également
éliminé.</p>

<p>Ce qui est présenté ci-dessus est le filtrage de chemin inverse
complet. Le paramétrage par défaut filtre seulement sur les
adresses IP des réseaux directement connectés. Ce paramétrage par
défaut est utilisé parce que le filtrage complet échoue dans le cas
d'un routage asymétrique (où il y a des paquets arrivant par un
chemin et ressortant par un autre, comme dans le cas du trafic
satellite ou si vous avez des routes dynamiques (bgp, ospf, rip)
dans votre réseau. Les données descendent vers la parabole
satellite et les réponses repartent par des lignes terrestres
normales).</p>

<p>Si cette exception s'applique dans votre cas (vous devriez être
au courant), vous pouvez simplement désactiver le rp_filter sur
l'interface d'arrivée des données satellite. Si vous voulez voir si
des paquets sont éliminés, le fichier log_martians du même
répertoire indiquera au noyau de les enregistrer dans votre
syslog.</p>

<blockquote>
<pre>
<code># echo 1 &gt;/proc/sys/net/ipv4/conf/&lt;interfacename&gt;/log_martians
</code>
</pre>
</blockquote>

<br>
<br>
 

<p>FIXME: Est-ce que la configuration des fichiers dans
.../conf/{default,all} suffit&nbsp;? - martijn</p>

<h2><a name="ss13.2">13.2</a> <a href=
"Advanced-routing-Howto.v0.9.html#toc13.2">Configurations
obscures</a></h2>

<p>Bon, il y a beaucoup de paramètres qui peuvent être modifiés.
Nous essayons de tous les lister. Voir aussi une documentation
partielle dans Documentation/ip-sysctl.txt.</p>

<p>Certaines de ces configurations ont des valeurs par défaut
différentes suivant que vous répondez "Yes" ou "No" à la question
"Configure as router and not host" lors de la compilation du
noyau.</p>

<h3>ipv4 générique</h3>

<p>En remarque générale, les fonctionnalités de limitation de débit
ne fonctionnent pas sur l'interface loopback. N'essayez donc pas de
les tester localement. Les limites sont exprimées en "jiffies"
("tic-tac") et sont contraintes d'utiliser le "token bucket filter"
mentionné plus tôt.</p>

<p>[NdT&nbsp;: le terme "jiffies" désigne un mouvement régulier,
faisant référence au "tic-tac" d'un horloge. Dans le noyau
lui-même, une variable globale nommée jiffies est incrémenté à
chaque interruption d'horloge]</p>

<p>Le noyau a une horloge interne qui tourne à "HZ" impulsions (ou
"jiffies") par seconde. Sur intel, "HZ" est la plupart du temps de
100. Donc, configurer un fichier *_rate à, disons 50, autorise 2
paquets par seconde. Le "token bucket filter" est également
configuré pour autoriser une rafale de données de au plus 6
paquets, si suffisamment de jetons ont été gagnés.</p>

<p>Plusieurs éléments de la liste suivante proviennent du fichier
/usr/src/linux/Documentation/networking/ip-sysctl.txt, écrit par
Alexey Kuznetsov &lt;kuznet@ms2.inr.ac.ru&gt; et Andi Kleen
&lt;ak@muc.de&gt;</p>

<dl>
<dt><b>/proc/sys/net/ipv4/icmp_destunreach_rate</b></dt>

<dd>
<p>Si le noyau décide qu'il ne peut pas délivrer un paquet, il le
rejetera et enverra à la source du paquet un ICMP notifiant ce
rejet.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/icmp_echo_ignore_all</b></dt>

<dd>
<p>N'agit en aucun cas comme écho pour les paquets. Ne configurez
pas ceci par défaut. Cependant, si vous êtes utilisé comme relais
dans une attaque de Déni de Services, cela peut être utile.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts
[Utile]</b></dt>

<dd>
<p>Si vous pinguez l'adresse de diffusion d'un réseau, tous les
hôtes sont censés répondre. Cela permet de coquettes attaques de
déni de service. Mettez cette valeur à 1 pour ignorer ces messages
de diffusion.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/icmp_echoreply_rate</b></dt>

<dd>
<p>Le débit auquel les réponses echo sont envoyées aux
destinataires.</p>
</dd>

<dt>
<b>/proc/sys/net/ipv4/icmp_ignore_bogus_error_responses</b></dt>

<dd>
<p>Configurer ceci pour ignorer les erreurs ICMP d'hôtes du réseau
réagissant mal aux trames envoyées vers ce qu'ils perçoivent comme
l'adresse de diffusion.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/icmp_paramprob_rate</b></dt>

<dd>
<p>Un message ICMP relativement peu connu, qui est envoyé en
réponse à des paquets qui ont des entêtes IP ou TCP erronées. Avec
ce fichier, vous pouvez contrôler le débit auquel il est
envoyé.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/icmp_timeexceed_rate</b></dt>

<dd>
<p>Voici la célèbre cause des "étoiles Solaris" dans traceroute.
Limite le nombre de messages ICMP Time Exceeded envoyés.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/igmp_max_memberships</b></dt>

<dd>
<p>Nombre maximal de sockets igmp (multidistribution) en écoûte sur
l'hôte. FIXME: Est-ce vrai ?</p>
</dd>

<dt><b>/proc/sys/net/ipv4/inet_peer_gc_maxtime</b></dt>

<dd>
<p>FIXME&nbsp;: Ajouter une petite explication sur le stockage des
partenaires internet (inet peer)&nbsp;?<br>
Intervalle de temps minimum entre deux passages du ramasse-miettes.
Cet intervalle est pris en compte lors d'une faible (voire
inexistante) utilisation du pool. Mesuré en "jiffies". [NdT&nbsp;:
Le pool désigne ici la liste des adresses IP des partenaires
internet.]</p>
</dd>

<dt><b>/proc/sys/net/ipv4/inet_peer_gc_mintime</b></dt>

<dd>
<p>Intervalle de temps minimum entre deux passages du
ramasse-miettes. Cet intervalle est pris en compte lors d'une
utilisation intensive du pool. Mesuré en "jiffies".</p>
</dd>

<dt><b>/proc/sys/net/ipv4/inet_peer_maxttl</b></dt>

<dd>
<p>Durée de conservation maximale des enregistrements. Les entrées
non utilisées expireront au bout de cet intervalle de temps (cad
quand le nombre d'entrée dans le pool est très petit). Mesuré en
"jiffies".</p>
</dd>

<dt><b>/proc/sys/net/ipv4/inet_peer_minttl</b></dt>

<dd>
<p>Durée de conservation minimale des enregistrements. Devrait être
suffisante pour prendre en compte le temps de vie des fragments sur
l'hote qui doit réassembler les paquets. Cette durée minimale est
garantie si le nombre d'éléments dans le pool est inférieur au
seuil fixé par inet_peer_threshold</p>
</dd>

<dt><b>/proc/sys/net/ipv4/inet_peer_threshold</b></dt>

<dd>
<p>Taille approximative de l'espace de stockage des partenaires
internet. A partir de ce seuil, les entrées sont effacées. Ce seuil
détermine la durée de vie des entrées, ainsi que les intervalles de
temps entre deux déclenchements du ramasse-miettes. Plus d'entrées,
temps de vie plus faible, intervalle du ramasse-miettes plus
faible.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ip_autoconfig</b></dt>

<dd>
<p>Ce fichier contient la valeur 1 si l'hôte a reçu sa
configuration IP par RARP, BOOTP, DHCP ou un mécanisme similaire.
Autrement, contient la valeur zéro.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ip_default_ttl</b></dt>

<dd>
<p>Durée de vie (TTL) des paquets. Fixer à la valeur sûre de 64.
Augmentez-là si vous avez un réseau immense, mais pas "pour
s'amuser"&nbsp;: les boucles sans fin d'un mauvais routage sont
plus dangereuses si le TTL est élevé. Vous pouvez même envisager de
diminuer la valeur dans certaines circonstances.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ip_dynaddr</b></dt>

<dd>
<p>Vous aurez besoin de positionner cela si vous utilisez la
connexion à la demande avec une adresse d'interface dynamique. Une
fois que votre interface a été configurée, toutes les sockets TCP
locales qui n'ont pas eu de paquets de réponse seront retraitées
pour avoir la bonne adresse. Cela résout le problème posé par une
connexion défectueuse ayant configurée une interface, suivie par
une deuxième tentative réussie (avec une adresse IP
différente).</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ip_forward</b></dt>

<dd>
<p>Le noyau doit-il essayer de transmettre les paquets&nbsp;?
Désactivé par défaut.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ip_local_port_range</b></dt>

<dd>
<p>Intervalle des ports locaux pour les connexions sortantes. En
fait, assez petit par défaut, 1024 à 4999.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ip_no_pmtu_disc</b></dt>

<dd>
<p>Configurez ceci si vous voulez désactiver la découverte du MTU
de chemin, une technique pour déterminer le plus grand MTU possible
sur votre chemin. Voir aussi la section sur la découverte du MTU de
chemin dans le chapitre recette de cuisine.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ipfrag_high_thresh</b></dt>

<dd>
<p>Mémoire maximum utilisée pour réassembler les fragments IP.
Quand ipfrag_high_thresh octets de mémoire sont alloués pour cela,
le gestionnaire de fragments rejetera les paquets jusqu'à ce que
ipfrag_low_thresh soit atteint.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ip_nonlocal_bind</b></dt>

<dd>
<p>Configurez ceci si vous voulez que vos applications soient
capables de se lier à une adresse qui n'appartient pas à une
interface de votre système. Ceci peut être utile quand votre
machine est sur un lien non-permanent (ou même permanent). Vos
services sont donc capables de démarrer et de se lier à une adresse
spécifique quand votre lien est inactif.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ipfrag_low_thresh</b></dt>

<dd>
<p>Mémoire minimale utilisée pour réassembler les fragments IP.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/ipfrag_time</b></dt>

<dd>
<p>Temps en secondes du maintien d'un fragment IP en mémoire.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_abort_on_overflow</b></dt>

<dd>
<p>Une option booléenne contrôlant le comportement dans le cas de
nombreuses connexions entrantes. Quand celle-ci est activée, le
noyau envoie rapidement des paquets RST quand un service est
surchargé.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_fin_timeout</b></dt>

<dd>
<p>Temps de maintien de l'état FIN-WAIT-2 pour une socket dans le
cas où elle a été fermée de notre coté. Le partenaire peut être
défectueux et ne jamais avoir fermé son coté ou même mourir de
manière inattendue. La valeur par défaut est de 60 secondes. La
valeur usuelle utilisée dans le noyau 2.2 était de 180 secondes.
Vous pouvez la remettre, mais rappelez vous que si votre machine a
un serveur WEB surchargé, vous risquez de dépasser la mémoire avec
des kilotonnes de sockets mortes. Les sockets FIN-WAIT2 sont moins
dangereuses que les sockets FIN-WAIT1 par qu'elles consomment au
maximum 1,5K de mémoire mais, elles ont tendance à vivre plus
longtemps. Cf tcp_max_orphans.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_keepalive_time</b></dt>

<dd>
<p>Durée entre l'envoi de deux messages "keepalive" quand l'option
"keepalive" est activée.<br>
Par défaut&nbsp;: 2 heures.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_keepalive_intvl</b></dt>

<dd>
<p>A quelle fréquence les sondes sont retransmises quand une sonde
n'a pas été acquittée.<br>
Par défaut&nbsp;: 75 secondes</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_keepalive_probes</b></dt>

<dd>
<p>Combien de sondes TCP "keepalive" seront envoyées avant de
décider que la connexion est brisée.<br>
Par défaut&nbsp;: 9.<br>
En multipliant par tcp_keepalive_intvl, cela donne le temps qu'un
lien peut être actif sans donner de réponses après l'envoi d'un
"keepalive".</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_max_orphans</b></dt>

<dd>
<p>Nombre maximum de sockets TCP qui ne sont pas reliées à un
descripteur de fichier utilisateur, géré par le système. Si ce
nombre est dépassé, les connexions orphelines sont immédiatement
réinitialisées et un avertissement est envoyé. Cette limite
n'existe seulement que pour prévenir des attaques de déni de
services simples. Vous ne devez pas compter sur ceci ou diminuer
cette limite artificiellement, mais plutôt l'augmenter
(probablement après avoir augmenté la mémoire) si les conditions du
réseau réclament plus que cette valeur par défaut et régler vos
services réseau pour qu'ils détruisent sans tarder de tel état.
Laissez-moi vous rappeler encore que chaque orphelin consomme
jusqu'à environ 64K de mémoire non swappable.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_orphan_retries</b></dt>

<dd>
<p>Combien d'essais avant de détruire une connexion TCP, fermée par
notre coté. La valeur par défaut de 7 correspond à un temps de
environ 50s à 16 min suivant le RTO. Si votre machine supporte un
serveur Web, vous pouvez envisager de baisser cette valeur, dans la
mesure où de telles sockets peuvent consommer des ressources
significatives. Cf tcp_max_orphans.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_max_syn_backlog</b></dt>

<dd>
<p>Nombre maximal de requêtes d'une connexion mémorisée, qui
n'avait pas encore reçue d'accusé de réception du client connecté.
La valeur par défaut est de 1024 pour des systèmes avec plus de 128
Mo de mémoire et 128 pour des machines avec moins de mémoire. Si un
serveur souffre de surcharge, essayez d'augmenter ce nombre.
Attention ! Si vous positionnez une valeur supérieure à 1024, il
serait préférable de changer TCP_SYNQ_HSIZE dans le fichier
include/net/tcp.h pour garder TCP_SYNQ_HSIZE*16 &lt;=
tcp_max_syn_backlog et de recompiler de noyau.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_max_tw_buckets</b></dt>

<dd>
<p>Nombre maximal de sockets timewait gérées par le système
simultanément. Si ce nombre est dépassé, la socket timewait est
immédiatement détruite et un message d'avertissement est envoyé.
Cette limite n'existe que pour prévenir des attaques de déni de
services simples. Vous ne devez pas diminuer cette limite
artificiellement, mais plutôt l'augmenter (probablement après avoir
augmenté la mémoire) si les conditions du réseau réclament plus que
cette valeur par défaut.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_retrans_collapse</b></dt>

<dd>
<p>Compatibilité bug à bug avec certaines imprimantes défectueuses.
Tentative d'envoi de plus gros paquets lors de la retransmission
pour contourner le bug de certaines piles TCP.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_retries1</b></dt>

<dd>
<p>Combien d'essais avant de décider que quelque chose est erroné
et qu'il est nécessaire d'informer de cette suspicion la couche
réseau. La valeur minimal du RFC est de 3, qui est celle par défaut
et qui correspond à un temps de environ 3 sec à 8 min suivant le
RTO.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_retries2</b></dt>

<dd>
<p>Combien d'essais avant de détruire une connexion TCP active. La
<a href="http://www.ietf.org/rfc/rfc1122.txt">RFC 1122</a> précise
que la limite ne devrait pas dépasser 100 secondes. C'est un nombre
trop petit. La valeur par défaut de 15 correspond à un temps de
environ 13 à 30 minutes suivant le RTO.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_rfc1337</b></dt>

<dd>
<p>Ce booléen active un rectificatif pour "l'assassinat hazardeux
des time-wait dans tcp", décrit dans le RFC 1337. Si activé, le
noyau rejette les paquets RST pour les sockets à l'état de
time-wait.<br>
Par défaut&nbsp;: 0</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_sack</b></dt>

<dd>
<p>Utilise un ACK sélectif qui peut être utilisé pour signifier que
des paquets spécifiques sont manquant. Facilite ainsi une
récupération rapide.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_stdurg</b></dt>

<dd>
<p>Utilise l'interprétation de la RFC Host Requirements du champ
TCP pointeur urgent.<br>
La plupart des hôtes utilisent la vieille interprétation BSD. Donc,
si vous activez cette option, il se peut que Linux ne communique
plus correctement avec eux.<br>
Par défaut&nbsp;: FALSE (FAUX)</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_syn_retries</b></dt>

<dd>
<p>Nombre de paquets SYN que le noyau enverra avant de tenter
l'établissement d'une nouvelle connexion.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_synack_retries</b></dt>

<dd>
<p>Pour ouvrir l'autre coté de la connexion, le noyau envoie un SYN
avec un ACK superposé (piggyback), pour accuser réception du SYN
précédemment envoyé. Ceci est la deuxième partie de la poignée de
main à trois voies (threeway handshake). Cette configuration
détermine le nombre de paquets SYN+ACK à envoyer avant que le noyau
n'abandonne la connexion.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_timestamps</b></dt>

<dd>
<p>Les estampilles horaires sont utilisées, entre autre, pour se
protéger du rebouclage des numéros de séquence. On peut concevoir
qu'un lien à 1 gigabit puisse de nouveau rencontrer un numéro de
séquence précédent avec une valeur hors-ligne parcequ'il était
d'une génération précédente. L'estampille horaire permet de
reconnaître cet "ancien paquet".</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_tw_recycle</b></dt>

<dd>
<p>Mise en place du recyclage rapide des sockets TIME-WAIT. La
valeur par défaut est 1. Celle-ci ne devrait pas être changée sans
le conseil/demande d'experts techniques.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/tcp_window_scaling</b></dt>

<dd>
<p>TCP/IP autorise normalement des fenêtres jusqu'à une taille de
65535 octets. Pour des réseaux vraiment rapides, cela peut ne pas
être assez. Les options "windows scaling" autorisent des fenêtres
jusqu'au gigaoctet, ce qui est adapté pour les produits à grande
bande passante.</p>
</dd>
</dl>

<br>
<br>
 

<h3>Configuration des périphériques</h3>

<p>DEV peut désigner soit une interface réelle, soit "all", soit
"default". Default change également les paramètres des interfaces
qui seront créées par la suite.</p>

<dl>
<dt><b>/proc/sys/net/ipv4/conf/DEV/accept_redirects</b></dt>

<dd>
<p>Si un routeur décide que vous l'utilisez à tort (c'est-à-dire
qu'il a besoin de ré-envoyer votre paquet sur la même interface),
il vous enverra un message ICMP Redirect. Cela présente cependant
un petit risque pour la sécurité, et vous pouvez le désactiver ou
utiliser les redirections sécurisées.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/accept_source_route</b></dt>

<dd>
<p>Plus vraiment utilisé. On l'utilisait pour être capable de
donner à un paquet une liste d'adresses IP à visiter. Linux peut
être configuré pour satisfaire cette option IP.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/bootp_relay</b></dt>

<dd>
<p>Accepte les paquets avec une adresse source 0.b.c.d et des
adresses destinations qui ne correspondent ni à cet hôte, ni au
réseau local. On suppose qu'un démon de relai BOOTP interceptera et
transmettra de tels paquets.</p>

<p>La valeur par défaut est 0, puique cette fonctionnalité n'est
pas encore implémentée (noyau 2.2.12).</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/forwarding</b></dt>

<dd>
<p>Active ou désactive la transmission IP sur cette interface.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/log_martians</b></dt>

<dd>
<p>Voir la section sur le "reverse path filters"</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/mc_forwarding</b></dt>

<dd>
<p>Si vous faites de la transmission multidistribution (multicast)
sur cette interface.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/proxy_arp</b></dt>

<dd>
<p>Si vous configurez ceci à 1, toutes les autres interfaces
répondront aux requêtes arp destinées à l'adresse de cette
interface. Peut être très utile si vous mettez en place des
"pseudo-ponts ip". Prenez bien garde d'avoir des masques de
sous-réseau correctes avant d'activer cette option.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/rp_filter</b></dt>

<dd>
<p>Voir la section sur le "reverse path filters"</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/secure_redirects</b></dt>

<dd>
<p>Accepte les messages de redirection ICMP seulement pour les
passerelles indiquées dans la liste des passerelles par défaut.
Activé par défaut.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/send_redirects</b></dt>

<dd>
<p>Active la possibilité d'envoyer des messages de redirections
mentionnées ci-dessus.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/shared_media</b></dt>

<dd>
<p>Si cela n'est pas activé, le noyau ne considère pas que
différents sous-réseaux peuvent communiquer directement sur cette
interface. La configuration par défaut est 'oui'.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/conf/DEV/tag</b></dt>

<dd>
<p>FIXME: à remplir</p>
</dd>
</dl>

<br>
<br>
 

<h3>Politique de voisinage</h3>

<p>DEV peut désigner soit une interface réelle, soit "all", soit
"default". Default change également les paramètres des interfaces
qui seront créées par la suite.</p>

<dl>
<dt><b>/proc/sys/net/ipv4/neigh/DEV/anycast_delay</b></dt>

<dd>
<p>Valeur maximum du délai aléatoire de réponse exprimé en
"jiffies" (1/100 sec) aux messages de sollicitation des voisins.
N'est pas encore implémenté (Linux ne possède pas encore le support
anycast). Maximum for random delay of answers to neighbor
solicitation messages in jiffies (1/100 sec). Not yet implemented
(Linux does not have anycast support yet).</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/app_solicit</b></dt>

<dd>
<p>Détermine le nombre de requêtes à envoyer au démon ARP de
l'espace utilisateur. Utiliser 0 pour désactiver.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/base_reachable_time</b></dt>

<dd>
<p>Une valeur de base utilisée pour le calcul du temps aléatoire
d'accès comme spécifié dans la RFC2461.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/delay_first_probe_time</b></dt>

<dd>
<p>Délai avant de tester pour la première fois si le voisin peut
être atteint. (voir gc_stale_time)</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/gc_stale_time</b></dt>

<dd>
<p>Détermine la fréquence à laquelle on doit vérifier les vieilles
entrées ARP. Si une entrée est obsolète, elle devra de nouveau être
résolue (ce qui est utile quand une adresse IP a été attribuée à
une autre machine). Si ucast_solicit est supérieur à 0, alors on
essaie d'abord d'envoyer un paquet ARP directement à l'hôte connu.
Si cela échoue, et que mcast_solicit est supérieur à 0, alors une
requête ARP est multidiffusée.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/locktime</b></dt>

<dd>
<p>Une entrée ARP n'est remplacée par une nouvelle que si
l'ancienne est au moins présente depuis "locktime". Cela évite trop
d'écriture dans le cache.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/mcast_solicit</b></dt>

<dd>
<p>Nombre maximum d'essais consécutifs pour une solicitation
multicast. Maximum number of retries for multicast
solicitation.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/proxy_delay</b></dt>

<dd>
<p>Temps maximum (le temps réel est aléatoire et compris entre 0 et
proxytime) avant de répondre à une requête ARP pour laquelle nous
avons une entrée de proxy ARP. Peut-être utilisé dans certains cas
pour se prévenir des inondations réseaux.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/proxy_qlen</b></dt>

<dd>
<p>Longueur maximale de la file d'attente du temporisateur de cache
arp en attente (Voir proxy_delay).</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/retrans_time</b></dt>

<dd>
<p>Le temps, exprimé en "jiffies" (1/100 sec), entre deux requêtes
ARP. Utilisé pour la résolution d'adresses et pour déterminer si un
voisin est inaccessible.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/ucast_solicit</b></dt>

<dd>
<p>Nombre maximum de requêtes ARP unicast.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/neigh/DEV/unres_qlen</b></dt>

<dd>
<p>Longueur maximum de la file d'attente pour la requête ARP en
cours&nbsp;: le nombre de paquets qui sont acceptés des autres
couches pendant la résolution ARP d'une adresse.</p>
</dd>

<dt><b>Internet QoS: Architectures and Mechanisms for Quality of
Service, Zheng Wang, ISBN 1-55860-608-4</b></dt>

<dd>
<p>Livre traitant des sujets liés à la qualité de service. Bien
pour comprendre les concepts de base.</p>
</dd>
</dl>

<br>
<br>
 

<h3>Configuration du routage</h3>

<dl>
<dt><b>/proc/sys/net/ipv4/route/error_burst</b></dt>

<dd>
<p>Ces paramètres sont utilisés pour limiter le nombre de messages
d'avertissement écrits les messages du noyau provenant du code du
routage. Plus le paramètre error_burst est grand, moins il y aura
de messages. Error_burst contrôle le moment où les messages seront
supprimés. Les configurations par défaut limitent à un message
d'avertissement toutes les cinq secondes.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/error_cost</b></dt>

<dd>
<p>Ces paramètres sont utilisés pour limiter le nombre de messages
d'avertissement écrits les messages du noyau provenant du code du
routage. Plus le paramètre error_cost est grand, moins il y aura de
messages. Error_burst contrôle le moment où les messages seront
jetés. Les configurations par défaut limitent les messages
d'avertissement à un toutes les cinq secondes.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/flush</b></dt>

<dd>
<p>L'écriture dans ce fichier provoque le vidage du cache du
routage.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/gc_elasticity</b></dt>

<dd>
<p>Valeurs qui contrôlent la fréquence et le comportement de
l'algorithme "garbage collection" pour le cache du routage. Ceci
peut être important en cas d'échec. Au moins gc_timeout secondes
s'écouleront avant que le noyau ne passe à une autre route si la
précédente n'est plus opérationnelle. Configuré par défaut à 300.
Diminuez cette valeur si vous voulez passer plus rapidement ce type
de problème.</p>

<p>Voir aussi <a href=
"http://mailman.ds9a.nl/pipermail/lartc/2002q1/002667.html">ce
message</a> par Ard van Breemen.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/gc_interval</b></dt>

<dd>
<p>Voir /proc/sys/net/ipv4/route/gc_elasticity.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/gc_min_interval</b></dt>

<dd>
<p>Voir /proc/sys/net/ipv4/route/gc_elasticity.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/gc_thresh</b></dt>

<dd>
<p>Voir /proc/sys/net/ipv4/route/gc_elasticity.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/gc_timeout</b></dt>

<dd>
<p>Voir /proc/sys/net/ipv4/route/gc_elasticity.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/max_delay</b></dt>

<dd>
<p>Délai pour le vidage du cache du routage.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/max_size</b></dt>

<dd>
<p>Taille maximum du cache de routage. Les vieilles entrées seront
purgées quand le cache aura atteint cette taille.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/min_adv_mss</b></dt>

<dd>
<p>FIXME: à remplir</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/min_delay</b></dt>

<dd>
<p>Délai pour vider la cache de routage.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/min_pmtu</b></dt>

<dd>
<p>FIXME: à remplir</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/mtu_expires</b></dt>

<dd>
<p>FIXME: à remplir</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/redirect_load</b></dt>

<dd>
<p>Facteurs qui déterminent si plus de redirections ICMP doivent
être envoyées à un hôte spécifique. Aucune redirection ne sera
envoyée une fois que la limite de charge (load limit) ou que le
nombre maximum de redirections a été atteint.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/redirect_number</b></dt>

<dd>
<p>Voir /proc/sys/net/ipv4/route/redirect_load.</p>
</dd>

<dt><b>/proc/sys/net/ipv4/route/redirect_silence</b></dt>

<dd>
<p>Temporisation pour les redirections. Au dela de cette période,
les redirections seront de nouveau envoyées, même si elles ont été
stoppées par le fait que la charge ou le nombre limite aît été
atteint.</p>
</dd>
</dl>

<br>
<br>
 

<hr>
<a href="Advanced-routing-Howto.v0.9-14.html">Page suivante</a> <a
href="Advanced-routing-Howto.v0.9-12.html">Page précédente</a> <a
href="Advanced-routing-Howto.v0.9.html#toc13">Table des
matières</a>
</body>
</html>


	  </TD>
	</TR>
      </TABLE>
    </TD>
  </TR>
  <TR>
    <TD colspan=2 width=100% bgcolor=#990000 align=left>
      <TABLE width=100% border=0 cellpadding=0 cellspacing=4>
        <TR>
	  <TD bgcolor=#990000 align=right>
	    <div class="filemodtime">
	      <i>Dernière modification le : 4 March 2002 12:04</i>
	    </div>
      	    <a style="text-decoration:none" href="http://www.php.net">
              <img src="/prj/inetdoc/images/php-small-trans-dark.gif" border=0 width=88 height=31 alt="php logo">
      	    </a>
      	    &nbsp;&nbsp;
      	    <a style="text-decoration:none" href="http://www.debian.org">
              <img src="/prj/inetdoc/images/openlogo-25.jpg" border=0 width=25 height=30 alt="debian logo">
      	    </a>
      	    &nbsp;&nbsp;
	    <!-- stat_code_start
	    <a style="text-decoration:none" href="http://www.estat.com/getstats?serial=21701747824">
	      <img src="http://perso.estat.com/cgi-bin/perso/21701747824?page=marque_perso" border=0>
	    </a>
	     stat_code_end -->
	    <!-- eStat -->
	    <SCRIPT LANGUAGE="JavaScript">
	      <!--
	      var _UJS=0;
	      //-->
	    </SCRIPT>
	    <SCRIPT LANGUAGE="JavaScript" SRC="http://perso.estat.com/js/m.js">
	    </SCRIPT>
	    <SCRIPT LANGUAGE="JavaScript">
	      <!--
	      if(_UJS) _estat('21701747824','Page_D_Accueil','Accueil');
	      //-->
	    </SCRIPT>
	    <!-- /eStat -->
	  </TD>
	</TR>
      </TABLE>
    </TD>
  </TR>
</TABLE>
</body>
</html>
<!-- END: main.tpl -->
