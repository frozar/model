<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.2beta8 (1.46)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>25. Introduction to IP</TITLE>
<META NAME="description" CONTENT="25. Introduction to IP">
<META NAME="keywords" CONTENT="rute">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.2beta8">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="rute.css">

<LINK REL="next" HREF="node29.html">
<LINK REL="previous" HREF="node27.html">
<LINK REL="up" HREF="rute.html">
<LINK REL="next" HREF="node29.html">
</HEAD>

<BODY BGCOLOR=#FFFFFF >
<TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
<TR><TD align=left bgcolor="#000000">
<FONT COLOR=white>
&nbsp;<A HREF="http://www.icon.co.za/~psheer/rute-purchase.html"><FONT COLOR=white>Purchase</FONT></A>&nbsp;
</FONT>
</TD><TD align=center bgcolor="#000000">
<FONT COLOR=white>
Copyright&nbsp;&#169;&nbsp;2002&nbsp;Paul Sheer. <A HREF="copying.html"><FONT COLOR=white>Click here for copying permissions.</FONT></A>
</FONT>
</TD><TD align=right bgcolor="#000000">
<FONT COLOR=white>
&nbsp;<A HREF="http://www.icon.co.za/~psheer/rute-home.html"><FONT COLOR=white>Home</FONT></A>&nbsp;
</FONT>
</TD></TR>
<TR><TD colspan=2 align=left bgcolor="#ECEBF4">
<IMG SRC="va-btn-small-light-60.png">
</TD><TD align=right bgcolor="#ECEBF4">
<IMG SRC="sflogo2-steel-60.png">
</TD></TR>
</TABLE><BR>

<!--Navigation Panel-->
<A NAME="tex2html2268"
  HREF="node29.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2264"
  HREF="rute.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2258"
  HREF="node27.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2266"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2269"
  HREF="node29.html">26. TCP and UDP</A>
<B> Up:</B> <A NAME="tex2html2265"
  HREF="rute.html">rute</A>
<B> Previous:</B> <A NAME="tex2html2259"
  HREF="node27.html">24. Source and Binary</A>
 &nbsp <B>  <A NAME="tex2html2267"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html2270"
  HREF="#SECTION002810000000000000000">25.1 Internet Communication</A>
<LI><A NAME="tex2html2271"
  HREF="#SECTION002820000000000000000">25.2 Special IP Addresses</A>
<LI><A NAME="tex2html2272"
  HREF="#SECTION002830000000000000000">25.3 Network Masks and Addresses</A>
<LI><A NAME="tex2html2273"
  HREF="#SECTION002840000000000000000">25.4 Computers on a LAN</A>
<LI><A NAME="tex2html2274"
  HREF="#SECTION002850000000000000000">25.5 Configuring Interfaces</A>
<LI><A NAME="tex2html2275"
  HREF="#SECTION002860000000000000000">25.6 Configuring Routing</A>
<LI><A NAME="tex2html2276"
  HREF="#SECTION002870000000000000000">25.7 Configuring Startup Scripts</A>
<UL>
<LI><A NAME="tex2html2277"
  HREF="#SECTION002871000000000000000">25.7.1 RedHat networking scripts</A>
<LI><A NAME="tex2html2278"
  HREF="#SECTION002872000000000000000">25.7.2 Debian networking scripts</A>
</UL>
<LI><A NAME="tex2html2279"
  HREF="#SECTION002880000000000000000">25.8 Complex Routing -- a Many-Hop Example</A>
<LI><A NAME="tex2html2280"
  HREF="#SECTION002890000000000000000">25.9 Interface Aliasing -- Many IPs on One Physical Card</A>
<LI><A NAME="tex2html2281"
  HREF="#SECTION0028100000000000000000">25.10 Diagnostic Utilities</A>
<UL>
<LI><A NAME="tex2html2282"
  HREF="#SECTION0028101000000000000000">25.10.1 <TT>
<FONT COLOR="#0000ff">ping</FONT></TT></A>
<LI><A NAME="tex2html2283"
  HREF="#SECTION0028102000000000000000">25.10.2 <TT>
<FONT COLOR="#0000ff">traceroute</FONT></TT></A>
<LI><A NAME="tex2html2284"
  HREF="#SECTION0028103000000000000000">25.10.3 <TT>
<FONT COLOR="#0000ff">tcpdump</FONT></TT></A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION002800000000000000000">
25. Introduction to IP</A>
</H1>

<P>
<A NAME="chap:introtoip"></A><A NAME="chap:ip"></A><I>IP</I> stands for <I>Internet Protocol</I>. It is the method by which data
is transmitted over the Internet.

<P>

<H1><A NAME="SECTION002810000000000000000">
25.1 Internet Communication</A>
</H1>

<P>
At a hardware level, network cards are capable
of transmitting <I>packets</I> (also called <I>datagrams</I>) of data between
one another. A packet contains a small block of, say, 1 kilobyte of data (in
contrast to serial lines, which transmit continuously).
All Internet communication
occurs through transmission of packets, which travel intact, even between machines
on opposite sides of the world.

<P>
Each packet contains a header of 24 bytes or more which precedes the data. Hence,
slightly more than the said 1 kilobyte of data would be found on the wire. When
a packet is transmitted, the header would obviously contain the destination
machine. Each machine is hence given a unique <I>IP address</I>--a
32-bit number. There are no machines on the Internet that do
not have an IP address.

<P>
The header bytes are shown in Table <A HREF="node28.html#table:ipheader">25.1</A>.

<P>
<A NAME="40317"></A>
<TABLE CELLPADDING=1 BORDER="1">
<CAPTION><STRONG>Table 25.1:</STRONG>
IP header bytes</CAPTION>
<TR><TD ALIGN="LEFT"><A NAME="table:ipheader"></A><B>Bytes</B></TD>
<TH ALIGN="LEFT"><B>Description</B></TH>
</TR>
<TR><TD ALIGN="LEFT">0</TD>
<TD ALIGN="LEFT">bits 0-3: Version, bits 4-7: Internet Header Length (IHL)</TD>
</TR>
<TR><TD ALIGN="LEFT">1</TD>
<TD ALIGN="LEFT">Type of service (TOS)</TD>
</TR>
<TR><TD ALIGN="LEFT">2-3</TD>
<TD ALIGN="LEFT">Length</TD>
</TR>
<TR><TD ALIGN="LEFT">4-5</TD>
<TD ALIGN="LEFT">Identification</TD>
</TR>
<TR><TD ALIGN="LEFT">6-7</TD>
<TD ALIGN="LEFT">bits 0-3: Flags, bits 4-15: Offset</TD>
</TR>
<TR><TD ALIGN="LEFT">8</TD>
<TD ALIGN="LEFT">Time to live (TTL)</TD>
</TR>
<TR><TD ALIGN="LEFT">9</TD>
<TD ALIGN="LEFT">Type</TD>
</TR>
<TR><TD ALIGN="LEFT">10-11</TD>
<TD ALIGN="LEFT">Checksum</TD>
</TR>
<TR><TD ALIGN="LEFT">12-15</TD>
<TD ALIGN="LEFT">Source IP address</TD>
</TR>
<TR><TD ALIGN="LEFT">16-19</TD>
<TD ALIGN="LEFT">Destination IP address</TD>
</TR>
<TR><TD ALIGN="LEFT">20-IHL*4-1</TD>
<TD ALIGN="LEFT">Options + padding to round up to four bytes</TD>
</TR>
<TR><TD ALIGN="CENTER" COLSPAN=2>Data begins at IHL*4 and ends at Length-1</TD>
</TR>
</TABLE>

<P>
<B>Version</B> for the mean time is 4, although <I>IP Next Generation</I>
(version 6) is in the (slow) process of deployment. <B>IHL</B> is the length of
the header divided by 4. <B>TOS</B> (<I>Type of Service</I>) is a somewhat esoteric field for tuning
performance and is not explained here. The <B>Length</B> field is the length
in bytes of the entire packet including the header. The <B>Source</B> and
<B>Destination</B> are the IP addresses <I>from</I> and <I>to</I> which the packet
is coming/going.

<P>
<A NAME="sec:lan"></A>
<P>
The above description constitutes the view of the Internet that a machine has.
However, physically, the Internet
consists of many small high-speed networks (like those of a company or a university)
called <I>Local Area Networks</I>, or <I>LAN</I>s.
These are all connected to each other
by lower-speed long distance links. On a LAN, the <I>raw</I> medium of transmission is not a packet but
an Ethernet <I>frame</I>. Frames are analogous to packets (having both a header
and a data portion) but are sized to
be efficient with particular hardware. IP packets are encapsulated within frames,
where the IP packet fits within the <B>Data</B> part of the frame. A frame
may, however, be too small to hold an entire IP packet, in which case the IP packet
is split into several smaller packets. This group of smaller IP packets is then
given an identifying number, and each smaller packet will then have the <B>Identification</B>
field set with that number and the <B>Offset</B> field set to indicate its
position within the actual packet. On the other side of the connection, the destination machine
will reconstruct a packet from all the smaller subpackets that have the same
<B>Identification</B> field.

<P>
The convention for writing an IP address in human readable form is
<I>dotted decimal</I> notation like <TT>
<FONT COLOR="#0000ff">152.2.254.81</FONT></TT>, where
each number is a byte and is hence in the range of 0 to 255.
Hence the entire address <I>space</I> is in the range of
<TT>
<FONT COLOR="#0000ff">0.0.0.0</FONT></TT> to
<TT>
<FONT COLOR="#0000ff">255.255.255.255</FONT></TT>. To further organize
the assignment of addresses, each 32-bit address is divided into
two parts, a <I>network</I> and a <I>host</I> part of the
address, as shown in Figure <A HREF="node28.html#fig:ipaddressclasses">25.1</A>.

<P>

<P></P>
<DIV ALIGN="CENTER"><A NAME="fig:ipaddressclasses"></A><A NAME="40666"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 25.1:</STRONG>
IP address classes</CAPTION>
<TR><TD><IMG
 WIDTH="556" HEIGHT="119" BORDER="0"
 SRC="img27.png"
 ALT="\begin{figure}\begin{center}
\setlength{\unitlength}{2.400000pt}\begin{picture}(...
...}\}
% put(96.00,21.50)\{ circle*\{1.20\}\}
\end{picture}\end{center}\end{figure}"></TD></TR>
</TABLE>
</DIV><P></P>

<P>
The network part of the address designates the LAN, and the host part the particular
machine on the LAN. Now, because it was unknown at the time of specification
whether there would one day be more LANs or more machines per LAN, three different
classes of address were created.

<P>
<I>Class A</I> addresses begin with the first
bit of the network part set to 0 (hence, a Class A address always has the first
dotted decimal number less than <TT>
<FONT COLOR="#0000ff">128</FONT></TT>). The next 7 bits give the identity of the
LAN, and the remaining 24 bits give the identity of an actual machine on that
LAN. A Class B address begins with a 1 and then a 0 (first decimal number is <TT>
<FONT COLOR="#0000ff">128</FONT></TT>
through <TT>
<FONT COLOR="#0000ff">191</FONT></TT>). The next 14 bits give the LAN, and the remaining 16 bits give the
machine. Most universities, like the address above, are Class B addresses.
Lastly, Class C addresses start with a 1 1 0 (first decimal number is <TT>
<FONT COLOR="#0000ff">192</FONT></TT> through
<TT>
<FONT COLOR="#0000ff">223</FONT></TT>), and the next 21 bits and then the next 8 bits are the LAN and machine,
respectively. Small companies tend use Class C addresses.

<P>
In practice, few organizations require Class A addresses. A university
or large company might use a Class B address but then would have its own
further subdivisions, like using the third dotted decimal as a department (bits
16 through 23) and the last dotted decimal (bits 24 through 31) as the machine
within that department. In this way the LAN becomes a micro-Internet in itself. Here,
the LAN is called a <I>network</I> and the various departments are each called
a <I>subnet</I>.

<P>

<H1><A NAME="SECTION002820000000000000000">
25.2 Special IP Addresses</A>
</H1>

<P>
Some special-purposes IP addresses are never used
on the open Internet. <TT>
<FONT COLOR="#0000ff">192.168.0.0</FONT></TT> through <TT>
<FONT COLOR="#0000ff">192.168.255.255</FONT></TT> are private
addresses perhaps used inside a local LAN that does not communicate directly with
the Internet. <TT>
<FONT COLOR="#0000ff">127.0.0.0</FONT></TT> through <TT>
<FONT COLOR="#0000ff">127.255.255.255</FONT></TT> are used for communication
with the <I>localhost</I>--that is, the machine itself. Usually, <TT>
<FONT COLOR="#0000ff">127.0.0.1</FONT></TT>
is an IP address pointing to the machine itself.
Further, <TT>
<FONT COLOR="#0000ff">172.16.0.0</FONT></TT> through <TT>
<FONT COLOR="#0000ff">172.31.255.255</FONT></TT> are additional private addresses
for very large internal networks, and <TT>
<FONT COLOR="#0000ff">10.0.0.0</FONT></TT> through <TT>
<FONT COLOR="#0000ff">10.255.255.255</FONT></TT> are
for even larger ones.

<P>

<H1><A NAME="SECTION002830000000000000000">
25.3 Network Masks and Addresses</A>
</H1>

<P>
Consider again the example of a university with a Class B
address. It might have an IP address range of
<TT>
<FONT COLOR="#0000ff">137.158.0.0</FONT></TT> through <TT>
<FONT COLOR="#0000ff">137.158.255.255</FONT></TT>. Assume it was decided that
the astronomy department should get 512 of its own IP
addresses, <TT>
<FONT COLOR="#0000ff">137.158.26.0</FONT></TT> through <TT>
<FONT COLOR="#0000ff">137.158.27.255</FONT></TT>. We say
that astronomy has a <I>network address</I> of <TT>
<FONT COLOR="#0000ff">137.158.26.0</FONT></TT>.
The machines there all have a <I>network mask</I> of
<TT>
<FONT COLOR="#0000ff">255.255.254.0</FONT></TT>. A particular machine in astronomy may
have an <I>IP address</I> of <TT>
<FONT COLOR="#0000ff">137.158.27.158</FONT></TT>. This
terminology is used later. Figure <A HREF="node28.html#fig:netmaskeg">25.2</A> illustrates
this example.

<P>

<P></P>
<DIV ALIGN="CENTER"><A NAME="fig:netmaskeg"></A><A NAME="40761"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 25.2:</STRONG>
Dividing an address into network and host portions</CAPTION>
<TR><TD><IMG
 WIDTH="602" HEIGHT="165" ALIGN="BOTTOM" BORDER="0"
 SRC="img28.png"
 ALT="\begin{center}
{\small\begin{tabular}{\vert l \vert c @{.} c @{.} c @{.} c \vert...
...~0000~000\!\overbrace{1~1001~1110}$\ \\
\cline{1-6}
\end{tabular}}
\end{center}"></TD></TR>
</TABLE>
</DIV><P></P>

<P>

<H1><A NAME="SECTION002840000000000000000">
25.4 Computers on a LAN</A>
</H1>

<P>
In this section we will use the term LAN to indicate a network of computers that are all more or less
connected directly together by Ethernet cables (this is common for small businesses with up to
about 50 machines). Each machine has an Ethernet card which is referred to as
<TT>
<FONT COLOR="#0000ff">eth0</FONT></TT> throughout all command-line operations. If there is more than
one card on a single machine, then these are named <TT>
<FONT COLOR="#0000ff">eth0</FONT></TT>, <TT>
<FONT COLOR="#0000ff">eth1</FONT></TT>, <TT>
<FONT COLOR="#0000ff">eth2</FONT></TT>, etc., and
are each called a <I>network interface</I>
(or just <I>interface</I>, or sometimes <I>Ethernet port</I>) of the machine.

<P>
LANs work as follows.
Network cards transmit a frame to the LAN, and other network cards read that
frame from the LAN. If any one network card transmits a frame, then <I>all</I>
other network cards can see that frame.
If a card starts to transmit a frame
while another card is in the process of transmitting a frame, then a
<I>clash</I>
is said to have occurred, and the card waits a random amount of time and then
tries again. Each network card has a physical address of 48 bits called the
<I>hardware address</I> (which is inserted at the time of its manufacture
and has nothing to do with IP addresses). Each frame has a destination address in
its header that tells what network card it is destined for, so that network
cards ignore frames that are not addressed to them.

<P>
Since frame transmission is governed by the network cards, the destination
hardware address must be determined from the destination IP address before
a packet is sent to a particular machine. This is done is through the
<I>Address Resolution Protocol</I>
(ARP). A machine will transmit
a special packet that asks ``What hardware address is this IP address?'' The
guilty machine then responds, and the transmitting machine stores the result
for future reference. Of course, if you suddenly switch network cards, then other
machines on the LAN will have the wrong information, so ARP has time-outs and
re-requests built into the protocol. Try typing the command
<TT>
<FONT COLOR="#0000ff">arp</FONT></TT> to get
a list of hardware address to IP mappings.

<P>

<H1><A NAME="SECTION002850000000000000000">
25.5 Configuring Interfaces</A>
</H1>

<P>
Most distributions have a generic way
to configure your interfaces. Here, however, we first look at a
complete network configuration using only raw networking commands.

<P>
We first create a <TT>
<FONT COLOR="#0000ff">lo</FONT></TT> interface. This is called
the <I>loopback</I> device (and has nothing to do with loopback block devices:
<TT>
<FONT COLOR="#0000ff">/dev/loop</FONT></TT><I>?</I> files). The loopback device is an imaginary network card that is
used to communicate with the machine itself; for instance, if you are
<TT>
<FONT COLOR="#0000ff">telnet</FONT></TT>ing to the local machine, you are actually connecting
via the loopback device. The <TT>
<FONT COLOR="#0000ff">ifconfig</FONT></TT> (<TT>
<FONT COLOR="#0000ff">i</FONT></TT><I>nter</I><TT>
<FONT COLOR="#0000ff">f</FONT></TT><I>ace</I> <TT>
<FONT COLOR="#0000ff">config</FONT></TT><I>ure</I>)
command is used to do anything with interfaces. First, run

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/ifconfig&nbsp;lo&nbsp;down</code><br>
<code>/sbin/ifconfig&nbsp;eth0&nbsp;down</code><br>
</FONT></TD></TR></TABLE><P>
to delete any existing interfaces, then run

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/ifconfig&nbsp;lo&nbsp;127.0.0.1</code><br>
</FONT></TD></TR></TABLE><P>
which creates the loopback interface.

<P>
Create the Ethernet interface with:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/ifconfig&nbsp;eth0&nbsp;192.168.3.9&nbsp;broadcast&nbsp;192.168.3.255&nbsp;netmask&nbsp;255.255.255.0</code><br>
</FONT></TD></TR></TABLE><P>
The <TT>
<FONT COLOR="#0000ff">broadcast</FONT></TT> address is a special
address that all machines respond to. It is usually the first or last address
of the particular network.

<P>
Now run

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/ifconfig</code><br>
</FONT></TD></TR></TABLE><P>
to view the interfaces. The output will be

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>10</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Ethernet&nbsp;&nbsp;HWaddr&nbsp;00:00:E8:3B:2D:A2&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:192.168.3.9&nbsp;&nbsp;Bcast:192.168.3.255&nbsp;&nbsp;Mask:255.255.255.0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UP&nbsp;BROADCAST&nbsp;RUNNING&nbsp;MULTICAST&nbsp;&nbsp;MTU:1500&nbsp;&nbsp;Metric:1</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX&nbsp;packets:1359&nbsp;errors:0&nbsp;dropped:0&nbsp;overruns:0&nbsp;frame:0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TX&nbsp;packets:1356&nbsp;errors:0&nbsp;dropped:0&nbsp;overruns:0&nbsp;carrier:0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;collisions:0&nbsp;txqueuelen:100&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interrupt:11&nbsp;Base&nbsp;address:0xe400&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Local&nbsp;Loopback&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:127.0.0.1&nbsp;&nbsp;Mask:255.0.0.0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UP&nbsp;LOOPBACK&nbsp;RUNNING&nbsp;&nbsp;MTU:3924&nbsp;&nbsp;Metric:1</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX&nbsp;packets:53175&nbsp;errors:0&nbsp;dropped:0&nbsp;overruns:0&nbsp;frame:0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TX&nbsp;packets:53175&nbsp;errors:0&nbsp;dropped:0&nbsp;overruns:0&nbsp;carrier:0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;collisions:0&nbsp;txqueuelen:0&nbsp;</code><br>
</FONT></TD></TR></TABLE><P>
which shows various interesting bits, like the 48-bit
hardware address of the network card (hex bytes <TT>
<FONT COLOR="#0000ff">00:00:E8:3B:2D:A2</FONT></TT>).

<P>

<H1><A NAME="SECTION002860000000000000000">
25.6 Configuring Routing</A>
</H1>

<P>
The interfaces are now active. However, nothing tells
the kernel what packets should go to what interface, even
though we might expect such behavior to happen on its own.
With U<SMALL>NIX</SMALL>, you must explicitly tell the kernel to send particular
packets to particular interfaces.

<P>
Any packet arriving through any interface is pooled by the
kernel. The kernel then looks at each packet's destination
address and decides, based on the destination, where it should
be sent. It doesn't matter where the packet came from; once the
kernel <I>has</I> the packet, it's what its destination address says that
matters. It is up to the rest of the network to ensure that packets
do not arrive at the wrong interfaces in the first place.

<P>
We know that any packet having the network address
<TT>
<FONT COLOR="#0000ff">127.</FONT></TT><I>???</I><TT>
<FONT COLOR="#0000ff">.</FONT></TT><I>???</I><TT>
<FONT COLOR="#0000ff">.</FONT></TT><I>???</I> must go
to the loopback device (this is more or less a convention).
The command,

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;127.0.0.0&nbsp;netmask&nbsp;255.0.0.0&nbsp;lo</code><br>
</FONT></TD></TR></TABLE><P>
adds a <I>route</I> to the
network <TT>
<FONT COLOR="#0000ff">127.0.0.0</FONT></TT>, albeit
an imaginary one.

<P>
The <TT>
<FONT COLOR="#0000ff">eth0</FONT></TT> device can be routed as follows:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;192.168.3.0&nbsp;netmask&nbsp;255.255.255.0&nbsp;eth0</code><br>
</FONT></TD></TR></TABLE><P>
The command to display the current routes is

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;-n</code><br>
</FONT></TD></TR></TABLE><P>
(<TT>
<FONT COLOR="#0000ff">-n</FONT></TT> causes <TT>
<FONT COLOR="#0000ff">route</FONT></TT> to not print
IP addresses as host names) with the following output:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>Kernel&nbsp;IP&nbsp;routing&nbsp;table</code><br>
<code>Destination&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gateway&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Genmask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flags&nbsp;Metric&nbsp;Ref&nbsp;&nbsp;&nbsp;&nbsp;Use&nbsp;Iface</code><br>
<code>127.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;lo</code><br>
<code>192.168.3.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.0&nbsp;&nbsp;&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
</FONT></TD></TR></TABLE><P>
This output has the meaning, ``packets with destination address <TT>
<FONT COLOR="#0000ff">127.0.0.0/255.0.0.0</FONT></TT> <FONT COLOR="#ffa500">[The
notation <I>network/mask</I> is often used to denote ranges of IP address.]</FONT>must be sent to the <TT>
<FONT COLOR="#0000ff">lo</FONT></TT>opback device,'' and ``packets with destination address 
<TT>
<FONT COLOR="#0000ff">192.168.3.0/255.255.255.0</FONT></TT> must be sent to <TT>
<FONT COLOR="#0000ff">eth0</FONT></TT>.'' <TT>
<FONT COLOR="#0000ff">Gateway</FONT></TT>
is zero, hence, is not set (see the following commands).

<P>
The routing table now routes <TT>
<FONT COLOR="#0000ff">127.</FONT></TT> and 
<TT>
<FONT COLOR="#0000ff">192.168.3.</FONT></TT> packets. Now we need a route
for the remaining possible IP addresses. U<SMALL>NIX</SMALL> can have a route
that says to send packets with particular destination IP
addresses to another machine on the LAN, from whence they
might be forwarded elsewhere. This is sometimes called the
<I>gateway</I> machine. The command is:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;&#060;network-address&#062;&nbsp;netmask&nbsp;&#060;netmask&#062;&nbsp;gw&nbsp;\</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#060;gateway-ip-address&#062;&nbsp;&#060;interface&#062;</code><br>
</FONT></TD></TR></TABLE><P>
This is the most general form of the command, but it's often
easier to just type:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;add&nbsp;default&nbsp;gw&nbsp;&#060;gateway-ip-address&#062;&nbsp;&#060;interface&#062;</code><br>
</FONT></TD></TR></TABLE><P>
when we want to add a route that applies to all remaining packets.
This route is called the <I>default gateway</I>.
<TT>
<FONT COLOR="#0000ff">default</FONT></TT> signifies all packets; it is the same as

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;0.0.0.0&nbsp;netmask&nbsp;0.0.0.0&nbsp;gw&nbsp;&#060;gateway-ip-address&#062;&nbsp;\</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#060;interface&#062;</code><br>
</FONT></TD></TR></TABLE><P>
but since routes are ordered according to <TT>
<FONT COLOR="#0000ff">netmask</FONT></TT>,
<I>more specific routes are used in preference to less specific
ones</I>.

<P>
Finally, you can set your host name with:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>hostname&nbsp;cericon.cranzgot.co.za</code><br>
</FONT></TD></TR></TABLE><P>

<P>
A summary of the example commands so far is

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/ifconfig&nbsp;lo&nbsp;down</code><br>
<code>/sbin/ifconfig&nbsp;eth0&nbsp;down</code><br>
<code>/sbin/ifconfig&nbsp;lo&nbsp;127.0.0.1</code><br>
<code>/sbin/ifconfig&nbsp;eth0&nbsp;192.168.3.9&nbsp;broadcast&nbsp;192.168.3.255&nbsp;netmask&nbsp;255.255.255.0</code><br>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;127.0.0.0&nbsp;netmask&nbsp;255.0.0.0&nbsp;lo</code><br>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;192.168.3.0&nbsp;netmask&nbsp;255.255.255.0&nbsp;eth0</code><br>
<code>/sbin/route&nbsp;add&nbsp;default&nbsp;gw&nbsp;192.168.3.254&nbsp;eth0</code><br>
<code>hostname&nbsp;cericon.cranzgot.co.za</code><br>
</FONT></TD></TR></TABLE><P>

<P>
<I>Although these 7 commands will get your network working,
you should not do such a manual configuration. The next section
explains how to configure your startup scripts.</I>

<P>

<H1><A NAME="SECTION002870000000000000000">
25.7 Configuring Startup Scripts</A>
</H1>

<P>
Most distributions will have a modular and extensible system of
startup scripts that initiate networking.

<P>

<H2><A NAME="SECTION002871000000000000000">
25.7.1 RedHat networking scripts</A>
</H2>

<P>
RedHat systems contain the directory <TT>
<FONT COLOR="#0000ff">/etc/sysconfig/</FONT></TT>,
which contains configuration files to automatically bring up networking.

<P>
The file <TT>
<FONT COLOR="#0000ff">/etc/sysconfig/network-scripts/ifcfg-eth0</FONT></TT> 
contains:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>DEVICE=eth0</code><br>
<code>IPADDR=192.168.3.9</code><br>
<code>NETMASK=255.255.255.0</code><br>
<code>NETWORK=192.168.3.0</code><br>
<code>BROADCAST=192.168.3.255</code><br>
<code>ONBOOT=yes</code><br>
</FONT></TD></TR></TABLE><P>

<P>
The file <TT>
<FONT COLOR="#0000ff">/etc/sysconfig/network</FONT></TT>
contains:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>NETWORKING=yes</code><br>
<code>HOSTNAME=cericon.cranzgot.co.za</code><br>
<code>GATEWAY=192.168.3.254</code><br>
</FONT></TD></TR></TABLE><P>

<P>
You can see that these two files are equivalent to the example
configuration done above. These two files can take an enormous
number of options for the various protocols besides IP,
but this is the most common configuration.

<P>
The file <TT>
<FONT COLOR="#0000ff">/etc/sysconfig/network-scripts/ifcfg-lo</FONT></TT> for the
loopback device will be configured automatically at installation;
you should never need to edit it.

<P>
To stop and start networking (i.e., to bring up and down the
interfaces and routing), type (alternative commands in parentheses):

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/etc/init.d/network&nbsp;stop</code><br>
<code>(&nbsp;/etc/rc.d/init.d/network&nbsp;stop&nbsp;)</code><br>
<code>/etc/init.d/network&nbsp;start</code><br>
<code>(&nbsp;/etc/rc.d/init.d/network&nbsp;start&nbsp;)</code><br>
</FONT></TD></TR></TABLE><P>
which will indirectly read your <TT>
<FONT COLOR="#0000ff">/etc/sysconfig/</FONT></TT>
files.

<P>
You can add further files, say, <TT>
<FONT COLOR="#0000ff">ifcfg-eth1</FONT></TT> (under <TT>
<FONT COLOR="#0000ff">/etc/sysconfig/network-scripts/</FONT></TT>)
for a secondary Ethernet device. For example,
<TT>
<FONT COLOR="#0000ff">ifcfg-eth1</FONT></TT> could contain

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>DEVICE=eth1</code><br>
<code>IPADDR=192.168.4.1</code><br>
<code>NETMASK=255.255.255.0</code><br>
<code>NETWORK=192.168.4.0</code><br>
<code>BROADCAST=192.168.4.255</code><br>
<code>ONBOOT=yes</code><br>
</FONT></TD></TR></TABLE><P>
and then run <TT>
<FONT COLOR="#0000ff">echo "1" &gt; /proc/sys/net/ipv4/ip_forward</FONT></TT>
to
enable packet forwarding between your two interfaces.

<P>

<H2><A NAME="SECTION002872000000000000000">
25.7.2 Debian networking scripts</A>
</H2>

<P>
Debian, on the other hand, has a directory <TT>
<FONT COLOR="#0000ff">/etc/network/</FONT></TT> containing a
file <TT>
<FONT COLOR="#0000ff">/etc/network/interfaces</FONT></TT>. <FONT COLOR="#ffa500">[As usual, Debian has a neat and
clean approach.]</FONT> (See also <TT>
<FONT COLOR="#0000ff">interfaces</FONT></TT>(5).) For the same configuration
as above, this file would contain:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>iface&nbsp;lo&nbsp;inet&nbsp;loopback</code><br>
<code>iface&nbsp;eth0&nbsp;inet&nbsp;static</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;192.168.3.9</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;netmask&nbsp;255.255.255.0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;gateway&nbsp;192.168.3.254</code><br>
</FONT></TD></TR></TABLE><P>

<P>
The file <TT>
<FONT COLOR="#0000ff">/etc/network/options</FONT></TT>
 contains the same forwarding (and some other) options:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>ip_forward=no</code><br>
<code>spoofprotect=yes</code><br>
<code>syncookies=no</code><br>
</FONT></TD></TR></TABLE><P>

<P>
To stop and start networking (i.e., bring up and down the
interfaces and routing), type

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/etc/init.d/networking&nbsp;stop</code><br>
<code>/etc/init.d/networking&nbsp;start</code><br>
</FONT></TD></TR></TABLE><P>
which will indirectly read your
<TT>
<FONT COLOR="#0000ff">/etc/network/interfaces</FONT></TT> file.

<P>
Actually, the <TT>
<FONT COLOR="#0000ff">/etc/init.d/networking</FONT></TT> script merely runs
the <TT>
<FONT COLOR="#0000ff">ifup</FONT></TT> and <TT>
<FONT COLOR="#0000ff">ifdown</FONT></TT> commands.
See <TT>
<FONT COLOR="#0000ff">ifup</FONT></TT>(8). You can alternatively run these commands directly for finer control.

<P>
We add further interfaces similar to the RedHat example above by appending
to the <TT>
<FONT COLOR="#0000ff">/etc/network/interfaces</FONT></TT> file.
The Debian equivalent is,

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>iface&nbsp;lo&nbsp;inet&nbsp;loopback</code><br>
<code>iface&nbsp;eth0&nbsp;inet&nbsp;static</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;192.168.3.9</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;netmask&nbsp;255.255.255.0</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;gateway&nbsp;192.168.3.254</code><br>
<code>iface&nbsp;eth1&nbsp;inet&nbsp;static</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;192.168.4.1</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;netmask&nbsp;255.255.255.0</code><br>
</FONT></TD></TR></TABLE><P>
and then set <TT>
<FONT COLOR="#0000ff">ip_forward=yes</FONT></TT> in your <TT>
<FONT COLOR="#0000ff">/etc/network/options</FONT></TT> file.

<P>
Finally, whereas RedHat sets its host name from the line <TT>
<FONT COLOR="#0000ff">HOSTNAME=</FONT></TT>...
in <TT>
<FONT COLOR="#0000ff">/etc/sysconfig/network</FONT></TT>, Debian sets it from the contents of the
file <TT>
<FONT COLOR="#0000ff">/etc/hostname</FONT></TT>, which, in the present case, would contain just

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>cericon.cranzgot.co.za</code><br>
</FONT></TD></TR></TABLE><P>

<P>

<H1><A NAME="SECTION002880000000000000000">
25.8 Complex Routing -- a Many-Hop Example</A>
</H1>

<P>
Consider two distant LANs that need to communicate. Two dedicated
machines, one on each LAN, are linked by some alternative method (in
this case, a permanent serial line), as shown in Figure <A HREF="node28.html#fig:tworemoteconn">25.3</A>.

<P>

<P></P>
<DIV ALIGN="CENTER"><A NAME="fig:tworemoteconn"></A><A NAME="40942"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 25.3:</STRONG>
Two remotely connected networks</CAPTION>
<TR><TD><IMG
   BORDER="0"
 SRC="rmtlynet.png"
 ALT="\begin{figure}\begin{center}
{\setlength{\epsfxsize}{\textwidth}\epsfbox{route.eps}}
\end{center}\end{figure}"></TD></TR>
</TABLE>
</DIV><P></P>

<P>
This arrangement can be summarized by five machines
<B>X</B>, <B>A</B>, <B>B</B>, <B>C</B>, and <B>D</B>. Machines
<B>X</B>, <B>A</B>, and <B>B</B> form LAN <B>1</B> on subnet <TT>
<FONT COLOR="#0000ff">192.168.1.0/26</FONT></TT>.
Machines <B>C</B> and <B>D</B> form LAN <B>2</B> on subnet
<TT>
<FONT COLOR="#0000ff">192.168.1.128/26</FONT></TT>. Note how we use the ``<TT>
<FONT COLOR="#0000ff">/26</FONT></TT>'' to indicate
that only the first 26 bits are network address bits, while the remaining
6 bits are host address bits. This means that we can have at most

<FONT COLOR="#0000ff"><IMG
 WIDTH="64" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img30.png"
 ALT="\bgroup\color{blue}$2^6~=~64$\egroup"></FONT> IP addresses on each of LAN <B>1</B> and <B>2</B>.
Our dedicated serial link comes between machines <B>B</B> and
<B>C</B>.

<P>
Machine <B>X</B> has IP address
<TT>
<FONT COLOR="#0000ff">192.168.1.1</FONT></TT>. This machine is the
gateway to the Internet. The Ethernet port of machine <B>B</B>
is simply configured with an IP address of
<TT>
<FONT COLOR="#0000ff">192.168.1.2</FONT></TT> with a default gateway of <TT>
<FONT COLOR="#0000ff">192.168.1.1</FONT></TT>. Note
that the broadcast address is <TT>
<FONT COLOR="#0000ff">192.168.1.63</FONT></TT> (the last 6 bits set
to 1).

<P>
The Ethernet port of machine <B>C</B> is configured with
an IP address of <TT>
<FONT COLOR="#0000ff">192.168.1.129</FONT></TT>. No default gateway should
be set until serial line is configured.

<P>
We will make the network between <B>B</B> and <B>C</B> subnet
<TT>
<FONT COLOR="#0000ff">192.168.1.192/26</FONT></TT>. It is effectively a LAN on its own, even
though only two machines can ever be connected. Machines
<B>B</B> and <B>C</B> will have IP addresses <TT>
<FONT COLOR="#0000ff">192.168.1.252</FONT></TT>
and <TT>
<FONT COLOR="#0000ff">192.168.1.253</FONT></TT>, respectively, on their facing interfaces.

<P>
This is a real-life example with an unreliable serial
link. To keep the link up requires <TT>
<FONT COLOR="#0000ff">pppd</FONT></TT> and a shell script
to restart the link if it dies. The <TT>
<FONT COLOR="#0000ff">pppd</FONT></TT> program is covered
in Chapter <A HREF="node44.html#chap:pppdialup">41</A>. The script for Machine <B>B</B>
is:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>#!/bin/sh</code><br>
<code>while&nbsp;true&nbsp;&#059;&nbsp;do</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;pppd&nbsp;lock&nbsp;local&nbsp;mru&nbsp;296&nbsp;mtu&nbsp;296&nbsp;nodetach&nbsp;nocrtscts&nbsp;nocdtrcts&nbsp;\</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;192.168.1.252:192.168.1.253&nbsp;/dev/ttyS0&nbsp;115200&nbsp;noauth&nbsp;\</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;lcp-echo-interval&nbsp;1&nbsp;lcp-echo-failure&nbsp;2&nbsp;lcp-max-terminate&nbsp;1&nbsp;lcp-restart&nbsp;1</code><br>
<code>done</code><br>
</FONT></TD></TR></TABLE><P>
Note that if the link were an Ethernet link instead
(on a second Ethernet card), and/or a genuine LAN between machines
<B>B</B> and <B>C</B> (with subnet <TT>
<FONT COLOR="#0000ff">192.168.1.252/26</FONT></TT>),
then the same script would be just

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/ifconfig&nbsp;eth1&nbsp;192.168.1.252&nbsp;broadcast&nbsp;192.168.1.255&nbsp;netmask&nbsp;\</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.192</code><br>
</FONT></TD></TR></TABLE><P>
in which case all ``<TT>
<FONT COLOR="#0000ff">ppp0</FONT></TT>'' would change to ``<TT>
<FONT COLOR="#0000ff">eth1</FONT></TT>''
in the scripts that follow.

<P>
Routing on machine <B>B</B> is achieved with the following
script, provided the link is up. This script must be executed
whenever <TT>
<FONT COLOR="#0000ff">pppd</FONT></TT> has negotiated
the connection and can therefore be placed in the file <TT>
<FONT COLOR="#0000ff">/etc/pppd/ip-up</FONT></TT>,
which <TT>
<FONT COLOR="#0000ff">pppd</FONT></TT> executes automatically as soon as the <TT>
<FONT COLOR="#0000ff">ppp0</FONT></TT>
interface is available:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;del&nbsp;default</code><br>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;192.168.1.192&nbsp;netmask&nbsp;255.255.255.192&nbsp;dev&nbsp;ppp0</code><br>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;192.168.1.128&nbsp;netmask&nbsp;255.255.255.192&nbsp;gw&nbsp;192.168.1.253</code><br>
<code>/sbin/route&nbsp;add&nbsp;default&nbsp;gw&nbsp;192.168.1.1</code><br>
<code>&nbsp;</code><br>
<code>echo&nbsp;1&nbsp;&#062;&nbsp;/proc/sys/net/ipv4/ip_forward</code><br>
</FONT></TD></TR></TABLE><P>

<P>
Our full routing table and interface list for machine <B>B</B> then looks
like this <FONT COLOR="#ffa500">[RedHat 6 likes to add (redundant) explicit routes to each device.
These may not be necessary on your system]</FONT>:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>10</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>15</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>Kernel&nbsp;IP&nbsp;routing&nbsp;table</code><br>
<code>Destination&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gateway&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Genmask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flags&nbsp;Metric&nbsp;Ref&nbsp;&nbsp;&nbsp;&nbsp;Use&nbsp;Iface</code><br>
<code>192.168.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.255&nbsp;UH&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
<code>192.168.1.253&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.255&nbsp;UH&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;ppp0</code><br>
<code>192.168.1.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.192&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
<code>192.168.1.192&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.192&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;ppp0</code><br>
<code>192.168.1.128&nbsp;&nbsp;&nbsp;192.168.1.253&nbsp;&nbsp;&nbsp;255.255.255.192&nbsp;UG&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;ppp0</code><br>
<code>127.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;lo</code><br>
<code>0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UG&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
<code>&nbsp;</code><br>
<code>eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Ethernet&nbsp;&nbsp;HWaddr&nbsp;00:A0:24:75:3B:69&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:192.168.1.2&nbsp;&nbsp;Bcast:192.168.1.63&nbsp;&nbsp;Mask:255.255.255.192</code><br>
<code>lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Local&nbsp;Loopback&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:127.0.0.1&nbsp;&nbsp;Mask:255.0.0.0</code><br>
<code>ppp0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Point-to-Point&nbsp;Protocol&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:192.168.1.252&nbsp;&nbsp;P-t-P:192.168.1.253&nbsp;&nbsp;Mask:255.255.255.255</code><br>
</FONT></TD></TR></TABLE><P>

<P>
On machine <B>C</B> we can similarly run the script,

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>#!/bin/sh</code><br>
<code>while&nbsp;true&nbsp;&#059;&nbsp;do</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;pppd&nbsp;lock&nbsp;local&nbsp;mru&nbsp;296&nbsp;mtu&nbsp;296&nbsp;nodetach&nbsp;nocrtscts&nbsp;nocdtrcts&nbsp;\</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;192.168.1.253:192.168.1.252&nbsp;/dev/ttyS0&nbsp;115200&nbsp;noauth&nbsp;\</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;lcp-echo-interval&nbsp;1&nbsp;lcp-echo-failure&nbsp;2&nbsp;lcp-max-terminate&nbsp;1&nbsp;lcp-restart&nbsp;1</code><br>
<code>done</code><br>
</FONT></TD></TR></TABLE><P>
and then create routes with

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/route&nbsp;del&nbsp;default</code><br>
<code>/sbin/route&nbsp;add&nbsp;-net&nbsp;192.168.1.192&nbsp;netmask&nbsp;255.255.255.192&nbsp;dev&nbsp;ppp0</code><br>
<code>/sbin/route&nbsp;add&nbsp;default&nbsp;gw&nbsp;192.168.1.252</code><br>
<code>&nbsp;</code><br>
<code>echo&nbsp;1&nbsp;&#062;&nbsp;/proc/sys/net/ipv4/ip_forward</code><br>
</FONT></TD></TR></TABLE><P>

<P>
Our full routing table for machine <B>C</B> then looks like:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>10</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>15</code></font><code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>Kernel&nbsp;IP&nbsp;routing&nbsp;table</code><br>
<code>Destination&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gateway&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Genmask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flags&nbsp;Metric&nbsp;Ref&nbsp;&nbsp;&nbsp;&nbsp;Use&nbsp;Iface</code><br>
<code>192.168.1.129&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.255&nbsp;UH&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
<code>192.168.1.252&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.255&nbsp;UH&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;ppp0</code><br>
<code>192.168.1.192&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.192&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;ppp0</code><br>
<code>192.168.1.128&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.192&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
<code>127.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;lo</code><br>
<code>0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.1.252&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UG&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;ppp0</code><br>
<code>&nbsp;</code><br>
<code>eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Ethernet&nbsp;&nbsp;HWaddr&nbsp;00:A0:CC:D5:D8:A7&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:192.168.1.129&nbsp;&nbsp;Bcast:192.168.1.191&nbsp;&nbsp;Mask:255.255.255.192</code><br>
<code>lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Local&nbsp;Loopback&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:127.0.0.1&nbsp;&nbsp;Mask:255.0.0.0</code><br>
<code>ppp0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Link&nbsp;encap:Point-to-Point&nbsp;Protocol&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inet&nbsp;addr:192.168.1.253&nbsp;&nbsp;P-t-P:192.168.1.252&nbsp;&nbsp;Mask:255.255.255.255</code><br>
</FONT></TD></TR></TABLE><P>

<P>
Machine <B>D</B> can be configured like any ordinary machine on a LAN.
It just sets its default gateway to <TT>
<FONT COLOR="#0000ff">192.168.1.129</FONT></TT>. Machine <B>A</B>,
however, has to know to send packets destined for subnet <TT>
<FONT COLOR="#0000ff">192.168.1.128/26</FONT></TT>
<I>through</I> machine <B>B</B>. Its routing table has an extra entry
for the <TT>
<FONT COLOR="#0000ff">192.168.1.128/26</FONT></TT> LAN. The full routing table for machine
<B>A</B> is:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>Kernel&nbsp;IP&nbsp;routing&nbsp;table</code><br>
<code>Destination&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gateway&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Genmask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flags&nbsp;Metric&nbsp;Ref&nbsp;&nbsp;&nbsp;&nbsp;Use&nbsp;Iface</code><br>
<code>192.168.1.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.192&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
<code>192.168.1.128&nbsp;&nbsp;&nbsp;192.168.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.255.255.192&nbsp;UG&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
<code>127.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;lo</code><br>
<code>0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;192.168.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UG&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;eth0</code><br>
</FONT></TD></TR></TABLE><P>

<P>
To avoid having to add this extra route on machine <B>A</B>,
you can instead add the same route on machine <B>X</B>. This may
seem odd, but all that this means is that packets originating from <B>A</B> destined
for LAN 2 first <I>try</I> to go through <B>X</B> (since <B>A</B> has only one route),
and are then redirected <I>by</I> <B>X</B> to go through <B>B</B>.

<P>
The preceding configuration allowed machines to properly send
packets between machines <B>A</B> and <B>D</B> and out through the
Internet. One caveat: <TT>
<FONT COLOR="#0000ff">ping</FONT></TT> sometimes did not work even though
<TT>
<FONT COLOR="#0000ff">telnet</FONT></TT> did. This may be a peculiarity of the kernel version we were
using, &#42;&#42;<I>shrug</I>&#42;&#42;.

<P>

<H1><A NAME="SECTION002890000000000000000">
25.9 Interface Aliasing -- Many IPs on One Physical Card</A>
</H1>

<P>
<A NAME="ref:interfacealiasing"></A>
<P>
(The file <TT>
<FONT COLOR="#0000ff">/usr/src/linux/Documentation/networking/alias.txt</FONT></TT> contains
the kernel documentation on this.)

<P>
If you have one network card which you would like to double as several
different IP addresses, you can. Simply name
the interface <TT>
<FONT COLOR="#0000ff">eth0:</FONT></TT><I>n</I> where <I>n</I> is from <TT>
<FONT COLOR="#0000ff">0</FONT></TT>
to some large integer. You can use <TT>
<FONT COLOR="#0000ff">ifconfig</FONT></TT> as before as many
times as you like on the same network card--

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>/sbin/ifconfig&nbsp;eth0:0&nbsp;192.168.4.1&nbsp;broadcast&nbsp;192.168.4.255&nbsp;netmask&nbsp;255.255.255.0</code><br>
<code>/sbin/ifconfig&nbsp;eth0:1&nbsp;192.168.5.1&nbsp;broadcast&nbsp;192.168.5.255&nbsp;netmask&nbsp;255.255.255.0</code><br>
<code>/sbin/ifconfig&nbsp;eth0:2&nbsp;192.168.6.1&nbsp;broadcast&nbsp;192.168.6.255&nbsp;netmask&nbsp;255.255.255.0</code><br>
</FONT></TD></TR></TABLE><P>
--in <I>addition</I> to your regular <TT>
<FONT COLOR="#0000ff">eth0</FONT></TT> device. Here, the
same interface can communicate to three LANs having networks
<TT>
<FONT COLOR="#0000ff">192.168.4.0</FONT></TT>, <TT>
<FONT COLOR="#0000ff">192.168.5.0</FONT></TT>, and <TT>
<FONT COLOR="#0000ff">192.168.6.0</FONT></TT>. Don't forget
to add routes to these networks as above.

<P>

<H1><A NAME="SECTION0028100000000000000000">
25.10 Diagnostic Utilities</A>
</H1>

<P>
It is essential to know how to inspect and test your network
to resolve problems. The standard U<SMALL>NIX</SMALL> utilities are explained
here.

<P>

<H2><A NAME="SECTION0028101000000000000000">
25.10.1 <TT>
<FONT COLOR="#0000ff">ping</FONT></TT></A>
</H2>

<P>
<A NAME="sec:ping"></A>
<P>
The <TT>
<FONT COLOR="#0000ff">ping</FONT></TT> command is the most common network utility.
IP packets come in three types on the Internet, represented
in the <B>Type</B> field of the IP header: <I>UDP</I>,
<I>TCP</I>, and <I>ICMP</I>. (The first two, discussed
later, represent the two basic methods of communication
between two programs running on different machines.)
<I>ICMP</I> stands for <I>Internet Control Message Protocol</I>
and is a diagnostic packet that is responded to in a special way.
Try:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>ping&nbsp;metalab.unc.edu</code><br>
</FONT></TD></TR></TABLE><P>
or specify some other well-known host. You will get output
like:

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-1"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>PING&nbsp;metalab.unc.edu&nbsp;(152.19.254.81)&nbsp;from&nbsp;192.168.3.9&nbsp;:&nbsp;56(84)&nbsp;bytes&nbsp;of&nbsp;data.</code><br>
<code>64&nbsp;bytes&nbsp;from&nbsp;152.19.254.81:&nbsp;icmp_seq=0&nbsp;ttl=238&nbsp;time=1059.1&nbsp;ms</code><br>
<code>64&nbsp;bytes&nbsp;from&nbsp;152.19.254.81:&nbsp;icmp_seq=1&nbsp;ttl=238&nbsp;time=764.9&nbsp;ms</code><br>
<code>64&nbsp;bytes&nbsp;from&nbsp;152.19.254.81:&nbsp;icmp_seq=2&nbsp;ttl=238&nbsp;time=858.8&nbsp;ms</code><br>
<code>64&nbsp;bytes&nbsp;from&nbsp;152.19.254.81:&nbsp;icmp_seq=3&nbsp;ttl=238&nbsp;time=1179.9&nbsp;ms</code><br>
<code>64&nbsp;bytes&nbsp;from&nbsp;152.19.254.81:&nbsp;icmp_seq=4&nbsp;ttl=238&nbsp;time=986.6&nbsp;ms</code><br>
<code>64&nbsp;bytes&nbsp;from&nbsp;152.19.254.81:&nbsp;icmp_seq=5&nbsp;ttl=238&nbsp;time=1274.3&nbsp;ms</code><br>
<code>64&nbsp;bytes&nbsp;from&nbsp;152.19.254.81:&nbsp;icmp_seq=6&nbsp;ttl=238&nbsp;time=930.7&nbsp;ms</code><br>
</FONT></TD></TR></TABLE><P>
What is happening is that <TT>
<FONT COLOR="#0000ff">ping</FONT></TT> is sending ICMP packets
to <TT>
<FONT COLOR="#0000ff">metalab.unc.edu</FONT></TT>, which is automatically responding
with a return ICMP packet. Being able to <TT>
<FONT COLOR="#0000ff">ping</FONT></TT> a machine
is often the acid test of whether you have a correctly configured
and working network interface. Note that some sites explicitly filter
out ICMP packets, so, for example, <TT>
<FONT COLOR="#0000ff">ping cnn.com</FONT></TT> won't work.

<P>
<TT>
<FONT COLOR="#0000ff">ping</FONT></TT> sends a packet every second and measures
the time it takes to receive the return packet--like a
submarine sonar ``ping.'' Over the Internet, you can get times
in excess of 2 seconds if the place is remote enough. On a local
LAN this delay will drop to under a millisecond.

<P>
If <TT>
<FONT COLOR="#0000ff">ping</FONT></TT> does not even get to the line <TT>
<FONT COLOR="#0000ff">PING metalab.unc.edu</FONT></TT>...,
it means that <TT>
<FONT COLOR="#0000ff">ping</FONT></TT> cannot resolve the host name. You should then check that
your DNS is set up correctly--see Chapter <A HREF="node30.html#chap:dns">27</A>. If <TT>
<FONT COLOR="#0000ff">ping</FONT></TT>
gets to that line but no further, it means that the packets are not
getting there or are not getting back. In all other cases,
<TT>
<FONT COLOR="#0000ff">ping</FONT></TT> gives an error message reporting the absence of
either routes or interfaces.

<P>

<H2><A NAME="SECTION0028102000000000000000">
25.10.2 <TT>
<FONT COLOR="#0000ff">traceroute</FONT></TT></A>
</H2>

<P>
<TT>
<FONT COLOR="#0000ff">traceroute</FONT></TT> is a rather fascinating utility to identify
where a packet has been. It uses UDP packets or, with the <TT>
<FONT COLOR="#0000ff">-I</FONT></TT>
option, ICMP packets to detect the routing path. On my machine,

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>traceroute&nbsp;metalab.unc.edu</code><br>
</FONT></TD></TR></TABLE><P>
gives

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red size="-2">
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-3"><code>5</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-3"><code>10</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-3"><code>15</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<font size="-3"><code>20</code></font><code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue size="-2">
<code>traceroute&nbsp;to&nbsp;metalab.unc.edu&nbsp;(152.19.254.81),&nbsp;30&nbsp;hops&nbsp;max,&nbsp;38&nbsp;byte&nbsp;packets</code><br>
<code>&nbsp;1&nbsp;&nbsp;192.168.3.254&nbsp;(192.168.3.254)&nbsp;&nbsp;1.197&nbsp;ms&nbsp;&nbsp;1.085&nbsp;ms&nbsp;&nbsp;1.050&nbsp;ms</code><br>
<code>&nbsp;2&nbsp;&nbsp;192.168.254.5&nbsp;(192.168.254.5)&nbsp;&nbsp;45.165&nbsp;ms&nbsp;&nbsp;45.314&nbsp;ms&nbsp;&nbsp;45.164&nbsp;ms</code><br>
<code>&nbsp;3&nbsp;&nbsp;cranzgate&nbsp;(192.168.2.254)&nbsp;&nbsp;48.205&nbsp;ms&nbsp;&nbsp;48.170&nbsp;ms&nbsp;&nbsp;48.074&nbsp;ms</code><br>
<code>&nbsp;4&nbsp;&nbsp;cranzposix&nbsp;(160.124.182.254)&nbsp;&nbsp;46.117&nbsp;ms&nbsp;&nbsp;46.064&nbsp;ms&nbsp;&nbsp;45.999&nbsp;ms</code><br>
<code>&nbsp;5&nbsp;&nbsp;cismpjhb.posix.co.za&nbsp;(160.124.255.193)&nbsp;&nbsp;451.886&nbsp;ms&nbsp;&nbsp;71.549&nbsp;ms&nbsp;&nbsp;173.321&nbsp;ms</code><br>
<code>&nbsp;6&nbsp;&nbsp;cisap1.posix.co.za&nbsp;(160.124.112.1)&nbsp;&nbsp;274.834&nbsp;ms&nbsp;&nbsp;147.251&nbsp;ms&nbsp;&nbsp;400.654&nbsp;ms</code><br>
<code>&nbsp;7&nbsp;&nbsp;saix.posix.co.za&nbsp;(160.124.255.6)&nbsp;&nbsp;187.402&nbsp;ms&nbsp;&nbsp;325.030&nbsp;ms&nbsp;&nbsp;628.576&nbsp;ms</code><br>
<code>&nbsp;8&nbsp;&nbsp;ndf-core1.gt.saix.net&nbsp;(196.25.253.1)&nbsp;&nbsp;252.558&nbsp;ms&nbsp;&nbsp;186.256&nbsp;ms&nbsp;&nbsp;255.805&nbsp;ms</code><br>
<code>&nbsp;9&nbsp;&nbsp;ny-core.saix.net&nbsp;(196.25.0.238)&nbsp;&nbsp;497.273&nbsp;ms&nbsp;&nbsp;454.531&nbsp;ms&nbsp;&nbsp;639.795&nbsp;ms</code><br>
<code>10&nbsp;&nbsp;bordercore6-serial5-0-0-26.WestOrange.cw.net&nbsp;(166.48.144.105)&nbsp;&nbsp;595.755&nbsp;ms&nbsp;&nbsp;595.174&nbsp;ms&nbsp;*</code><br>
<code>11&nbsp;&nbsp;corerouter1.WestOrange.cw.net&nbsp;(204.70.9.138)&nbsp;&nbsp;490.845&nbsp;ms&nbsp;&nbsp;698.483&nbsp;ms&nbsp;&nbsp;1029.369&nbsp;ms</code><br>
<code>12&nbsp;&nbsp;core6.Washington.cw.net&nbsp;(204.70.4.113)&nbsp;&nbsp;580.971&nbsp;ms&nbsp;&nbsp;893.481&nbsp;ms&nbsp;&nbsp;730.608&nbsp;ms</code><br>
<code>13&nbsp;&nbsp;204.70.10.182&nbsp;(204.70.10.182)&nbsp;&nbsp;644.070&nbsp;ms&nbsp;&nbsp;726.363&nbsp;ms&nbsp;&nbsp;639.942&nbsp;ms</code><br>
<code>14&nbsp;&nbsp;mae-brdr-01.inet.qwest.net&nbsp;(205.171.4.201)&nbsp;&nbsp;767.783&nbsp;ms&nbsp;*&nbsp;*</code><br>
<code>15&nbsp;&nbsp;*&nbsp;*&nbsp;*</code><br>
<code>16&nbsp;&nbsp;*&nbsp;wdc-core-03.inet.qwest.net&nbsp;(205.171.24.69)&nbsp;&nbsp;779.546&nbsp;ms&nbsp;&nbsp;898.371&nbsp;ms</code><br>
<code>17&nbsp;&nbsp;atl-core-02.inet.qwest.net&nbsp;(205.171.5.243)&nbsp;&nbsp;894.553&nbsp;ms&nbsp;&nbsp;689.472&nbsp;ms&nbsp;*</code><br>
<code>18&nbsp;&nbsp;atl-edge-05.inet.qwest.net&nbsp;(205.171.21.54)&nbsp;&nbsp;735.810&nbsp;ms&nbsp;&nbsp;784.461&nbsp;ms&nbsp;&nbsp;789.592&nbsp;ms</code><br>
<code>19&nbsp;&nbsp;*&nbsp;*&nbsp;*</code><br>
<code>20&nbsp;&nbsp;*&nbsp;*&nbsp;unc-gw.ncren.net&nbsp;(128.109.190.2)&nbsp;&nbsp;889.257&nbsp;ms</code><br>
<code>21&nbsp;&nbsp;unc-gw.ncren.net&nbsp;(128.109.190.2)&nbsp;&nbsp;646.569&nbsp;ms&nbsp;&nbsp;780.000&nbsp;ms&nbsp;*</code><br>
<code>22&nbsp;&nbsp;*&nbsp;helios.oit.unc.edu&nbsp;(152.2.22.3)&nbsp;&nbsp;600.558&nbsp;ms&nbsp;&nbsp;839.135&nbsp;ms</code><br>
</FONT></TD></TR></TABLE><P>
You can see that there were twenty machines <FONT COLOR="#ffa500">[This is actually
a good argument for why ``enterprise''-level web servers have no use in
non-U.S. markets: there isn't even the network speed to load such servers,
thus making any kind of server speed comparisons superfluous.]</FONT> (or
<I>hops</I>) between mine and <TT>
<FONT COLOR="#0000ff">metalab.unc.edu</FONT></TT>.

<P>

<H2><A NAME="SECTION0028103000000000000000">
25.10.3 <TT>
<FONT COLOR="#0000ff">tcpdump</FONT></TT></A>
</H2>

<P>
<A NAME="sec:tcpdump"></A>
<P>
<TT>
<FONT COLOR="#0000ff">tcpdump</FONT></TT> watches a particular interface for <I>all</I>
the traffic that passes it--that is, all the traffic of all the
machines connected to the same hub (also called the <I>segment</I>
or <I>network segment</I>). A network card usually
grabs only the frames destined for it, but <TT>
<FONT COLOR="#0000ff">tcpdump</FONT></TT>
puts the card into <I>promiscuous</I> mode, meaning that the
card is to retrieve all frames regardless of their destination
hardware address. Try

<P><TABLE nowrap="1" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD valign="top" class="source" width="2%"><FONT color=red>
<code>&nbsp;</code><br>
</FONT></TD><TD valign="top" class="source" bgcolor="#FFE0C0"><FONT color=blue>
<code>tcpdump&nbsp;-n&nbsp;-N&nbsp;-f&nbsp;-i&nbsp;eth0</code><br>
</FONT></TD></TR></TABLE><P>
<TT>
<FONT COLOR="#0000ff">tcpdump</FONT></TT> is also discussed in
Section <A HREF="node44.html#sec:tcpdumpppp">41.5</A>. Deciphering the output of
<TT>
<FONT COLOR="#0000ff">tcpdump</FONT></TT> is left for now as an exercise for the reader. More
on the <I>tcp</I> part of <TT>
<FONT COLOR="#0000ff">tcpdump</FONT></TT> in Chapter <A HREF="node29.html#chap:tcpudp">26</A>.

<P>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2268"
  HREF="node29.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2264"
  HREF="rute.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2258"
  HREF="node27.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2266"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2269"
  HREF="node29.html">26. TCP and UDP</A>
<B> Up:</B> <A NAME="tex2html2265"
  HREF="rute.html">rute</A>
<B> Previous:</B> <A NAME="tex2html2259"
  HREF="node27.html">24. Source and Binary</A>
 &nbsp <B>  <A NAME="tex2html2267"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->

</BODY>
</HTML>
