<!-- COPYRIGHT (c) 2001 Gangstuck -->
<!--     Subkulture Crew 2k1      -->

<HTML>
<HEAD>
<TITLE>[ Les fichiers htaccess, htpasswd et htgroup ] - GangstucK for Subkulture</TITLE>
<style type='text/css'>
 A { text-decoration:none; color:blue; }
 A:active  { text-decoration:none; color:#432FB1; }
 A:hover { text-decoration:underline; color:blue; }
 .hautableau { font-family: Verdana; font-size: 9pt; font-style: normal; font-weight: bold; color: #ffffff; text-decoration: none }
</style>
</HEAD>
<BODY BGCOLOR='white' topmargin='5' leftmargin='0' marginheight='0' marginwidth='0' text='#000000' link='#000099' alink='#0000ff' vlink='#000099'>
<DIV STYLE="text-align:justify;">

<font face="verdana" size="2"><BR>

<center><U><B><a name="top"></a>Les fichiers htaccess, htpasswd et htgroup</B></U></center><BR><BR><BR>


&nbsp; [0x01] <B><U>Présentation</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>


<center>
<table width="100%" CELLSPACING=0 CELLPADDING=0 COLS=2>
<tr>
<td width="50%">

<table width="100%">
<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">Auteur</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000">GangstucK</font>
</td>
</tr>

<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">Date début</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000">28/08/2001</font>
</td>
</tr>
<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">System</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000">Tout systèmes</font>
</td>
</tr>
<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">For</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000">Subkulture 2001</font>
</td>
</tr>
</table>

<td VALIGN=TOP width="50%">

<table width="100%">
<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">Mail</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000"><a href="mailto:k0deback@yahoo.fr">k0deback@yahoo.fr</a></font>
</td>
</tr>
<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">Date fin</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000">03/09/2001</font>
</td>
</tr>
<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">Type</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000">Introduction</font>
</td>
</tr>
<tr>
<td width="20%" bgcolor="#EEEEEE">
&nbsp;<font face="verdana" size="2" color="#000000">Version</font>
</td>
<td width="5%">
<font face="verdana" size="2" color="#000000">:</font>
</td>
<td width="50%">
<font face="verdana" size="2" color="#000000">1.0</font>
</td>
</tr>
</table>

</td></tr>
</table>

</center>

<BR>

<table width="99%">
<tr>
<td bgcolor="#F5F5F5">
<font face="verdana" size="2" color="#000000">
&nbsp;How to use .htaccess, .htpasswd and .htgroup files.
</font>
</td>
</tr>
</table>

<BR><BR>

Comprendre le fonctionnement des fichiers .htaccess, .htpasswd et .htgroup est trés important lors de 
l'administration d'un serveur web.. Lorsque l'on héberge un contenu (quel qu'il soit..), restreindre son 
accés par un quelconque moyen est trés important...<BR><BR>


<U>Sommaire</U> :
<ul>
&nbsp;&nbsp;&nbsp; [<a href="#0x02">0x02</a>]&nbsp; <font color="#0C0467">Introduction</font><br>
&nbsp;&nbsp;&nbsp; [<a href="#0x03">0x03</a>]&nbsp; <font color="#0C0467">Authentification </font><br>
&nbsp;&nbsp;&nbsp; [<a href="#0x04">0x04</a>]&nbsp; <font color="#0C0467">Le fichier .htpasswd</font><br>
&nbsp;&nbsp;&nbsp; [<a href="#0x05">0x05</a>]&nbsp; <font color="#0C0467">Le fichier .htgroup</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#51">5.1</a>]&nbsp; <font color="#05022D">Structure du fichier</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#52">5.2</a>]&nbsp; <font color="#05022D">Création du fichier</font><br>
&nbsp;&nbsp;&nbsp; [<a href="#0x06">0x06</a>]&nbsp; <font color="#0C0467">Le fichier .htaccess</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#61">6.1</a>]&nbsp; <font color="#05022D">Structure du fichier</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#62">6.2</a>]&nbsp; <font color="#05022D">Authentification par mot de passe</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#63">6.3</a>]&nbsp; <font color="#05022D">Authentification par nom d'utilisateur</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#64">6.4</a>]&nbsp; <font color="#05022D">Authentification par domaine Internet</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#65">6.5</a>]&nbsp; <font color="#05022D">Authentification par domaine Internet et .htpasswd/.htgroup</font><br>
&nbsp;&nbsp;&nbsp; [<a href="#0x07">0x07</a>]&nbsp; <font color="#0C0467">Divers</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#71">7.1</a>]&nbsp; <font color="#05022D">Introduction</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#72">7.2</a>]&nbsp; <font color="#05022D">Messages d'erreurs personnalisés</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#73">7.3</a>]&nbsp; <font color="#05022D">Page d'index personnalisable</font><br>
&nbsp;&nbsp;&nbsp; [<a href="#0x08">0x08</a>]&nbsp; <font color="#0C0467">Références</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#80">8.1</a>]&nbsp; <font color="#05022D">Pages de manuels</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<a href="#81">8.2</a>]&nbsp; <font color="#05022D">Documents</font><br>
&nbsp;&nbsp;&nbsp; [<a href="#0x09">0x09</a>]&nbsp; <font color="#0C0467">Remerciements et conclusion</font><br>
</ul>

<td width='10'><br></td></tr></table>
</td></tr></table>
</td></tr></table>
</center>



<BR><BR><BR>



<a name="0x02">&nbsp;</a> [0x02] <B><U>Introduction</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

Dans la plupart des cas, les ressources que propose les serveurs web sont consultables depuis Internet 
par tout le monde. Dans notre cas, nous voulons offrir un ensemble de services accessible 
uniquement à des personnes ciblées possédant un login (nom d'utilisateur) et un password (mot de passe).<BR><BR>

J'entends par 'services' l'accés aux fichiers composants le répertoire...<BR><BR>

Pour ce faire, nous alons utiliser les fichiers .htaccess. Leurs utilisations, trés diverses, peuvent 
régir les répertoires/sous répertoires, les fichiers... Dans la plupart des cas, nous pouvons voir :

<ul>
<li>Accés autorisé aux utilisateurs via saisie d'un Login et d'un Password. <BR>Base de données 
"nom_utilisateur/mot_de_passe" contenu dans un fichier .htpasswd. Le fichier "/etc/passwd" est un 
fichier système régissant les utilisateurs systèmes.. il n'a donc aucun rapport avec les fichiers 
".htpassword" renfermant toutes personnes pouvant accéder aux ressources protégées du serveur web.<BR><BR>
<li>Accés autorisé/refusé aux utilisateurs d'un domaine internet spécifique...<BR><BR>
<li>Accés autorisé aux utilisateurs d'un même domaine internet spécifique aprés authentification (login/pass).<BR><BR>
<li>Définition de pages d'erreurs (404, 403...) personnalisées. 
</ul> 

</DIV>
<td width='10'><br></td></tr></table>
</td></tr></table>
</td></tr></table>
</center>



<BR><BR><BR>



<a name="0x03">&nbsp;</a> [0x03] <B><U>Authentification </U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

Lorsque le serveur détecte la présence d'un fichier ".htaccess" dans un répertoire, il va l'analyser 
(grace à sa syntaxe) et appliquer ensuite le type de protection à mettre en oeuvre dans le répertoire.<BR><BR>

Du fait de sa diversité au niveau des différents types de protections, le système de fichiers 
".htaccess" est trés puissant.. <BR><BR>

</DIV>
<td width='10'><br></td></tr></table>
</td></tr></table>
</td></tr></table>
</center>



<BR><BR><BR>



<a name="0x04">&nbsp;</a> [0x04] <B><U>Le fichier .htpasswd</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

Nous avons vu précedemment que les fichiers ".htaccess" puisés directement dans une base d'utilisateurs 
appellé couramment ".htpasswd" comportant une série de "login/pass". Chaque entrée du fichier se verra 
délivrer un accés aux données du répertoire (aprés authentification)...<BR><BR>

Tous serveurs de types NCSA offrent un utilitaire nommé "htpasswd" permettant de créer et ainsi de gérer 
les fichiers type ".htpasswd".<BR><BR>

Nous allons maintenant voir l'utilisation du programme "htpasswd" :<BR><BR>
<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>

 [root@subkulture bin]$ <B>htpasswd</B>

  Usage:
          htpasswd [-cmdps] passwordfile username
          htpasswd -b[cmdps] passwordfile username password

   -c  Create a new file.
   -m  Force MD5 encryption of the password (default).
   -d  Force CRYPT encryption of the password.
   -p  Do not encrypt the password (plaintext).
   -s  Force SHA encryption of the password.
   -b  Use the password from the command line rather than prompting for it.
 
  On Windows and TPF systems the '-m' flag is used by default.
  On all other systems, the '-p' flag will probably not work.
  
 [root@subkulture bin]$
</font></pre>
</td>
</td>
</table>
</center>

<BR>

Ensuite, nous créons un répertoire (repass) qui va héberger le(s) fichier(s) ".htpasswd". On lui donnera 
les droits d'accés qui lui sont du (lecture / éxecution) : <BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>

 [root@subkulture bin]$ <B>mkdir repass</B>
 [root@subkulture bin]$ <B>chmod o+rx repass</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>


Le répertoire est crée, il nous manque maintenant le fichier ".htpasswd" :<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>

 [root@subkulture bin]# <B>./htpasswd -c repass/.htaccess gang</B>
 
 New password:
 Re-type new password:
 Adding password for user gang
 
 [root@subkulture bin]$
</font></pre>
</td>
</td>
</table>
</center>

<BR>

On a affiché le fichier ".htpasswd" et il contient bien l'utilisateur GangstucK ainsi que son mot de 
pass crypté.<BR><BR>

Nous allons ajouter un utilisateur (Martony) au fichier ceci à l'aide de "htpasswd" : <BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>

 [root@subkulture bin]# <B>./htpasswd repass/.htpasswd Martony</B>
 
 New password: 
 Re-type new password: 
 Adding password for user Martony
 
 [root@subkulture repass]# <B>cat .htaccess</B>
 
 gang:.4hPKMT39vA
 Martony:p9uvwlyUDbq
 
 [root@subkulture repass]#
</font></pre>
</td>
</td>
</table>
</center>

<BR>

Pour modifier le mot de passe d'un utilisateur, il suffit de recommencer l'étape précedente :<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>

 [root@subkulture bin]$ <B>htpasswd repass/.htpasswd Martony</B>
 
 New password: 
 Re-type new password: 
 Adding password for user Martony
 
 [root@subkulture bin]$
</font></pre>
</td>
</td>
</table>
</center>

<BR>

Pour supprimer un utilisateur présent dans le fichier, il suffit de retirer la ligne correspondant à l'utilisateur...<BR><BR><BR>

Voyons maintenant comment mettre en oeuvre le fichier ".htaccess" (ensemble de rêgles de protection)... car la nous avons uniquement notre base utilisateur...

<BR><BR><BR>

</DIV>
<td width='10'><br></td></tr></table>
</td></tr></table>
</td></tr></table>
</center>



<BR><BR><BR>



<a name="0x05">&nbsp;</a> [0x05] <B><U>Le fichier .htgroup</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

Il est possible de spécifier des groupes d'utilisateurs (comme sous les systèmes de types *nix). <BR><BR>

Il permettra d'indiquer pour chaque groupe, chaque utilisateur qui le compose.<BR><BR>

<a name="51"></a>- <U>Structure du fichier</U> :<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
  groupe1:nom1 
  groupe2:nom1 nom2
  groupe3:nom1 nom2 nom3</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

Nous allons créer un fichier .htgroup comprenant 2 groupes à savoir :
<ul>
<li> Administrateurs
<li> Utilisateurs
</ul>

<a name="52"></a>- <U>Création du fichier</U> :<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
  administrateurs:gang marty
  utilisateurs:nick1 nick2 nick3 nick4</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

</DIV>
<td width='10'><br></td></tr></table>
</td></tr></table>
</td></tr></table>
</center>



<BR><BR><BR>



<a name="0x06">&nbsp;</a> [0x06] <B><U>Le fichier .htaccess</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

Le fichier ".htaccess" est le fichier qui va contenir les "régles de protection" à mettre en oeuvre. <BR><BR>
Il est crée simplement, à l'aide d'un éditeur de texte. Il est placé ensuite dans le répertoire à "protéger".<BR><BR><BR>


<a name="61"></a><U><B>Structure du fichier</B></U> :<BR><BR>

<ul>
<li> <FONT COLOR="#333399"><B>AuthUserFile</B> chemin_du_fichier</FONT> <BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htpasswd". <br>
<li> <FONT COLOR="#333399"><B>AuthGroupFile</B> chemin_du_fichier</FONT> <BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htgroup"<br>
<li> <FONT COLOR="#333399"><B>AuthName</B> "message"</FONT> <BR>spécifie le texte à afficher dans la boite de dialogue d'authentification...<br>
<li> <FONT COLOR="#333399"><B>AuthType</B> type</FONT><BR> type d'authentification à mettre en oeuvre.<br>

</ul>
<BR>



<a name="62"></a><U><B>Authentification par mot de passe</B></U> :<BR><BR>

Méthode permettant une identification de type "login/password". L'utilisateur donne son nom et ensuite 
le mot de passe qui lui correspond. Le serveur procéde alors à une vérification depuis le fichier 
".htpasswd". L'accés est ensuite autorisé ou, au cas échéant, refusé...<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
 AuthUserFile /usr/local/bin/www/repass/.htpasswd
 AuthGroupFile /dev/null
 AuthName "Bienvenue"
 AuthType Basic

 &lt;limit GET>
 require valid-user
 &lt;/Limit></B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

- <U>Structure</U> :

<ul>
<li> <FONT COLOR="#333399"><B>AuthUserFile</B> /usr/local/bin/www/repass/.htpasswd</FONT> :<BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htpasswd". <br>
<li> <FONT COLOR="#333399"><B>AuthGroupFile</B> /dev/null</FONT> :<BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htgroup" (/dev/null).<br>
<li> <FONT COLOR="#333399"><B>AuthName</B> "Bienvenue"</FONT> :<BR> spécifie le texte à afficher dans la boite de dialogue d'authentification...<br>
<li> <FONT COLOR="#333399"><B>AuthType</B> basic</FONT> :<BR> type d'authentification à utiliser.<br><BR>

<li> <FONT COLOR="#333399"><B>&lt;Limit</B> GET<b>></b></FONT> :<BR> bloc contenant des directives concernant les différentes méthodes d'accés (ici GET).<br>
<li> <FONT COLOR="#333399"><B>require</B> valid-user</FONT> :<BR> permet l'accés à tous utilisateurs possédant une entrée dans "AuthUserFile".<br>
<li> <FONT COLOR="#333399"><B>&lt;/Limit></B></FONT> :<BR> fermeture du bloc Limit (similaire au HTML...).<br>
</ul>


Dans notre exemple seul les utilisateurs "Gangstuck et Martony" pourront accéder aux données...<BR><BR><BR>


<a name="63"></a><U><B>Authentification par nom d'utilisateur</B></U> :<BR><BR>

Cette méthode permet de s'identifier uniquement grace à un nom d'utilisateur valide (sans mot de passe). 
Biensur, cette authentification est trés dangereuse du fait de sa simplicitée...<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
 AuthUserFile /usr/local/bin/www/repass/.htpasswd
 AuthGroupFile /usr/local/bin/www/repass/.htgroup
 AuthName "identification utilisateur"
 AuthType Basic

 &lt;limit GET>
 require user medgi rox lionel ohm ad
 &lt;/Limit></B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

- <U>Structure</U> :

<ul>
<li> <FONT COLOR="#333399"><B>AuthUserFile</B> /usr/local/bin/www/repass/.htpasswd</FONT> :<BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htpasswd". <br>
<li> <FONT COLOR="#333399"><B>AuthGroupFile</B> /usr/local/bin/www/repass/.htgroup</FONT> :<BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htgroup" (authentification de type group).<br>
<li> <FONT COLOR="#333399"><B>AuthName</B> "identification utilisateur"</FONT> :<BR> spécifie le texte à afficher dans la boite de dialogue d'authentification...<br>
<li> <FONT COLOR="#333399"><B>AuthType</B> basic</FONT> :<BR> type d'authentification à utiliser.<br><BR>

<li> <FONT COLOR="#333399"><B>&lt;Limit</B> GET<b>></b></FONT> :<BR> bloc contenant des directives concernant les différentes méthodes d'accés (ici GET).<br>
<li> <FONT COLOR="#333399"><B>require user</B> medgi rox lionel ohm ad</FONT> :<BR> permet l'accés aux utilisateurs "medgi, rox, lionel, ohm et ad" d'accéder au répertoire. Chaque utilisateur ne spécifiera aucun mot de passe.. uniquement son nom d'utilisateur (contenu dans la liste).<br>
<li> <FONT COLOR="#333399"><B>&lt;/Limit></B></FONT> :<BR> fermeture du bloc Limit (similaire au HTML...).<br>
</ul>
<BR>

<a name="64"></a><U><B>Authentification par domaine Internet</B></U> :<BR><BR>

Cette méthode va nous permettre d'autoriser ou de refuser l'accés aux pages HTML à toutes personnes 
venant d'un même domaine. Dans notre cas, on accepte toutes personnes venant des domaines "univ.fr" et 
"univ.mc", les autres requêtes sont rejetées... <BR><BR>

Ici, on aura uniquement besoin d'un fichier .htaccess 
pour effectuer ce type de protection... nous verrons par la suite comment doubler cette authentification 
avec, en plus, une identification par mot de passe... <BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
 
 AuthUserFile /dev/null
 AuthGroupFile /dev/null
 AuthName "identification Internet"
 AuthType Basic
 
 &lt;limit GET>
  order deny,allow
  deny from all
  allow from univ.fr
  allow from univ.mc
 &lt;/Limit>
</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

- <U>Structure</U> :

<ul>
<li> <FONT COLOR="#333399"><B>AuthUserFile</B> /dev/null</FONT> :<BR> Dans ce cas "/dev/null" car l'authentification ne se base pas sur le fichier .htpasswd.<br>
<li> <FONT COLOR="#333399"><B>AuthGroupFile</B> /dev/null</FONT> :<BR>  Dans ce cas "/dev/null" car l'authentification ne se base pas sur le fichier .htgroup.<br>
<li> <FONT COLOR="#333399"><B>AuthName</B> "identification Internet"</FONT> :<BR> spécifie le texte à afficher dans la boite de dialogue d'authentification...<br>
<li> <FONT COLOR="#333399"><B>AuthType</B> basic</FONT> :<BR> type d'authentification à utiliser.<br><BR>

<li> <FONT COLOR="#333399"><B>&lt;Limit</B> GET<b>></b></FONT> :<BR> bloc contenant des directives concernant les différentes méthodes d'accés (ici GET).<br>
<li> <FONT COLOR="#333399"><B>order</B> deny,allow</FONT> :<BR> déclaration de l'ordre des régles à savoir : deny (refuse) puis allow (autorise).<br>
<li> <FONT COLOR="#333399"><B>deny</B> from all</FONT> :<BR> Directive indiquant le refus d'accés concernant toutes requetes.<br>
<li> <FONT COLOR="#333399"><B>allow</B> from univ.fr / univ.mc</FONT> :<BR> Directive indiquant l'autorisation d'accés des domaines "univ.fr" et "univ.mc".<br>
<li> <FONT COLOR="#333399"><B>&lt;/Limit></B></FONT> :<BR> fermeture du bloc Limit (similaire au HTML...).<br>
</ul>

<hr><BR>

Nous allons maintenant voir comment refuser l'accés à un domaine internet en particulier :<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
 
 AuthUserFile /dev/null
 AuthGroupFile /dev/null
 AuthName "identification Internet"
 AuthType Basic
 
 &lt;limit GET>
  order allow,deny
  allow from all
  deny from pasbo.fr
 &lt;/Limit>
</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

- <U>Structure</U> :

<ul>
<li> <FONT COLOR="#333399"><B>AuthUserFile</B> /dev/null</FONT> :<BR> Dans ce cas "/dev/null" car l'authentification ne se base pas sur le fichier .htpasswd.<br>
<li> <FONT COLOR="#333399"><B>AuthGroupFile</B> /dev/null</FONT> :<BR>  Dans ce cas "/dev/null" car l'authentification ne se base pas sur le fichier .htgroup.<br>
<li> <FONT COLOR="#333399"><B>AuthName</B> "identification Internet"</FONT> :<BR> spécifie le texte à afficher dans la boite de dialogue d'authentification...<br>
<li> <FONT COLOR="#333399"><B>AuthType</B> basic</FONT> :<BR> type d'authentification à utiliser.<br><BR>

<li> <FONT COLOR="#333399"><B>&lt;Limit</B> GET<b>></b></FONT> :<BR> bloc contenant des directives concernant les différentes méthodes d'accés (ici GET).<br>
<li> <FONT COLOR="#333399"><B>order</B> allow,deny</FONT> :<BR> déclaration de l'ordre des régles à savoir : allow (autorise) puis deny (refuse).<br>
<li> <FONT COLOR="#333399"><B>allow</B> from all</FONT> :<BR> Directive indiquant l'autorisation d'accés à tout le monde.<br>
<li> <FONT COLOR="#333399"><B>deny</B> from pasbo.fr</FONT> :<BR> Directive indiquant le refus d'accés au domaine "pasbo.fr".<br>
<li> <FONT COLOR="#333399"><B>&lt;/Limit></B></FONT> :<BR> fermeture du bloc Limit (similaire au HTML...).<br>
</ul>

<BR>







<a name="65"></a><U><B>Authentification par domaine Internet et .htpasswd/.htgroup</B></U> :<BR><BR>

Cette méthode va nous permettre d'authentifier une connection par domaine mais également par 
mot de passe. <BR><BR>

Ici, on mettra en oeuvre un fichier .htaccess ainsi qu'un fichier .htpasswd. Nous verrons par 
la suite comment varier cette authentification avec par exemple, la présence d'un fichier type .htgroup.<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
 
 AuthUserFile /usr/local/bin/www/repass/.htpasswd
 AuthGroupFile /dev/null
 AuthName "identification Internet et utilisateur"
 AuthType Basic
 
 &lt;limit GET>
  order deny,allow
  deny from all
  allow from univ.fr 
  require valid-user
  satisfy any
 &lt;/Limit>
</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

- <U>Structure</U> :

<ul>
<li> <FONT COLOR="#333399"><B>AuthUserFile</B> /usr/local/bin/www/repass/.htpasswd</FONT> :<BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htpasswd". <br>
<li> <FONT COLOR="#333399"><B>AuthGroupFile</B> /dev/null</FONT> :<BR>  Dans ce cas "/dev/null" car l'authentification ne se base pas sur le fichier .htgroup.<br>
<li> <FONT COLOR="#333399"><B>AuthName</B> "identification Internet et password"</FONT> :<BR> spécifie le texte à afficher dans la boite de dialogue d'authentification...<br>
<li> <FONT COLOR="#333399"><B>AuthType</B> basic</FONT> :<BR> type d'authentification à utiliser.<br><BR>

<li> <FONT COLOR="#333399"><B>&lt;Limit</B> GET<b>></b></FONT> :<BR> bloc contenant des directives concernant les différentes méthodes d'accés (ici GET).<br>
<li> <FONT COLOR="#333399"><B>order</B> deny,allow</FONT> :<BR> déclaration de l'ordre des régles à savoir : deny (refuse) puis allow (autorise).<br>
<li> <FONT COLOR="#333399"><B>deny</B> from all</FONT> :<BR> Directive indiquant le refus d'accés concernant toutes requetes.<br>
<li> <FONT COLOR="#333399"><B>allow</B> from univ.fr</FONT> :<BR> Directive indiquant l'autorisation d'accés au domaine "univ.fr".<br>
<li> <FONT COLOR="#333399"><B>require</B> valid-user</FONT> :<BR> permet l'accés à tous utilisateurs possédant une entrée dans "AuthUserFile".<br>
<li> <FONT COLOR="#333399"><B>satisfy</B> any</FONT> :<BR> permet de définir l'accés selon le respect d'une des deux conditions (sous-domaine ou password). L'utilisateur qui n'appartient pas au sous-domaine univ.fr pourra, s'il posséde un accés dans le fichier .htpasswd, accéder aux données.. Quand aux personnes d'univ.fr, ils accéderont aux données normalement.<br>
<li> <FONT COLOR="#333399"><B>&lt;/Limit></B></FONT> :<BR> fermeture du bloc Limit (similaire au HTML...).<br>
</ul>

<hr>
<BR>

Ici nous allons mettre en oeuvre deux authentifications différentes à savoir authentification par 
sous-domaine et par groupe. Les deux conditions doivent être respéctée :<BR><BR>

<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
 
 AuthUserFile /usr/local/bin/www/repass/.htpasswd
 AuthGroupFile /usr/local/bin/www/repass/.htgroup
 AuthName "identification Internet et group"
 AuthType Basic
 
 &lt;limit GET>
  order deny,allow
  deny from all
  allow from univ.fr 
  require group intranet
  satisfy all
 &lt;/Limit>
</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

- <U>Structure</U> :

<ul>
<li> <FONT COLOR="#333399"><B>AuthUserFile</B> /usr/local/bin/www/repass/.htpasswd</FONT> :<BR> spécifie le chemin d'accés (depuis la racine) au fichier ".htpasswd". <br>
<li> <FONT COLOR="#333399"><B>AuthGroupFile</B> /usr/local/bin/www/repass/.htgroup </FONT> :<BR>  spécifie le chemin d'accés (depuis la racine) au fichier ".htgroup" (authentification de type group).<br>
<li> <FONT COLOR="#333399"><B>AuthName</B> "identification Internet"</FONT> :<BR> spécifie le texte à afficher dans la boite de dialogue d'authentification...<br>
<li> <FONT COLOR="#333399"><B>AuthType</B> basic</FONT> :<BR> type d'authentification à utiliser.<br><BR>

<li> <FONT COLOR="#333399"><B>&lt;Limit</B> GET<b>></b></FONT> :<BR> bloc contenant des directives concernant les différentes méthodes d'accés (ici GET).<br>
<li> <FONT COLOR="#333399"><B>order</B> deny,allow</FONT> :<BR> déclaration de l'ordre des régles à savoir : deny (refuse) puis allow (autorise).<br>
<li> <FONT COLOR="#333399"><B>deny</B> from all</FONT> :<BR> Directive indiquant le refus d'accés concernant toutes requetes.<br>
<li> <FONT COLOR="#333399"><B>allow</B> from univ.fr</FONT> :<BR> Directive indiquant l'autorisation d'accés au domaine "univ.fr".<br>
<li> <FONT COLOR="#333399"><B>require</B> group administrateurs</FONT> :<BR> permet l'accés à tous utilisateurs possédant une entrée dans "AuthUserFile" et faisant partie du groupe "administrateurs" (gang, marty).<br>
<li> <FONT COLOR="#333399"><B>satisfy</B> all</FONT> :<BR> les deux contraintes doivent être respéctée à savoir : toutes personnes devra être connectée depuis le sous-domaine "univ.fr" et faire partie du groupe "administrateurs" contenu dans le fichier ".htgroup" (voir plus haut). Uniquement dans les deux cas suivant l'utilisateur se verra délivrer un accés aux ressources... <br>
<li> <FONT COLOR="#333399"><B>&lt;/Limit></B></FONT> :<BR> fermeture du bloc Limit (similaire au HTML...).<br>
</ul>

</DIV>
<td width='10'><br></td></tr></table>
</td></tr></table>
</td></tr></table>
</center>



<BR><BR><BR>



<a name="0x07">&nbsp;</a> [0x07] <B><U>Divers</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

<a name="71"></a><B><U>Introduction</U></B><BR><BR>

Tout les exemples ci dessous peuvent prendre place directement dans le fichier de configuration d'Apache, 
httpd.conf, situé dans votre répertoire de configuration /conf... C'est la solution que je préfére, mais 
il est vrai que si vous disposez uniquement d'un simple accés utilisateur sur un serveur web acceptant 
l'usage des fichiers .htaccess, dans ce ca, l'utililté se fait ressentir...<BR><BR><BR>


<a name="72"></a><B><U>Messages d'erreurs personnalisés</U></B><BR><BR>

Nous allons utiliser les fichiers .htaccess afin de personnaliser les messages d'erreurs.<BR><BR>

Dans mon cas, je crée un répertoire qui va accueillir toutes les pages d'erreurs : <FONT COLOR="#0A0D6B">/error</FONT>.<BR><BR>

<U>Syntaxe</U> :
<ul>
<FONT COLOR="#203252">ErrorDocument</FONT> <FONT COLOR="#324D80">code-réponse</FONT> <FONT COLOR="#1B0A7B">(chemin du fichier, texte ou url)</FONT>
</ul>


<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
  
  # 40x : requête incorrecte.
    ErrorDocument 401 /error/401.php
    ErrorDocument 403 /error/403.php
    ErrorDocument 404 /error/404.php
  # 50x : erreur interne du serveur.
    ErrorDocument 500 /error/500.php
</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

C'est quand même plus propre de balancer tout ça dans httpd.conf... enfin bon.<BR><BR><BR>



<a name="73"></a><B><U>Page d'index personnalisable</U></B><BR><BR>

Vous savez tout comme moi que le fichier index est un fichier qui est affiché par défaut, lorsque un 
utilisateur ne précise pas de nom de fichiers dans sa requête (http://www.mondomaine.com/ va en fait 
pointé sur http://www.mondomaine.com/index.html). Ceci est invisible aux yeux de l'utilisateur, mais 
est en réalité d'une importance capitale pour des raisons de confidentialité... Par défault nous rencontrons 
les fichiers index.html et index.htm.<BR><BR>

<U>Syntaxe</U> :
<ul>
<FONT COLOR="#203252">DirectoryIndex</FONT> <FONT COLOR="#324D80"> index1, index2, index3, ...</FONT>
</ul>


<center>   
<table width="95%" bgcolor="#3333CC">
<tr>
<td width="93%">
<font color="#ffffff"><pre>
<B>
  
  # Indexs
  DirectoryIndex index.php index.php3 index.html index.htm /error/403.php3
</B>
</font></pre>
</td>
</td>
</table>
</center>

<BR>

Le serveur va tout d'abord rechercher la présence d'un des fichiers index.php, index.php3, index.html et 
index.htm. Si aucun de ces fichiers existent, la page 403.php3 (page d'erreur 404) s'affichera, évitant 
ainsi le listage du répertoire...<BR><BR><BR>

</DIV>
<td width='10'><br></td></tr></table>
</td></tr></table>
</td></tr></table>
</center>



<BR><BR><BR>



<a name="0x08">&nbsp;</a> [0x08] <B><U>Références</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

Je ne sais pas... peut-être :

<ul>
- <a href="http://www.google.com" target="blank">http://www.google.com</a>
</ul>

</DIV>
<br>
</font>
</td>
<td width='10'><br></td>
</tr>
</table>
</td>
</tr>
</table>
</center>


<br><BR><BR>



<a name="0x09">&nbsp;</a> [0x09] <B><U>Remerciements et conclusion</U></B> :<BR><BR>

<center>
<table width='96%' border='0' cellspacing='0' cellpadding='1' bgcolor='black'>
<tr>
<td>
<table width='100%' border='0' cellspacing='0' cellpadding='1' bgcolor='#ffffff'>
<tr>
<td width='10'><br></td>
<td>
<DIV STYLE="text-align:justify;">
<font face="verdana" size="2" color="#000000">
<br>

<U>Remerciements</U>
<ul>
- All the Subkulture team..<BR>
- NoRoute, Noway, Cryptel, HVU, TS63...<BR>
- Secu-fr, Phreakon, Frstylez, Tipiak, MVM, KoM, Organiks...<BR><BR>

- Psirac, phreaking party tour rulez (toulouse 2000).<BR>
- Lionel et Descript, coding/fumette party tour rulez (toulouse 2001).<BR>
- Medgi et Martony, phreaking/coding party tour rulez (strasbourg 2001).<BR><BR>

Un petit merci à Marijeanne (quand même...).<BR>
</ul>

<br>

<u>Conclusion</u><BR><BR>

En ésperant que cet article (si je puis dire) aura éclairé votre lanterne... dans tout les cas moi je 
pars me rouler un oinj... Une petite dédicace à descript et à lionel :) <BR><BR>

Questions/critiques/bonjour :  <a href="mailto:k0deback@yahoo.fr">k0deback@yahoo.fr</a>.<BR><BR><BR>


================================================================================<BR>
&nbsp;- J'ai plus d'temps à perdre pleurer sur mon sort en clair j'ai bouffé l'tonnerre ma bouche recrache l'éclair -<BR>
================================================================================<BR>

</DIV>
<br>
</font>
</td>
<td width='10'><br></td>
</tr>
</table>
</td>
</tr>
</table>

<BR><BR><BR>



<DIV ALIGN="center">- <a href="#top">top</a> -</DIV>


</BODY>
</HTML>
