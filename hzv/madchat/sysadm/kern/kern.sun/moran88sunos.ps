%!PS-Adobe-1.0
%%Creator: opus:gingell (Rob &)
%%Title: stdin (ditroff)
%%CreationDate: Wed Nov  9 08:19:29 1988
%%EndComments
% lib/psdit.pro -- prolog for psdit (ditroff) files
% Copyright (c) 1984, 1985 Adobe Systems Incorporated. All Rights Reserved.
% last edit: shore Sat Nov 23 20:28:03 1985
% RCSID: $Header: psdit.pro,v 2.1 85/11/24 12:19:43 shore Rel $

/$DITroff 140 dict def $DITroff begin
/fontnum 1 def /fontsize 10 def /fontheight 10 def /fontslant 0 def
/xi {0 72 11 mul translate 72 resolution div dup neg scale 0 0 moveto
  /fontnum 1 def /fontsize 10 def /fontheight 10 def /fontslant 0 def F
  /pagesave save def}def
/xiL {72 8.25 mul 72 11 mul translate -90 rotate
  72 resolution div dup neg scale 0 0 moveto
  /fontnum 1 def /fontsize 10 def /fontheight 10 def /fontslant 0 def F
  /pagesave save def}def
/PB{save /psv exch def currentpoint translate 
  resolution 72 div dup neg scale 0 0 moveto}def
/PE{psv restore}def
/arctoobig 90 def /arctoosmall .05 def
/m1 matrix def /m2 matrix def /m3 matrix def /oldmat matrix def
/tan{dup sin exch cos div}def
/point{resolution 72 div mul}def
/dround	{transform round exch round exch itransform}def
/xT{/devname exch def}def
/xr{/mh exch def /my exch def /resolution exch def}def
/xp{}def
/xs{docsave restore end}def
/xt{}def
/xf{/fontname exch def /slotno exch def fontnames slotno get fontname eq not
 {fonts slotno fontname findfont put fontnames slotno fontname put}if}def
/xH{/fontheight exch def F}def
/xS{/fontslant exch def F}def
/s{/fontsize exch def /fontheight fontsize def F}def
/f{/fontnum exch def F}def
/F{fontheight 0 le {/fontheight fontsize def}if
   fonts fontnum get fontsize point 0 0 fontheight point neg 0 0 m1 astore
   fontslant 0 ne{1 0 fontslant tan 1 0 0 m2 astore m3 concatmatrix}if
   makefont setfont .04 fontsize point mul 0 dround pop setlinewidth}def
/X{exch currentpoint exch pop moveto show}def
/N{3 1 roll moveto show}def
/Y{exch currentpoint pop exch moveto show}def
/S{show}def
/ditpush{}def/ditpop{}def
/AX{3 -1 roll currentpoint exch pop moveto 0 exch ashow}def
/AN{4 2 roll moveto 0 exch ashow}def
/AY{3 -1 roll currentpoint pop exch moveto 0 exch ashow}def
/AS{0 exch ashow}def
/MX{currentpoint exch pop moveto}def
/MY{currentpoint pop exch moveto}def
/MXY{moveto}def
/cb{pop}def	% action on unknown char -- nothing for now
/n{}def/w{}def
/p{pop showpage pagesave restore /pagesave save def}def
% sun logo
/u{newpath
  -28 7.5 moveto
  15 7.5 lineto
  15.5 15 7.5 270 90 arc
  -28 22.5 lineto
  stroke} def
/un{
  gsave 30 30 translate
  u 180 rotate u
  grestore
  90 rotate} def
/logo{
  gsave
  un un un un
  grestore} def
% Manual Feed Definitions
/SetStTime{statusdict /manualfeedtimeout 120 put} def
/SetStatus{statusdict /manualfeed true put
   statusdict /product get (LaserWriter) eq 
   {version (23.0) eq  % Don't redefine showpage if printer is not "Classic LW"
     {/p {
	 {statusdict /printerstatus get exec 16#22000000 and 0 eq{exit}if}loop
	 pop showpage pagesave restore /pagesave save def}def}if }if}def
/abspoint{currentpoint exch pop add exch currentpoint pop add exch}def
/distance{dup mul exch dup mul add sqrt}def
/dstroke{currentpoint stroke moveto}def
/Dl{2 copy gsave rlineto stroke grestore rmoveto}def
/arcellipse{/diamv exch def /diamh exch def oldmat currentmatrix pop
 currentpoint translate 1 diamv diamh div scale /rad diamh 2 div def
 currentpoint exch rad add exch rad -180 180 arc oldmat setmatrix}def
/Dc{dup arcellipse dstroke}def
/De{arcellipse dstroke}def
/Da{/endv exch def /endh exch def /centerv exch def /centerh exch def
 /cradius centerv centerv mul centerh centerh mul add sqrt def
 /eradius endv endv mul endh endh mul add sqrt def
 /endang endv endh atan def
 /startang centerv neg centerh neg atan def
 /sweep startang endang sub dup 0 lt{360 add}if def
 sweep arctoobig gt
 {/midang startang sweep 2 div sub def /midrad cradius eradius add 2 div def
  /midh midang cos midrad mul def /midv midang sin midrad mul def
  midh neg midv neg endh endv centerh centerv midh midv Da
  currentpoint moveto Da}
 {sweep arctoosmall ge
  {/controldelt 1 sweep 2 div cos sub 3 sweep 2 div sin mul div 4 mul def
  centerv neg controldelt mul centerh controldelt mul
  endv neg controldelt mul centerh add endh add
  endh controldelt mul centerv add endv add
  centerh endh add centerv endv add rcurveto dstroke}
 {centerh endh add centerv endv add rlineto dstroke}ifelse}ifelse}def

/Barray 200 array def % 200 values in a wiggle
/D~{mark}def
/D~~{counttomark Barray exch 0 exch getinterval astore /Bcontrol exch def pop
 /Blen Bcontrol length def Blen 4 ge Blen 2 mod 0 eq and
 {Bcontrol 0 get Bcontrol 1 get abspoint /Ycont exch def /Xcont exch def
  Bcontrol 0 2 copy get 2 mul put Bcontrol 1 2 copy get 2 mul put
  Bcontrol Blen 2 sub 2 copy get 2 mul put
  Bcontrol Blen 1 sub 2 copy get 2 mul put
  /Ybi /Xbi currentpoint 3 1 roll def def 0 2 Blen 4 sub
  {/i exch def
   Bcontrol i get 3 div Bcontrol i 1 add get 3 div
   Bcontrol i get 3 mul Bcontrol i 2 add get add 6 div
   Bcontrol i 1 add get 3 mul Bcontrol i 3 add get add 6 div
   /Xbi Xcont Bcontrol i 2 add get 2 div add def
   /Ybi Ycont Bcontrol i 3 add get 2 div add def
   /Xcont Xcont Bcontrol i 2 add get add def
   /Ycont Ycont Bcontrol i 3 add get add def
   Xbi currentpoint pop sub Ybi currentpoint exch pop sub rcurveto
  }for dstroke}if}def
end
/ditstart{$DITroff begin
 /nfonts 60 def			% NFONTS makedev/ditroff dependent!
 /fonts[nfonts{0}repeat]def
 /fontnames[nfonts{()}repeat]def
/docsave save def
}def

% character outcalls
/oc {/pswid exch def /cc exch def /name exch def
   /ditwid pswid fontsize mul resolution mul 72000 div def
   /ditsiz fontsize resolution mul 72 div def
   ocprocs name known{ocprocs name get exec}{name cb}
   ifelse}def
/fractm [.65 0 0 .6 0 0] def
/fraction
 {/fden exch def /fnum exch def gsave /cf currentfont def
  cf fractm makefont setfont 0 .3 dm 2 copy neg rmoveto
  fnum show rmoveto currentfont cf setfont(\244)show setfont fden show 
  grestore ditwid 0 rmoveto} def
/oce {grestore ditwid 0 rmoveto}def
/dm {ditsiz mul}def

/ocprocs 50 dict def ocprocs begin
(14){(1)(4)fraction}def
(12){(1)(2)fraction}def
(34){(3)(4)fraction}def
(13){(1)(3)fraction}def
(23){(2)(3)fraction}def
(18){(1)(8)fraction}def
(38){(3)(8)fraction}def
(58){(5)(8)fraction}def
(78){(7)(8)fraction}def
(sr){gsave 0 .06 dm rmoveto(\326)show oce}def
(is){gsave 0 .15 dm rmoveto(\362)show oce}def
(->){gsave 0 .02 dm rmoveto(\256)show oce}def
(<-){gsave 0 .02 dm rmoveto(\254)show oce}def
(==){gsave 0 .05 dm rmoveto(\272)show oce}def
end

% an attempt at a PostScript FONT to implement ditroff special chars
% this will enable us to 
%	cache the little buggers
%	generate faster, more compact PS out of psdit
%	confuse everyone (including myself)!
50 dict dup begin
/FontType 3 def
/FontName /DIThacks def
/FontMatrix [.001 0 0 .001 0 0] def
/FontBBox [-260 -260 1000 1000] def% a lie but ...
/Encoding 256 array def
0 1 255{Encoding exch /.notdef put}for
Encoding
 dup 8#040/space put %space
 dup 8#224/rc put %right ceil
 dup 8#213/lt put %left  top curl
 dup 8#210/bv put %bold vert
 dup 8#217/lk put %left  mid curl
 dup 8#214/lb put %left  bot curl
 dup 8#215/rt put %right top curl
 dup 8#220/rk put %right mid curl
 dup 8#216/rb put %right bot curl
 dup 8#222/rf put %right floor
 dup 8#221/lf put %left  floor
 dup 8#223/lc put %left  ceil
 dup 8#204/sq put %square
 dup 8#205/bx put %box
 dup 8#206/ci put %circle
 dup 8#207/br put %box rule
 dup 8#140/rn put %root extender
 dup 8#145/vr put %vertical rule
 dup 8#146/ob put %outline bullet
 dup 8#267/bu put %bullet
 dup 8#211/ru put %rule
 dup 8#137/ul put %underline
 dup 8#212/su put %sun logo
 pop
/DITfd 100 dict def
/BuildChar{0 begin
 /cc exch def /fd exch def
 /charname fd /Encoding get cc get def
 /charwid fd /Metrics get charname get def
 /charproc fd /CharProcs get charname get def
 charwid 0 fd /FontBBox get aload pop setcachedevice
 2 setlinejoin 40 setlinewidth
 newpath 0 0 moveto gsave charproc grestore
 end}def
/BuildChar load 0 DITfd put
%/UniqueID 5 def
/CharProcs 50 dict def
CharProcs begin
/space{}def
/.notdef{}def
/ru{500 0 rls}def
/rn{0 800 moveto 500 0 rls}def
/vr{0 800 moveto 0 -800 rls}def
/bv{0 800 moveto 0 -1000 rls}def
/br{0 800 moveto 0 -1000 rls}def
/ul{0 -200 moveto 500 0 rls}def
/ob{200 250 rmoveto currentpoint newpath 200 0 360 arc closepath stroke}def
/bu{200 250 rmoveto currentpoint newpath 200 0 360 arc closepath fill}def
/sq{80 0 rmoveto currentpoint dround newpath moveto
    640 0 rlineto 0 640 rlineto -640 0 rlineto closepath stroke}def
/bx{80 0 rmoveto currentpoint dround newpath moveto
    640 0 rlineto 0 640 rlineto -640 0 rlineto closepath fill}def
/ci{360 280 rmoveto currentpoint newpath 333 0 360 arc
    50 setlinewidth stroke}def

/lt{0 -200 moveto 0 550 rlineto currx 800 2cx s4 add exch s4 a4p stroke}def
/lb{0 800 moveto 0 -550 rlineto currx -200 2cx s4 add exch s4 a4p stroke}def
/rt{0 -200 moveto 0 550 rlineto currx 800 2cx s4 sub exch s4 a4p stroke}def
/rb{0 800 moveto 0 -500 rlineto currx -200 2cx s4 sub exch s4 a4p stroke}def
/lk{0 800 moveto 0 300 -300 300 s4 arcto pop pop 1000 sub
    0 300 4 2 roll s4 a4p 0 -200 lineto stroke}def
/rk{0 800 moveto 0 300 s2 300 s4 arcto pop pop 1000 sub
    0 300 4 2 roll s4 a4p 0 -200 lineto stroke}def
/lf{0 800 moveto 0 -1000 rlineto s4 0 rls}def
/rf{0 800 moveto 0 -1000 rlineto s4 neg 0 rls}def
/lc{0 -200 moveto 0 1000 rlineto s4 0 rls}def
/rc{0 -200 moveto 0 1000 rlineto s4 neg 0 rls}def
/su{10 setlinewidth
    480 240 translate
    45 rotate
    -7 7 scale
    logo} def
end

/Metrics 50 dict def Metrics begin
/.notdef 0 def
/space 500 def
/ru 500 def
/br 0 def
/lt 416 def
/lb 416 def
/rt 416 def
/rb 416 def
/lk 416 def
/rk 416 def
/rc 416 def
/lc 416 def
/rf 416 def
/lf 416 def
/bv 416 def
/ob 350 def
/bu 350 def
/ci 750 def
/bx 750 def
/sq 750 def
/rn 500 def
/ul 500 def
/vr 0 def
/su 900 def
end

DITfd begin
/s2 500 def /s4 250 def /s3 333 def
/a4p{arcto pop pop pop pop}def
/2cx{2 copy exch}def
/rls{rlineto stroke}def
/currx{currentpoint pop}def
/dround{transform round exch round exch itransform} def
end
end
/DIThacks exch definefont pop
ditstart
(psc)xT
576 1 1 xr
1(Times-Roman)xf 1 f
2(Times-Italic)xf 2 f
3(Times-Bold)xf 3 f
4(Times-BoldItalic)xf 4 f
5(Helvetica)xf 5 f
6(Helvetica-Bold)xf 6 f
7(Courier)xf 7 f
8(Courier-Bold)xf 8 f
9(Symbol)xf 9 f
10(DIThacks)xf 10 f
10 s
1 f
xi
%%EndProlog

%%Page: 1 1
10 s 0 xH 0 xS 1 f
8 s
3 f
12 s
1449 976(SunOS)N
1760(Virtual)X
2083(Memory)X
2460(Implementation)X
2 f
10 s
2008 1168(Joseph)N
2251(P.)X
2340(Moran)X
1 f
1905 1312(Sun)N
2049(Microsystems,)X
2538(Inc.)X
1950 1408(2550)N
2130(Garcia)X
2365(Avenue)X
1755 1504(Mountain)N
2086(View,)X
2300(CA)X
2431(94043)X
2651(USA)X
2 f
2094 1792(ABSTRACT)N
1 f
1043 1984(The)N
1192(implementation)X
1717(of)X
1807(a)X
1866(new)X
2023(virtual)X
2255(memory)X
2545(\(VM\))X
2751(system)X
2996(for)X
3113(Sun's)X
3318(implementa-)X
843 2080(tion)N
998(of)X
1096(the)X
9 s
1222(UNIX)X
10 s
(\262)S
1472(operating)X
1805(system)X
2057(\(SunOS\263\))X
2407(is)X
2490(described.)X
2868(The)X
3023(new)X
3187(VM)X
3346(system)X
3598(was)X
843 2176(designed)N
1157(for)X
1280(extensibility)X
1704(and)X
1849(portability)X
2210(using)X
2411(an)X
2515(object-oriented)X
3029(design)X
3266(carefully)X
3580(con-)X
843 2272(structed)N
1119(to)X
1203(not)X
1327(compromise)X
1745(ef\256ciency.)X
2123(The)X
2269(basic)X
2455(implementation)X
2978(abstractions)X
3382(of)X
3470(the)X
3589(new)X
843 2368(VM)N
1007(system)X
1264(and)X
1415(how)X
1588(they)X
1761(are)X
1895(managed)X
2220(are)X
2354(described.)X
2737(Some)X
2953(of)X
3054(the)X
3186(more)X
3385(interesting)X
843 2464(problems)N
1163(encountered)X
1578(with)X
1741(a)X
1798(system)X
2041(based)X
2245(on)X
2346(mapped)X
2621(objects)X
2869(and)X
3006(the)X
3125(resolution)X
3466(taken)X
3661(to)X
843 2560(these)N
1028(problems)X
1346(are)X
1465(described.)X
3 f
555 2848(1.)N
655(Introduction)X
1 f
755 2972(In)N
844(December)X
1197(1985)X
1379(our)X
1508(group)X
1717(at)X
1797(Sun)X
1943(Microsystems)X
2414(began)X
2628(a)X
2686(project)X
2931(to)X
3014(replace)X
3268(our)X
3396(4.2BSD-based)X
3882(VM)X
555 3068(system)N
798(with)X
961(a)X
1018(VM)X
1168(system)X
1411(engineered)X
1784(for)X
1898(the)X
2016(future.)X
2268(A)X
2346(companion)X
2722(paper)X
2921([1])X
3035(describes)X
3354(the)X
3472(general)X
3729(architec-)X
555 3164(ture)N
700(of)X
787(our)X
914(new)X
1068(VM)X
1217(system,)X
1479(its)X
1574(goals,)X
1783(and)X
1919(its)X
2014(design)X
2243(rationale.)X
2584(To)X
2693(summarize,)X
3085(this)X
3220(architecture)X
3620(provides:)X
10 f
755 3288(\267)N
1 f
955(Address)X
1238(spaces)X
1468(that)X
1608(are)X
1727(described)X
2055(by)X
2155(mapped)X
2429(objects.)X
10 f
755 3412(\267)N
1 f
955(Support)X
1228(for)X
1342(shared)X
1572(or)X
1659(private)X
1902(\(copy-on-write\))X
2431(mappings.)X
10 f
755 3536(\267)N
1 f
955(Support)X
1228(for)X
1342(large,)X
1543(sparse)X
1764(address)X
2025(spaces.)X
10 f
755 3660(\267)N
1 f
955(Page)X
1131(level)X
1307(mapping)X
1607(control.)X
755 3784(We)N
894(wanted)X
1152(the)X
1276(new)X
1436(VM)X
1591(system's)X
1897(implementation)X
2425(to)X
2513(re\257ect)X
2740(the)X
2864(clean)X
3060(design)X
3295(of)X
3388(its)X
3489(architecture)X
3895(and)X
555 3880(felt)N
693(that)X
844(basing)X
1084(the)X
1213(implementation)X
1746(itself)X
1936(on)X
2046(the)X
2174(proper)X
2414(set)X
2533(of)X
2630(abstractions)X
3043(would)X
3273(result)X
3481(in)X
3573(a)X
3639(system)X
3891(that)X
555 3976(would)N
780(be)X
881(ef\256cient,)X
1189(extensible)X
1539(to)X
1626(solving)X
1886(future)X
2103(problems,)X
2446(readily)X
2694(portable)X
2981(to)X
3067(other)X
3256(hardware)X
3580(architectures,)X
555 4072(and)N
693(understandable.)X
1241(Our)X
1388(group's)X
1655(earlier)X
1883(experience)X
2254(in)X
2338(implementing)X
2804(the)X
2 f
2923(vnode)X
1 f
3149(architecture)X
3550([2])X
3665(had)X
3802(shown)X
555 4168(us)N
656(the)X
784(utility)X
1004(of)X
1101(using)X
1304(object-oriented)X
1820(programming)X
2286(techniques)X
2658(as)X
2754(a)X
2819(way)X
2982(of)X
3078(devising)X
3378(useful)X
3603(and)X
3748(ef\256cient)X
555 4264(implementation)N
1077(abstractions,)X
1500(so)X
1591(we)X
1705(chose)X
1908(to)X
1990(apply)X
2188(these)X
2373(techniques)X
2736(to)X
2818(our)X
2945(VM)X
3094(implementation)X
3616(as)X
3703(well.)X
755 4388(The)N
908(rest)X
1052(of)X
1147(this)X
1290(paper)X
1497(is)X
1578(structured)X
1927(as)X
2022(follows.)X
2330(Section)X
2598(2)X
2666(provides)X
2970(an)X
3074(overview)X
3401(of)X
3496(the)X
3622(basic)X
3815(object)X
555 4484(types)N
748(that)X
892(form)X
1072(the)X
1194(foundation)X
1565(of)X
1656(the)X
1778(implementation,)X
2324(and)X
2464(sections)X
2746(3)X
2809(through)X
3081(6)X
3144(describe)X
3435(these)X
3623(object)X
3842(types)X
555 4580(in)N
643(detail.)X
887(Sections)X
1184(7)X
1250(through)X
1525(9)X
1591(describe)X
1885(related)X
2130(changes)X
2415(made)X
2615(to)X
2703(the)X
2827(rest)X
2969(of)X
3062(the)X
3186(SunOS)X
3438(kernel.)X
3705(The)X
3856(most)X
555 4676(extensive)N
886(changes)X
1173(were)X
1358(those)X
1555(related)X
1802(to)X
1892(the)X
2018(\256le)X
2148(system)X
2397(object)X
2620(managers.)X
2995(A)X
3080(particular)X
3415(\256le)X
3544(system)X
3793(type)X
3958(is)X
555 4772(used)N
726(to)X
812(illustrate)X
1116(those)X
1309(changes.)X
1632(Section)X
1895(10)X
1998(compares)X
2329(the)X
2450(performance)X
2880(of)X
2970(the)X
3091(old)X
3216(and)X
3355(new)X
3512(VM)X
3664(implemen-)X
555 4868(tations.)N
828(Sections)X
1119(11)X
1219(and)X
1355(12)X
1455(discuss)X
1706(conclusions)X
2104(and)X
2240(plans)X
2429(for)X
2543(future)X
2755(work.)X
3 f
555 5060(2.)N
655(Implementation)X
1222(Structure)X
1 f
755 5184(The)N
903(initial)X
1112(problem)X
1402(we)X
1519(faced)X
1717(in)X
1802(designing)X
2135(the)X
2255(new)X
2411(VM)X
2562(system's)X
2864(implementation)X
3388(was)X
3535(\256nding)X
3783(a)X
3841(clean)X
555 5280(set)N
672(of)X
766(implementation)X
1295(abstractions.)X
1745(The)X
1897(system's)X
2204(architecture)X
2611(suggested)X
2954(some)X
3150(candidate)X
3485(abstractions)X
3895(and)X
555 5376(examining)N
913(the)X
1031(architecture)X
1431(with)X
1593(an)X
1689(eye)X
1821(toward)X
2064(carving)X
2325(it)X
2389(into)X
2533(a)X
2589(collection)X
2925(of)X
3012(objects)X
3259(suggested)X
3595(others.)X
8 s
10 f
555 5504(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
1 f
555 5584(\262)N
7 s
601(UNIX)X
8 s
756(is)X
815(a)X
859(trademark)X
1133(of)X
1202(Bell)X
1325(Laboratories.)X
555 5664(\263)N
603(SunOS)X
801(is)X
860(a)X
904(trademark)X
1178(of)X
1247(Sun)X
1363(Microsystems.)X
10 s
2263 6144(1)N

2 p
%%Page: 2 2
10 s 0 xH 0 xS 1 f
755 672(We)N
887(ultimately)X
1231(chose)X
1434(the)X
1552(following)X
1883(set)X
1992(of)X
2079(basic)X
2264(abstractions.)X
10 f
755 796(\267)N
1 f
955(The)X
1110(architecture)X
1520(allows)X
1759(for)X
1883(page-level)X
2248(granularity)X
2630(in)X
2722(establishing)X
3133(mappings)X
3473(from)X
3658(\256le)X
3789(system)X
955 892(objects)N
1205(to)X
1290(virtual)X
1522(addresses.)X
1893(Thus)X
2076(the)X
2197(implementation)X
2722(uses)X
2883(the)X
2 f
3004(page)X
1 f
3196(structure)X
3500(to)X
3585(keep)X
3760(track)X
3944(of)X
955 988(information)N
1359(about)X
1563(physical)X
1855(memory)X
2147(pages.)X
2395(The)X
2545(object)X
2766(managers)X
3099(and)X
3240(the)X
3363(VM)X
3517(system)X
3764(use)X
3896(this)X
955 1084(data)N
1109(structure)X
1410(to)X
1492(manage)X
1762(physical)X
2049(memory)X
2336(as)X
2423(a)X
2479(cache.)X
10 f
755 1208(\267)N
1 f
955(The)X
1103(architecture)X
1506(de\256nes)X
1756(the)X
1877(notion)X
2104(of)X
2194(an)X
2293(``address)X
2611(space''.)X
2907(In)X
2997(the)X
3118(implementation,)X
3663(an)X
2 f
3762(address)X
955 1304(space)N
1 f
1176(consists)X
1454(of)X
1546(an)X
1646(ordered)X
1916(linked)X
2140(list)X
2261(of)X
2352(mappings.)X
2727(This)X
2893(level)X
3073(de\256nes)X
3324(the)X
3446(external)X
3729(interface)X
955 1400(to)N
1046(the)X
1173(VM)X
1331(system)X
1582(and)X
1727(supplies)X
2018(a)X
2083(simple)X
2324(procedural)X
2696(interface)X
3006(to)X
3096(its)X
3199(primary)X
3481(client,)X
3707(the)X
9 s
3831(UNIX)X
10 s
955 1496(kernel.)N
10 f
755 1620(\267)N
1 f
955(A)X
2 f
1039(segment)X
1 f
1341(describes)X
1666(a)X
1728(contiguous)X
2105(mapping)X
2411(of)X
2504(virtual)X
2739(addresses)X
3073(onto)X
3241(some)X
3436(underlying)X
3809(entity.)X
955 1716(The)N
1105(corresponding)X
1589(layer)X
1775(of)X
1867(the)X
1990(implementation)X
2516(treats)X
2714(segments)X
3036(as)X
3127(objects,)X
3398(acting)X
3618(as)X
3709(a)X
3769(class)X
3949(in)X
955 1812(the)N
1085(C++)X
1259([3])X
1384(sense)X
8 s
1558 1787(1)N
10 s
1812(.)Y
1661(Segments)X
2003(can)X
2146(map)X
2315(several)X
2574(different)X
2882(kinds)X
3086(of)X
3184(target)X
3398(entities.)X
3700(The)X
3856(most)X
955 1908(common)N
1265(mappings)X
1606(are)X
1735(to)X
1827(objects)X
2084(that)X
2234(appear)X
2479(in)X
2570(the)X
2697(\256le)X
2828(system)X
3079(name)X
3282(space,)X
3510(such)X
3686(as)X
3782(\256les)X
3944(or)X
955 2004(frame)N
1166(buffers.)X
1457(Regardless)X
1832(of)X
1922(mapping)X
2225(type,)X
2406(the)X
2527(segment)X
2817(layer)X
3001(supplies)X
3285(a)X
3343(common)X
3645(interface)X
3949(to)X
955 2100(the)N
1077(rest)X
1217(of)X
1308(the)X
1430(implementation.)X
1996(Since)X
2198(there)X
2382(are)X
2504(several)X
2755(types)X
2947(of)X
3037(segment)X
3327(mappings,)X
3681(the)X
3802(imple-)X
955 2196(mentation)N
1301(uses)X
1465(different)X
2 f
1767(segment)X
2055(drivers)X
1 f
2320(for)X
2439(each.)X
2652(These)X
2869(drivers)X
3117(behave)X
3370(as)X
3462(subclasses)X
3821(of)X
3913(the)X
955 2292(segment)N
1242(class.)X
10 f
755 2416(\267)N
1 f
955(The)X
2 f
1113(hardware)X
1456(address)X
1737(translation)X
1 f
2132(\()X
2 f
2159(hat)X
1 f
2261(\))X
2320(layer)X
2513(is)X
2598(the)X
2728(machine)X
3032(dependent)X
3394(code)X
3578(that)X
3730(manages)X
955 2512(hardware)N
1275(translations)X
1664(to)X
1746(pages)X
1949(in)X
2031(the)X
2149(machine's)X
2499(memory)X
2786(management)X
3216(unit)X
3360(\(MMU\).)X
755 2636(The)N
905(VM)X
1059(implementation)X
1586(requires)X
1870(services)X
2154(from)X
2335(the)X
2458(rest)X
2599(of)X
2691(the)X
2814(kernel.)X
3079(In)X
3170(particular,)X
3522(it)X
3590(makes)X
3819(heavy)X
555 2732(demands)N
875(of)X
977(the)X
2 f
1110(vnode)X
1 f
1350([2])X
1479(object)X
1710(manager.)X
2062(The)X
2222(implementation)X
2758(expects)X
3033(the)X
2 f
3165(vnode)X
1 f
3404(drivers)X
3661(to)X
3757(mediate)X
555 2828(access)N
788(to)X
877(pages)X
1087(comprising)X
1474(\256le)X
1603(objects.)X
1897(The)X
2049(part)X
2201(of)X
2295(the)X
2 f
2420(vnode)X
1 f
2652(interface)X
2961(dealing)X
3223(with)X
3391(cache)X
3601(management)X
555 2924(changed)N
848(drastically.)X
1247(Finding)X
1520(the)X
1643(right)X
1819(division)X
2101(of)X
2193(responsibility)X
2653(between)X
2946(the)X
3068(segment)X
3359(layer)X
3544(and)X
3684(the)X
2 f
3806(vnode)X
1 f
555 3020(layer)N
736(proved)X
979(to)X
1061(be)X
1157(unexpectedly)X
1605(dif\256cult)X
1878(and)X
2014(accounted)X
2360(for)X
2474(much)X
2672(of)X
2759(the)X
2877(overall)X
3120(implementation)X
3642(effort.)X
755 3144(The)N
914(new)X
1082(VM)X
1245(system)X
1501(proper)X
1745(has)X
1886(no)X
1999(knowledge)X
2384(of)X
9 s
2482(UNIX)X
10 s
2695(semantics.)X
3084(The)X
3242(SunOS)X
3501(kernel)X
3735(provides)X
9 s
555 3240(UNIX)N
10 s
757(semantics)X
1095(by)X
1197(using)X
1392(the)X
1512(VM)X
1663(abstractions)X
2068(as)X
2157(primitive)X
2472(operations)X
2828([1].)X
2984(Figure)X
3214(1)X
3275(is)X
3349(a)X
3406(schematic)X
3748(diagram)X
555 3336(of)N
649(the)X
774(VM)X
930(abstractions)X
1340(and)X
1483(how)X
1648(they)X
1813(interact.)X
2121(The)X
2273(following)X
2611(sections)X
2896(describe)X
3191(in)X
3280(more)X
3472(detail)X
3677(the)X
3802(imple-)X
555 3432(mentation)N
895(abstractions)X
1298(summarized)X
1710(above.)X
3 f
555 3624(3.)N
4 f
655(page)X
3 f
831(Structure)X
1 f
755 3748(The)N
911(new)X
1076(VM)X
1236(architecture)X
1646(treats)X
1850(physical)X
2147(memory)X
2444(as)X
2541(a)X
2607(cache)X
2821(for)X
2945(the)X
3073(contents)X
3370(of)X
3467(memory)X
3764(objects.)X
555 3844(The)N
2 f
704(page)X
1 f
896(is)X
972(the)X
1093(data)X
1250(structure)X
1554(that)X
1697(contains)X
1987(the)X
2108(information)X
2509(that)X
2652(the)X
2773(VM)X
2925(system)X
3170(and)X
3309(object)X
3528(managers)X
3859(need)X
555 3940(to)N
654(manage)X
941(this)X
1092(cache.)X
1352(The)X
2 f
1513(page)X
1 f
1718(structure)X
2035(maintains)X
2382(the)X
2516(identity)X
2796(and)X
2948(status)X
3166(of)X
3269(each)X
3453(page)X
3641(of)X
3744(physical)X
555 4036(memory)N
842(in)X
924(the)X
1042(system.)X
1324(There)X
1532(is)X
1605(one)X
2 f
1741(page)X
1 f
1930(structure)X
2231(for)X
2345(every)X
2544(interesting)X
8 s
2882 4011(2)N
10 s
2934 4036(page)N
3106(in)X
3188(the)X
3306(system.)X
755 4160(A)N
2 f
840(page)X
1 f
1036(represents)X
1389(a)X
1452(system)X
1701(page)X
1879(size)X
2030(unit)X
2180(of)X
2273(memory)X
2566(that)X
2712(is)X
2791(a)X
2853(multiple)X
3145(of)X
3238(the)X
3362(hardware)X
3688(page)X
3866(size.)X
555 4256(The)N
709(memory)X
1005(page)X
1186(is)X
1268(identi\256ed)X
1599(by)X
1708(a)X
1773(<)X
2 f
1818(vnode)X
1 f
2010(,)X
2059(offset>)X
2315(pair)X
2468(kept)X
2634(in)X
2724(the)X
2 f
2850(page)X
1 f
3047(structure.)X
3396(Each)X
3585(page)X
3765(with)X
3935(an)X
555 4352(identity)N
822(is)X
898(initialized)X
1241(to)X
1326(the)X
1447(contents)X
1737(of)X
1827(a)X
1886(page's)X
2119(worth)X
2329(of)X
2419(the)X
2 f
2540(vnode)X
1 f
2745('s)X
2826(data)X
2983(starting)X
3246(at)X
3327(the)X
3448(given)X
3648(byte)X
3808(offset.)X
555 4448(A)N
635(hashed)X
880(lookup)X
1124(based)X
1329(on)X
1431(the)X
1551(<)X
2 f
1596(vnode)X
1 f
1788(,)X
1830(offset>)X
2080(pair)X
2227(naming)X
2489(the)X
2609(page)X
2783(is)X
2857(used)X
3025(to)X
3108(\256nd)X
3253(a)X
3310(page)X
3483(with)X
3646(a)X
3703(particular)X
555 4544(name.)N
793(The)X
942(implementation)X
1468(keeps)X
1675(all)X
1779(pages)X
1986(for)X
2104(a)X
2164(given)X
2 f
2366(vnode)X
1 f
2595(on)X
2699(a)X
2759(doubly-linked)X
3232(list)X
3353(rooted)X
3582(at)X
3664(the)X
2 f
3786(vnode.)X
1 f
555 4640(Maintaining)N
973(this)X
1115(list)X
1239(speeds)X
1480(operations)X
1841(that)X
1988(need)X
2167(to)X
2256(\256nd)X
2407(all)X
2514(a)X
2 f
2577(vnode)X
1 f
2782('s)X
2867(cached)X
3117(pages.)X
2 f
3366(page)X
1 f
3561(structures)X
3899(can)X
555 4736(also)N
709(be)X
810(on)X
915(free)X
1066(lists)X
1219(or)X
1311(on)X
1416(an)X
1517(``I/O'')X
1757(list)X
1879(depending)X
2237(on)X
2341(the)X
2463(setting)X
2700(of)X
2791(page)X
2967(status)X
3173(\257ags.)X
3388(The)X
2 f
3537(page)X
1 f
3730(structure)X
555 4832(also)N
707(contains)X
997(an)X
1096(opaque)X
1351(pointer)X
1601(that)X
1744(the)X
2 f
1865(hat)X
1 f
2003(layer)X
2187(uses)X
2348(to)X
2433(maintain)X
2736(a)X
2794(list)X
2913(of)X
3002(all)X
3104(the)X
3224(active)X
3438(translations)X
3829(to)X
3913(the)X
555 4928(page)N
732(that)X
877(are)X
1001(loaded)X
1239(in)X
1325(the)X
1447(hardware.)X
1811(In)X
1902(the)X
2024(machine)X
2320(independent)X
2736(VM)X
2889(code)X
3065(above)X
3281(the)X
2 f
3403(hat)X
1 f
3542(layer,)X
3747(the)X
3869(only)X
555 5024(use)N
685(for)X
802(this)X
940(opaque)X
1195(pointer)X
1445(is)X
1521(to)X
1605(test)X
1738(for)X
1854(NULL)X
2090(to)X
2174(determine)X
2517(if)X
2588(there)X
2771(are)X
2892(any)X
3030(active)X
3244(translations)X
3635(to)X
3719(the)X
3839(page.)X
555 5120(When)N
786(the)X
923(machine-dependent)X
2 f
1591(hat)X
1 f
1745(layer)X
1945(unloads)X
2233(a)X
2308(translation)X
2685(it)X
2767(retrieves)X
3082(the)X
3218(hardware)X
3556 0.4531(reference)AX
3895(and)X
555 5216(modi\256ed)N
863(bits)X
1002(for)X
1120(that)X
1264(translation)X
1626(to)X
1712(the)X
1833(page,)X
2028(and)X
2167(merges)X
2422(them)X
2605(into)X
2752(machine-independent)X
3466(versions)X
3756(of)X
3846(these)X
555 5312(bits)N
690(maintained)X
1066(in)X
1148(the)X
2 f
1266(page)X
1 f
1455(structure.)X
8 s
10 f
555 5476(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5551(1)N
8 s
691 5570(Actually,)N
943(as)X
1012(a)X
1056(class)X
1196(whose)X
1375(public)X
1551(\256elds)X
1706(are)X
1799(all)X
1879(virtual,)X
2078(so)X
2151(that)X
2263(subclasses)X
2545(are)X
2638(expected)X
2880(to)X
2946(de\256ne)X
3118(them.)X
6 s
635 5645(2)N
8 s
691 5664(Pages)N
856(for)X
946(kernel)X
1121(text)X
1233(and)X
1341(data)X
1463(and)X
1571(for)X
1661(frame)X
1825(buffers)X
2021(are)X
2114(not)X
2212(considered)X
2504(``interesting''.)X
10 s
2263 6144(2)N

3 p
%%Page: 3 3
10 s 0 xH 0 xS 1 f
1329 2992(Hardware)N
1667(Address)X
1950(Translation)X
958 3120 MXY
0 -288 Dl
1728 0 Dl
0 288 Dl
-1728 0 Dl
3146 2992(Physical)N
3437(IO)X
2974 3120 MXY
0 -288 Dl
720 0 Dl
0 288 Dl
-720 0 Dl
1183 1816(Physical)N
1225 2008(Pages)N
958 2256 MXY
0 -720 Dl
720 0 Dl
0 720 Dl
-720 0 Dl
2186 1768(Segment)N
2206 1864(Drivers)N
2295 1960(&)N
2123 2056(VM)N
2272(routines)X
1966 2256 MXY
0 -720 Dl
720 0 Dl
0 720 Dl
-720 0 Dl
3227 1816(Vnode)N
3214 2008(Drivers)N
2974 2256 MXY
0 -720 Dl
720 0 Dl
0 720 Dl
-720 0 Dl
2195 1216(Address)N
2230 1312(Space)N
1966 1392 MXY
0 -288 Dl
720 0 Dl
0 288 Dl
-720 0 Dl
1813 832(Unix)N
1993(System)X
2248(Calls)X
2432(and)X
2568(Services)X
1102 960 MXY
0 -288 Dl
2448 0 Dl
0 288 Dl
-2448 0 Dl
670 2544 MXY
29 0 Dl
728 MX
29 0 Dl
785 MX
29 0 Dl
843 MX
29 0 Dl
901 MX
28 0 Dl
958 MX
29 0 Dl
1016 MX
29 0 Dl
1073 MX
29 0 Dl
1131 MX
29 0 Dl
1189 MX
28 0 Dl
1246 MX
29 0 Dl
1304 MX
29 0 Dl
1361 MX
29 0 Dl
1419 MX
29 0 Dl
1477 MX
28 0 Dl
1534 MX
29 0 Dl
1592 MX
29 0 Dl
1649 MX
29 0 Dl
1707 MX
29 0 Dl
1765 MX
28 0 Dl
1822 MX
29 0 Dl
1880 MX
29 0 Dl
1937 MX
29 0 Dl
1995 MX
29 0 Dl
2053 MX
28 0 Dl
2110 MX
29 0 Dl
2168 MX
29 0 Dl
2225 MX
29 0 Dl
2283 MX
29 0 Dl
2340 MX
29 0 Dl
2398 MX
29 0 Dl
2456 MX
28 0 Dl
2513 MX
29 0 Dl
2571 MX
29 0 Dl
2628 MX
29 0 Dl
2686 MX
29 0 Dl
2744 MX
28 0 Dl
2801 MX
29 0 Dl
2859 MX
29 0 Dl
2916 MX
29 0 Dl
2974 MX
29 0 Dl
3032 MX
28 0 Dl
3089 MX
29 0 Dl
3147 MX
29 0 Dl
3204 MX
29 0 Dl
3262 MX
29 0 Dl
3320 MX
28 0 Dl
3377 MX
29 0 Dl
3435 MX
29 0 Dl
3492 MX
29 0 Dl
3550 MX
29 0 Dl
3608 MX
28 0 Dl
3665 MX
29 0 Dl
3723 MX
29 0 Dl
3780 MX
29 0 Dl
3838 MX
29 0 Dl
3896 MX
28 0 Dl
3953 MX
29 0 Dl
1354 2632(Machine)N
1655(Dependent)X
1329 2488(Machine)N
1630(Independent)X
2326 960 MXY
0 144 Dl
2312 1046 MXY
14 58 Dl
2340 1046 MXY
-14 58 Dl
3334 960 MXY
0 576 Dl
3320 1478 MXY
14 58 Dl
3348 1478 MXY
-14 58 Dl
2326 1392 MXY
0 144 Dl
2312 1478 MXY
14 58 Dl
2340 1478 MXY
-14 58 Dl
1909 1910 MXY
57 -14 Dl
1909 1882 MXY
57 14 Dl
-288 0 Dl
1736 1882 MXY
-58 14 Dl
1736 1910 MXY
-58 -14 Dl
2744 1882 MXY
-58 14 Dl
2744 1910 MXY
-58 -14 Dl
288 0 Dl
2916 1910 MXY
58 -14 Dl
2916 1882 MXY
58 14 Dl
3348 2314 MXY
-14 -58 Dl
3320 2314 MXY
14 -58 Dl
0 576 Dl
3320 2774 MXY
14 58 Dl
3348 2774 MXY
-14 58 Dl
2326 2256 MXY
0 576 Dl
2312 2774 MXY
14 58 Dl
2340 2774 MXY
-14 58 Dl
2974 2976 MXY
-288 0 Dl
2744 2961 MXY
-58 15 Dl
2744 2990 MXY
-58 -14 Dl
3 f
2139 3408(Figure)N
2386(1)X
555 3600(4.)N
655(Address)X
955(Space)X
1 f
755 3724(The)N
903(highest)X
1157(level)X
1336(abstraction)X
1711(that)X
1854(the)X
1975(VM)X
2127(system)X
2372(implements)X
2768(is)X
2844(called)X
3059(an)X
2 f
3158(address)X
3430(space)X
1 f
3648(\()X
2 f
3675(as)X
1 f
3746(\),)X
3815(which)X
555 3820(consists)N
834(of)X
927(a)X
989(collection)X
1330(of)X
1422(mappings)X
1758(from)X
1939(virtual)X
2173(addresses)X
2506(to)X
2593(underlying)X
2965(objects)X
3217(such)X
3389(as)X
3481(\256les)X
3639(and)X
3780(display)X
555 3916(device)N
794(frame)X
1011(buffers.)X
1308(The)X
2 f
1462(as)X
1 f
1575(layer)X
1765(supports)X
2065(a)X
2130(procedural)X
2503(interface)X
2814(whose)X
3048(operations)X
3411(fall)X
3546(into)X
3698(two)X
3846(basic)X
555 4012(classes.)N
845(Procedures)X
1229(in)X
1317(the)X
1441(\256rst)X
1591(class)X
1773(manipulate)X
2155(an)X
2257(entire)X
2466(address)X
2733(space)X
2938(and)X
3080(handle)X
3320(address)X
3587(space)X
3792(alloca-)X
555 4108(tion,)N
720(destruction,)X
1117(duplication,)X
1518(and)X
1655(``swap)X
1895(out''.)X
2112(Procedures)X
2490(in)X
2572(the)X
2690(second)X
2933(class)X
3109(manipulate)X
3485(a)X
3541(virtual)X
3770(address)X
555 4204(range)N
759(within)X
988(an)X
1089(address)X
1355(space.)X
1599(These)X
1816(functions)X
2139(handle)X
2378(fault)X
2550(processing,)X
2938(setting)X
3176(and)X
3317(verifying)X
3635(protections,)X
555 4300(resynchronizing)N
1102(the)X
1230(contents)X
1527(of)X
1624(an)X
1730(address)X
2001(space)X
2209(with)X
2380(the)X
2507(underlying)X
2883(objects,)X
3159(obtaining)X
3490(attributes)X
3817(of)X
3913(the)X
555 4396(mapped)N
844(objects,)X
1126(and)X
1277(mapping)X
1591(and)X
1741(unmapping)X
2135(objects.)X
2436(Further)X
2706(information)X
3118(on)X
3232(these)X
3431(functions)X
3763(may)X
3935(be)X
555 4492(found)N
762(in)X
844([1].)X
755 4616(The)N
903(implementation)X
1428(must)X
1606(maintain)X
1909(state)X
2079(information)X
2480(for)X
2597(each)X
2768(address)X
3031(space.)X
3272(The)X
3419(heart)X
3602(of)X
3691(this)X
3828(infor-)X
555 4712(mation)N
803(is)X
882(a)X
944(doubly)X
1192(linked)X
1417(list)X
1539(of)X
1631(contiguous)X
2007(mappings)X
2343(\(termed)X
2 f
2618(segments)X
1 f
2950(for)X
3069(lack)X
3228(of)X
3320(a)X
3381(better)X
3589(name\))X
3815(sorted)X
555 4808(by)N
662(virtual)X
898(address.)X
1206(Section)X
1472(5)X
1538(describes)X
1863(segments)X
2187(in)X
2275(detail.)X
2519(The)X
2 f
2670(as)X
1 f
2780(layer)X
2967(implements)X
3366(its)X
3467(procedural)X
3837(inter-)X
555 4904(face)N
711(by)X
812(iterating)X
1100(over)X
1263(the)X
1381(required)X
1669(range)X
1868(of)X
1955(virtual)X
2184(addresses)X
2512(and)X
2648(calling)X
2886(the)X
3004(appropriate)X
3390(segment)X
3677(operations)X
555 5000(as)N
642(needed.)X
755 5124(In)N
843(addition,)X
1146(the)X
2 f
1265(as)X
1 f
1370(structure)X
1672(contains)X
1960(a)X
2 f
2017(hardware)X
2349(address)X
2619(translation)X
1 f
3003(\()X
2 f
3030(hat)X
1 f
3132(\))X
3180(structure)X
3482(used)X
3649(to)X
3731(maintain)X
555 5220(implementation)N
1091(speci\256c)X
1370(memory)X
1671(management)X
2115(information.)X
2567(Positioning)X
2964(the)X
2 f
3096(hat)X
1 f
3245(structure)X
3559(within)X
3796(the)X
2 f
3927(as)X
1 f
555 5316(structure)N
872(allows)X
1117(the)X
1251(machine)X
1559(dependent)X
2 f
1925(hat)X
1 f
2076(layer)X
2273(to)X
2371(describe)X
2675(all)X
2790(the)X
2923(physical)X
3225(MMU)X
3460(mappings)X
3806(for)X
3935(an)X
555 5412(address)N
826(space,)X
1055(while)X
1263(the)X
1391(machine)X
1693(independent)X
2 f
2115(as)X
1 f
2228(layer)X
2418(manages)X
2728(all)X
2837(the)X
2964(virtual)X
3202(address)X
3472(space)X
3680(mappings.)X
555 5508(The)N
2 f
705(hat)X
1 f
845(structure)X
1151(is)X
1229(opaque)X
1486(to)X
1573(the)X
1696(machine)X
1993(independent)X
2410(parts)X
2591(of)X
2683(the)X
2806(system)X
3053(and)X
3194(only)X
3361(the)X
2 f
3484(hat)X
1 f
3624(layer)X
3810(exam-)X
555 5604(ines)N
713(it.)X
826(Section)X
1095(6)X
1164(describes)X
1492(the)X
2 f
1619(hat)X
1 f
1763(layer)X
1953(in)X
2044(detail.)X
2291(The)X
2 f
2445(as)X
1 f
2558(structure)X
2867(also)X
3024(includes)X
3319(machine)X
3619(independent)X
555 5700(address)N
816(space)X
1015(statistics)X
1310(that)X
1450(are)X
1569(kept)X
1727(separately)X
2073(from)X
2249(the)X
2367(machine)X
2659(dependent)X
2 f
3009(hat)X
1 f
3144(structure)X
3445(for)X
3559(convenience.)X
2263 6144(3)N

4 p
%%Page: 4 4
10 s 0 xH 0 xS 1 f
3 f
555 672(4.1.)N
715(Address)X
1015(Space)X
1235(Management)X
1 f
755 796(The)N
907(implementation)X
1436(uses)X
1601(several)X
1856(techniques)X
2226(to)X
2315(reduce)X
2557(the)X
2681(overhead)X
3002(of)X
2 f
3095(as)X
1 f
3205(management.)X
3681(To)X
3796(reduce)X
555 892(the)N
675(time)X
838(to)X
921(\256nd)X
1066(the)X
1185(segment)X
1473(for)X
1588(a)X
1645(virtual)X
1875(address,)X
2157(it)X
2222(maintains)X
2554(a)X
2611(``hint'')X
2864(naming)X
3125(the)X
3244(last)X
3376(segment)X
3664(found,)X
3892(in)X
3975(a)X
555 988(manner)N
822(similar)X
1070(to)X
1158(the)X
1282(technique)X
1620(used)X
1793(in)X
1881(Mach)X
2090([4].)X
2250(Any)X
2414(time)X
2581(the)X
2 f
2704(as)X
1 f
2813(layer)X
2999(translates)X
3327(a)X
3388(virtual)X
3622(address)X
3888(to)X
3975(a)X
555 1084(segment,)N
862(this)X
997(hint)X
1141(is)X
1214(used)X
1381(as)X
1468(the)X
1586(starting)X
1846(point)X
2030(to)X
2112(begin)X
2310(the)X
2428(search.)X
755 1208(Another)N
1039(optimization)X
1464(reduces)X
1731(the)X
1849(total)X
2011(number)X
2276(of)X
2363(segments)X
2681(in)X
2763(a)X
2819(given)X
3017(address)X
3278(space)X
3477(by)X
3577(allowing)X
3877(seg-)X
555 1304(ment)N
738(drivers)X
984(to)X
1069(coalesce)X
1364(adjacent)X
1654(segments)X
1974(of)X
2063(similar)X
2307(types.)X
2538(This)X
2702(reduces)X
2970(the)X
3090(average)X
3363(time)X
3527(to)X
3611(\256nd)X
3757(the)X
3877(seg-)X
555 1400(ment)N
747(that)X
899(maps)X
1100(a)X
1168(given)X
1378(virtual)X
1619(address)X
1892(within)X
2128(an)X
2236(address)X
2509(space.)X
2760(By)X
2885(using)X
3090(this)X
3237(technique,)X
3601(the)X
3731(common)X
9 s
555 1496(UNIX)N
2 f
10 s
755(brk)X
1 f
875(\(2\))X
989(system)X
1231(call)X
1367(normally)X
1676(reduces)X
1942(to)X
2024(a)X
2080(simple)X
2313(segment)X
2600(extension)X
2927(within)X
3151(the)X
3269(process)X
3530(address)X
3791(space.)X
3 f
555 1688(4.2.)N
715(Address)X
1015(Space)X
1235(Usage)X
1 f
755 1812(SunOS)N
1003(uses)X
1163(an)X
2 f
1261(as)X
1 f
1367(to)X
1451(describe)X
1740(the)X
1859(kernel's)X
2139(own)X
2298(address)X
2560(space,)X
2780(which)X
2997(is)X
3071(shared)X
3302(by)X
3403(all)X
9 s
3502(UNIX)X
10 s
3703(processes)X
555 1908(when)N
765(operating)X
1104(in)X
1202(privileged)X
1563(\(supervisor\))X
1987(mode.)X
2241(A)X
9 s
2333(UNIX)X
10 s
2549(process)X
2826(typically)X
3141(has)X
3283(an)X
2 f
3394(as)X
1 f
3513(to)X
3610(describe)X
3913(the)X
555 2004(address)N
831(space)X
1045(it)X
1124(operates)X
1427(in)X
1524(when)X
1733(in)X
1830(non-privileged)X
2336(\(user\))X
2558(mode)X
8 s
2736 1979(3)N
10 s
2004(.)Y
2842(An)X
2 f
2974(as)X
1 f
3092(is)X
3179(an)X
3289(abstraction)X
3675(that)X
3829(exists)X
555 2100(independent)N
973(of)X
1066(any)X
1208(of)X
1300(its)X
1400(uses.)X
1603(Just)X
1752(as)X
1844(several)X
9 s
2095(UNIX)X
10 s
2300(processes)X
2633(share)X
2828(the)X
2951(same)X
3141(kernel)X
3367(address)X
3633(space)X
3837(when)X
555 2196(operating)N
888(in)X
980(supervisor)X
1344(mode,)X
1572(an)X
2 f
1678(as)X
1 f
1792(can)X
1934(have)X
2115(multiple)X
2410(threads)X
2671(of)X
2767(control)X
3023(active)X
3244(in)X
3335(a)X
3400(user)X
3563(mode)X
3770(address)X
555 2292(space)N
755(at)X
834(the)X
953(same)X
1139(time.)X
1342(Future)X
1572(implementations)X
2126(of)X
2214(the)X
2333(operating)X
2657(system)X
2900(will)X
3045(take)X
3200(advantage)X
3547(of)X
3634(these)X
3819(facili-)X
555 2388(ties)N
686([5].)X
755 2512(Most)N
9 s
946(UNIX)X
10 s
1155(memory)X
1451(management)X
1890(system)X
2141(calls)X
2317(map)X
2484(cleanly)X
2745(to)X
2835(calls)X
3010(on)X
3118(the)X
2 f
3244(as)X
1 f
3356(layer.)X
3585(The)X
2 f
3738(as)X
1 f
3850(layer)X
555 2608(does)N
724(not)X
848(have)X
1022(knowledge)X
1396(of)X
1485(the)X
1604(implementation)X
2127(of)X
2215(the)X
2334(segment)X
2622(drivers)X
2866(below)X
3083(it,)X
3168(thus)X
3322(making)X
3583(it)X
3648(easy)X
3812(to)X
3895(add)X
555 2704(new)N
713(segment)X
1004(types)X
1197(to)X
1283(the)X
1405(system.)X
1691(The)X
2 f
1840(as)X
1 f
1948(design)X
2181(provides)X
2481(support)X
2745(for)X
2862(large)X
3046(sparse)X
3270(address)X
3534(spaces)X
3767(without)X
555 2800(undue)N
776(penalty)X
1037(for)X
1156(common)X
1461(cases,)X
1676(an)X
1777(important)X
2113(consideration)X
2570(for)X
2689(the)X
2812(future)X
3029(software)X
3331(demands)X
3641(that)X
3786(will)X
3935(be)X
555 2896(placed)N
785(on)X
885(the)X
1003(VM)X
1152(system.)X
3 f
555 3088(5.)N
655(Segments)X
1 f
755 3212(A)N
2 f
836(segment)X
1 f
1135(is)X
1211(a)X
1270(region)X
1497(of)X
1586(virtual)X
1817(memory)X
2106(mapped)X
2382(to)X
2466(a)X
2524(contiguous)X
2897(region)X
3124(of)X
3213(a)X
3271(memory)X
3560(object)X
8 s
3756 3187(4)N
10 s
3212(.)Y
3850(Each)X
555 3308(segment)N
845(contains)X
1135(some)X
1327(public)X
1550(and)X
1689(private)X
1935(data)X
2092(and)X
2231(is)X
2307(manipulated)X
2726(in)X
2811(an)X
2910(object-oriented)X
3419(fashion.)X
3717(The)X
3864(pub-)X
555 3404(lic)N
659(data)X
816(includes)X
1106(the)X
1227(base)X
1393(and)X
1532(size)X
1680(of)X
1770(the)X
1891(segment)X
2181(in)X
2266(page-aligned)X
2704(bytes,)X
2916(pointers)X
3197(for)X
3314(the)X
3435(next)X
3596(and)X
3735(previous)X
555 3500(segments)N
876(in)X
961(the)X
1082(address)X
1346(space,)X
1568(and)X
1707(a)X
1766(pointer)X
2016(to)X
2101(the)X
2 f
2222(as)X
1 f
2329(structure)X
2633(itself.)X
2856(Each)X
3040(segment)X
3330(also)X
3482(contains)X
3772(a)X
3831(refer-)X
555 3596(ence)N
725(to)X
809(a)X
867(vector)X
1090(of)X
1179(pointers)X
1458(to)X
1541(operations)X
1896(\(an)X
2020(``ops'')X
2260(vector\))X
2509(that)X
2650(implement)X
3013(a)X
3070(set)X
3180(of)X
3268(functions)X
3587(similar)X
3830(to)X
3913(the)X
2 f
555 3692(as)N
1 f
670(functions,)X
1019(and)X
1166(a)X
1233(pointer)X
1491(to)X
1584(a)X
1651(private)X
1905(per-segment)X
2333(type)X
2502(data)X
2667(structure.)X
3019(This)X
3192(is)X
3276(similar)X
3529(to)X
3621(the)X
3749(way)X
3913(the)X
555 3788(SunOS)N
2 f
805(vnode)X
1 f
1034(and)X
2 f
1174(vfs)X
1 f
1300(abstractions)X
1707(are)X
1830(implemented)X
2272([2].)X
2430(Using)X
2645(this)X
2784(style)X
2959(of)X
3050(interface)X
3356(allows)X
3588(multiple)X
3877(seg-)X
555 3884(ment)N
735(types)X
924(to)X
1006(be)X
1102(implemented)X
1540(without)X
1804(affecting)X
2110(the)X
2228(rest)X
2364(of)X
2451(the)X
2569(system.)X
755 4008(To)N
868(most)X
1047(ef\256ciently)X
1396(handle)X
1634(its)X
1733(data)X
1891(structures,)X
2247(a)X
2307(segment)X
2598(driver)X
2814(is)X
2891(free)X
3041(to)X
3126(coalesce)X
3422(adjacent)X
3713(segments)X
555 4104(of)N
644(the)X
764(same)X
951(type)X
1111(in)X
1195(the)X
1314(virtual)X
1544(address)X
1806(space)X
2006(or)X
2094(even)X
2267(to)X
2350(break)X
2550(a)X
2607(segment)X
2895(down)X
3094(into)X
3239(smaller)X
3496(segments.)X
3855(Indi-)X
555 4200(vidual)N
790(virtual)X
1034(pages)X
1252(within)X
1491(a)X
1562(segment's)X
1921(mappings)X
2266(may)X
2438(have)X
2624(varying)X
2903(attributes)X
3235(\(e.g.)X
3412(protections\).)X
3869(This)X
555 4296(design)N
784(allows)X
1013(the)X
1131(segment)X
1418(abstraction)X
1790(control)X
2037(over)X
2200(the)X
2318(attributes)X
2636(and)X
2772(data)X
2926(structures)X
3258(it)X
3322(manages.)X
755 4420(Of)N
867(equal)X
1068(importance)X
1456(to)X
1545(what)X
1728(a)X
1791(segment)X
2085(driver)X
2304(does)X
2478(is)X
2558(what)X
2740(it)X
2810(does)X
2983(not)X
3111(do.)X
3257(In)X
3350(particular,)X
3704(we)X
3824(found)X
555 4516(that)N
702(having)X
947(the)X
1072(segment)X
1366(driver)X
1585(handle)X
1826(the)X
1950(page)X
2128(lookup)X
2376(operation)X
2705(and)X
2847(call)X
2989(the)X
2 f
3113(vnode)X
1 f
3344(object)X
3566(manager)X
3869(only)X
555 4612(when)N
753(a)X
813(needed)X
1065(page)X
1241(cannot)X
1479(be)X
1579(found)X
1790(was)X
1939(a)X
1999(bad)X
2139(idea.)X
2337(After)X
2531(running)X
2804(into)X
2952(some)X
3145(problems)X
3466(that)X
3609(could)X
3810(not)X
3935(be)X
555 4708(solved)N
790(as)X
883(a)X
945(result)X
1149(of)X
1242(this)X
1383(split,)X
1566(we)X
1686(restructured)X
2096(the)X
2220(VM)X
2375(system)X
2623(so)X
2720(that)X
2866(the)X
2990(segment)X
3283(driver)X
3501(always)X
3750(asks)X
3913(the)X
555 4804(object)N
772(manager)X
1070(for)X
1185(the)X
1304(needed)X
1553(page)X
1726(on)X
1827(each)X
1996(fault.)X
2204(Having)X
2461(the)X
2 f
2580(vnode)X
1 f
2805(object)X
3021(manager)X
3318(be)X
3414(responsible)X
3799(for)X
3913(the)X
555 4900(page)N
727(lookup)X
969(operation)X
1292(allows)X
1521(it)X
1585(to)X
1667(take)X
1821(action)X
2037(on)X
2137(each)X
2305(new)X
2459 0.4028(reference.)AX
3 f
555 5092(5.1.)N
715(Segment)X
1029(Driver)X
1277(Types)X
1 f
755 5216(The)N
900(implementation)X
1422(includes)X
1709(the)X
1827(following)X
2158(segment)X
2445(driver)X
2657(types:)X
3 f
755 5340(seg_vn)N
1 f
1235(Mappings)X
1575(to)X
1657(regular)X
1905(\256les)X
2058(and)X
2194(anonymous)X
2583(memory.)X
8 s
10 f
555 5476(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5551(3)N
8 s
691 5570(Some)N
853(processes)X
1113(run)X
1214(entirely)X
1425(in)X
1491(the)X
1585(kernel)X
1760(and)X
1868(have)X
2004(no)X
2084(need)X
2220(for)X
2310(a)X
2354(user)X
2476(mode)X
2634(address)X
2841(space.)X
6 s
635 5645(4)N
8 s
691 5664(Note)N
831(that)X
943(the)X
1037(name)X
1191(``segment'')X
1504(is)X
1563(not)X
1661(related)X
1850(to)X
1916(traditional)X
7 s
2193(UNIX)X
8 s
2348(text,)X
2476(data,)X
2614(and)X
2722(stack)X
2869(segments.)X
10 s
2263 6144(4)N

5 p
%%Page: 5 5
10 s 0 xH 0 xS 1 f
3 f
755 672(seg_map)N
1 f
1235(Kernel)X
1474(only)X
1636(transient)X
1932(<)X
2 f
1977(vnode)X
1 f
2169(,)X
2209(offset>)X
2457(translation)X
2815(cache.)X
3 f
755 796(seg_dev)N
1 f
1235(Mappings)X
1575(to)X
1657(character)X
1973(special)X
2216(\256les)X
2369(for)X
2483(devices)X
2744(\(e.g.)X
2907(frame)X
3115(buffers\).)X
3 f
755 920(seg_kmem)N
1 f
1235(Kernel)X
1474(only)X
1636(driver)X
1848(used)X
2015(for)X
2129(miscellaneous)X
2603(mappings.)X
755 1044(The)N
905(seg_vn)X
1157(and)X
1298(seg_map)X
1608(segment)X
1900(drivers)X
2148(manage)X
2423(access)X
2653(to)X
2 f
2739(vnode)X
1 f
2968(memory)X
3259(objects)X
3510(and)X
3650(are)X
3773(the)X
3895(pri-)X
555 1140(mary)N
740(segment)X
1027(drivers.)X
3 f
555 1332(5.2.)N
4 f
715(vnode)X
3 f
931(Segment)X
1 f
755 1456(The)N
3 f
910(seg_vn)X
2 f
1171(vnode)X
1 f
1406(segment)X
1703(driver)X
1925(provides)X
2231(mappings)X
2572(to)X
2664(regular)X
2922(\256les.)X
3125(It)X
3204(is)X
3287(the)X
3415(most)X
3599(heavily)X
3864(used)X
555 1552(segment)N
842(driver)X
1054(in)X
1136(the)X
1254(system.)X
755 1676(The)N
907(arguments)X
1268(to)X
1357(the)X
1482(segment)X
1776(create)X
1996(function)X
2290(include)X
2553(the)X
2 f
2678(vnode)X
1 f
2910(being)X
3115(mapped,)X
3416(the)X
3541(starting)X
3808(offset,)X
555 1772(the)N
675(mapping)X
977(type,)X
1157(the)X
1277(current)X
1527(page)X
1701(protections,)X
2099(and)X
2237(the)X
2357(maximum)X
2703(page)X
2876(protections.)X
3293(The)X
3439(mapping)X
3740(type)X
3899(can)X
555 1868(be)N
662(shared)X
903(or)X
1001(private)X
1255(\(copy-on-write\).)X
1835(With)X
2026(a)X
2093(shared)X
2334(mapping,)X
2665(a)X
2732(successful)X
3093(memory)X
3390(write)X
3585(access)X
3821(to)X
3913(the)X
555 1964(mapped)N
834(region)X
1064(will)X
1213(cause)X
1417(the)X
1540(underlying)X
1912(\256le)X
2039(object)X
2260(to)X
2347(be)X
2448(changed.)X
2781(With)X
2965(a)X
3025(private)X
3272(mapping)X
3576(the)X
3698(\256rst)X
3846(write)X
555 2060(access)N
784(to)X
869(a)X
928(page)X
1103(of)X
1193(the)X
1314(mapped)X
1591(region)X
1819(will)X
1966(cause)X
2168(a)X
2227(copy-on-write)X
2705(operation)X
3030(that)X
3172(creates)X
3418(a)X
3476(private)X
3721(page)X
3895(and)X
555 2156(initializes)N
886(it)X
950(to)X
1032(a)X
1088(copy)X
1264(of)X
1351(the)X
1469(original)X
1738(page.)X
755 2280(The)N
9 s
906(UNIX)X
2 f
10 s
1114(mmap)X
1 f
1323(\(2\))X
1445(system)X
1695(call,)X
1859(which)X
2083(sets)X
2231(up)X
2339(new)X
2501(mappings)X
2840(in)X
2930(the)X
3056(process's)X
3383(user)X
3544(address)X
3812(space,)X
555 2376(calculates)N
898(the)X
1022(maximum)X
1372(page)X
1550(protection)X
1901(value)X
2101(for)X
2221(a)X
2282(shared)X
2517(mapping)X
2822(based)X
3030(on)X
3135(the)X
3258(permissions)X
3665(granted)X
3931(on)X
555 2472(the)N
2 f
674(open)X
1 f
864(of)X
952(the)X
1071(\256le.)X
1234(Thus,)X
1435(the)X
2 f
1554(vnode)X
1 f
1780(segment)X
2068(driver)X
2281(will)X
2426(not)X
2548(allow)X
2746(a)X
2802(\256le)X
2924(to)X
3006(be)X
3102(modi\256ed)X
3406(through)X
3675(a)X
3731(mapping)X
555 2568(if)N
624(the)X
742(\256le)X
864(was)X
1009(originally)X
1340(opened)X
1592(read-only.)X
3 f
555 2760(5.2.1.)N
775(Anonymous)X
1203(Memory)X
1 f
755 2884(An)N
876(important)X
1210(aspect)X
1434(of)X
1524(the)X
1645(VM)X
1797(system)X
2042(is)X
2118(the)X
2238(management)X
2670(of)X
2759(``anonymous'')X
3258(pages)X
3463(that)X
3605(have)X
3779(no)X
3881(per-)X
555 2980(manent)N
813(backing)X
1089(store.)X
1307(An)X
1427(anonymous)X
1818(page)X
1992(is)X
2066(created)X
2320(for)X
2435(each)X
2604(copy-on-write)X
3080(operation)X
3404(and)X
3541(for)X
3656(each)X
3825(initial)X
555 3076(fault)N
725(to)X
810(the)X
931(anonymous)X
1323(clone)X
1520(object)X
8 s
1716 3051(5)N
10 s
3076(.)Y
1810(For)X
1943(a)X
9 s
1999(UNIX)X
10 s
2201(executable,)X
2587(the)X
2707(uninitialized)X
3129(data)X
3285(and)X
3423(stack)X
3610(are)X
3731(set)X
3842(up)X
3944(as)X
555 3172(private)N
798(mappings)X
1129(to)X
1211(the)X
1329(anonymous)X
1718(clone)X
1912(object.)X
755 3296(The)N
904(mechanism)X
1293(used)X
1463(to)X
1548(manage)X
1821(anonymous)X
2213(pages)X
2419(has)X
2549(been)X
2724(isolated)X
2996(to)X
3081(a)X
3140(set)X
3252(of)X
3342(routines)X
3623(that)X
3766(provide)X
555 3392(a)N
619(service)X
875(to)X
965(the)X
1091(rest)X
1235(of)X
1330(the)X
1456(VM)X
1613(system.)X
1903(Segment)X
2211(drivers)X
2461(that)X
2608(choose)X
2858(to)X
2947(implement)X
3316(private)X
3566(mappings)X
3904(use)X
555 3488(this)N
690(service.)X
978(The)X
2 f
1123(vnode)X
1 f
1348(segment)X
1635(driver)X
1847(is)X
1920(the)X
2038(primary)X
2312(user)X
2466(of)X
2553(anonymous)X
2942(memory)X
3229(objects.)X
3 f
555 3680(5.2.1.1.)N
835(Anonymous)X
1263(Memory)X
1578(Data)X
1763(Structures)X
1 f
755 3804(The)N
2 f
910(anon)X
1 f
1113(structure)X
1424(serves)X
1655(as)X
1752(a)X
1818(name)X
2022(for)X
2146(each)X
2324(active)X
2546(anonymous)X
2945(page)X
3127(of)X
3223(memory.)X
3559(This)X
3730(structure)X
555 3900(introduces)N
933(a)X
1013(level)X
1213(of)X
1324(indirection)X
1715(for)X
1853(access)X
2103(to)X
2209(anonymous)X
2622(pages.)X
2889(We)X
3045(do)X
3168(not)X
3313(wish)X
3507(to)X
3612(assume)X
3891(that)X
555 3996(anonymous)N
953(pages)X
1165(can)X
1306(be)X
1411(named)X
1654(by)X
1763(their)X
1939(position)X
2225(in)X
2316(a)X
2381(storage)X
2642(device,)X
2901(since)X
3095(we)X
3217(would)X
3445(like)X
3593(to)X
3683(be)X
3787(able)X
3949(to)X
555 4092(have)N
739(anonymous)X
1140(pages)X
1355(in)X
1449(memory)X
1748(that)X
1899(haven't)X
2171(been)X
2354(allocated)X
2675(swap)X
2871(space.)X
3121(The)X
2 f
3277(anon)X
1 f
3481(data)X
3646(structure)X
3958(is)X
555 4188(opaque)N
813(above)X
1031(the)X
1155(anonymous)X
1550(memory)X
1843(service)X
2097(routines)X
2381(and)X
2523(is)X
2602(operated)X
2905(on)X
3011(using)X
3210(a)X
3272(procedural)X
3642(interface)X
3949(in)X
555 4284(an)N
659(object-oriented)X
1173(fashion.)X
1477(These)X
1697(objects)X
1952(are)X
2079 0.4531(reference)AX
2408(counted,)X
2709(since)X
2901(there)X
3089(can)X
3228(be)X
3331(more)X
3523(than)X
3688(one)X
3831(refer-)X
555 4380(ence)N
724(to)X
807(an)X
904(anonymous)X
1294(page)X
8 s
1446 4355(6)N
10 s
4380(.)Y
1539(This)X
1702 0.4531(reference)AX
2024(counting)X
2325(allows)X
2555(the)X
2 f
2674(anon)X
1 f
2867(procedures)X
3240(to)X
3322(easily)X
3529(detect)X
3741(when)X
3935(an)X
555 4476(anonymous)N
944(page)X
1116(and)X
1252(corresponding)X
1731(resident)X
2005(physical)X
2292(page)X
2464(\(if)X
2560(any\))X
2723(are)X
2842(no)X
2942(longer)X
3167(needed.)X
755 4600(The)N
916(other)X
1116(data)X
1285(structure)X
1601(related)X
1855(to)X
1952(anonymous)X
2356(memory)X
2658(management)X
3103(is)X
3191(the)X
2 f
3324(anon_map)X
1 f
3710(structure.)X
555 4696(This)N
725(structure)X
1034(describes)X
1361(a)X
1425(cluster)X
1667(of)X
1762(anonymous)X
2159(pages)X
2370(as)X
2465(a)X
2529(unit.)X
2721(The)X
2 f
2874(anon_map)X
1 f
3253(structure)X
3561(consists)X
3841(of)X
3935(an)X
555 4792(array)N
751(of)X
2 f
848(anon)X
1 f
1051(structure)X
1362(pointers)X
1650(with)X
1822(one)X
2 f
1968(anon)X
1 f
2171(pointer)X
2428(per)X
2561(page.)X
2783(Segment)X
3093(drivers)X
3346(that)X
3496(wish)X
3676(to)X
3767(refer)X
3949(to)X
555 4888(anonymous)N
945(pages)X
1149(do)X
1250(so)X
1342(by)X
1443(using)X
1637(an)X
2 f
1734(anon_map)X
1 f
2106(structure)X
2408(to)X
2491(keep)X
2663(an)X
2759(array)X
2945(of)X
3032(pointers)X
3310(to)X
2 f
3392(anon)X
1 f
3585(structures)X
3917(for)X
555 4984(the)N
686(anonymous)X
1088(pages.)X
1344(These)X
1568(segment)X
1867(drivers)X
2122(lazily)X
2332(allocate)X
2614(an)X
2 f
2722(anon_map)X
1 f
3105(structure)X
3418(with)X
3592(NULL)X
2 f
3838(anon)X
1 f
555 5080(structure)N
857(pointers)X
1136(at)X
1215(fault)X
1383(time)X
1546(as)X
1634(needed)X
1883(\(i.e.,)X
2049(on)X
2150(the)X
2269(\256rst)X
2414(copy-on-write)X
2890(for)X
3005(the)X
3124(segment)X
3412(or)X
3500(on)X
3601(the)X
3720(\256rst)X
3864(fault)X
555 5176(for)N
669(an)X
765(all)X
865(anonymous)X
1254(mapping\).)X
8 s
10 f
555 5476(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5551(5)N
8 s
691 5570(The)N
806(name)X
960(of)X
1029(this)X
1138(object)X
1310(in)X
1376(the)X
7 s
1468(UNIX)X
8 s
1623(\256le)X
1721(system)X
1915(name)X
2069(space)X
2226(is)X
3 f
2285(/dev/zero)X
1 f
2533(.)X
6 s
635 5645(6)N
8 s
691 5664(Typically)N
952(from)X
1092(an)X
1168(address)X
1375(space)X
1532(duplication)X
1836(resulting)X
2076(from)X
2216(a)X
7 s
2258(UNIX)X
2 f
8 s
2413(fork)X
1 f
2527(\(2\))X
2617(system)X
2811(call.)X
10 s
2263 6144(5)N

6 p
%%Page: 6 6
10 s 0 xH 0 xS 1 f
3 f
555 672(5.2.1.2.)N
835(Anonymous)X
1263(Memory)X
1578(Procedures)X
1 f
755 796(There)N
987(are)X
1130(two)X
2 f
1294(anon)X
1 f
1511(procedures)X
1908(that)X
2072(operate)X
2353(on)X
2476(the)X
2617(arrays)X
2857(of)X
2 f
2967(anon)X
1 f
3183(structure)X
3507(pointers)X
3808(in)X
3913(the)X
2 f
555 892(anon_map)N
1 f
937(structure.)X
2 f
1289(anon_dup)X
1 f
1622(\(\))X
1707(copies)X
1943(from)X
2129(one)X
2 f
2275(anon)X
1 f
2478(pointer)X
2735(array)X
2931(to)X
3023(another)X
3294(one,)X
3460(incrementing)X
3913(the)X
555 988 0.4531(reference)AN
879(count)X
1080(on)X
1183(every)X
1385(allocated)X
2 f
1698(anon)X
1 f
1894(structure.)X
2238(This)X
2403(operation)X
2729(is)X
2805(used)X
2975(when)X
3172(a)X
3231(private)X
3477(mapping)X
3780(involv-)X
555 1084(ing)N
681(anonymous)X
1074(memory)X
1364(is)X
1440(duplicated.)X
1837(The)X
1985(converse)X
2294(of)X
2 f
2384(anon_dup)X
1 f
2717(\(\))X
2794(is)X
2 f
2870(anon_free)X
1 f
3208(\(\),)X
3305(which)X
3524(decrements)X
3913(the)X
555 1180 0.4531(reference)AN
884(count)X
1090(on)X
1198(every)X
1405(allocated)X
2 f
1723(anon)X
1 f
1924(structure.)X
2273(If)X
2355(a)X
2419 0.4531(reference)AX
2748(count)X
2954(goes)X
3129(to)X
3219(zero,)X
3405(the)X
2 f
3530(anon)X
1 f
3730(structure)X
555 1276(and)N
697(associated)X
1053(page)X
1231(are)X
1356(freed.)X
2 f
1588(anon_free)X
1 f
1926(\(\))X
2006(is)X
2085(used)X
2258(when)X
2458(part)X
2608(of)X
2700(a)X
2761(privately)X
3071(mapped)X
3350(anonymous)X
3744(memory)X
555 1372(object)N
771(is)X
844(unmapped.)X
755 1496(There)N
987(are)X
1130(three)X
2 f
1334(anon)X
1 f
1550(procedures)X
1946(used)X
2136(by)X
2259(the)X
2400(fault)X
2590(handlers)X
2905(for)X
3042(anonymous)X
3454(memory)X
3764(objects.)X
2 f
555 1592(anon_private)N
1 f
995(\(\))X
1075(allocates)X
1382(an)X
1484(anonymous)X
1878(page,)X
2075(initializing)X
2446(it)X
2515(to)X
2602(the)X
2725(contents)X
3017(of)X
3109(the)X
3232(previous)X
3533(page)X
3710(loaded)X
3949(in)X
555 1688(the)N
681(MMU.)X
2 f
949(anon_zero)X
1 f
1300(\(\))X
1381(is)X
1461(similar)X
1710(to)X
2 f
1799(anon_private)X
1 f
2239(\(\),)X
2340(but)X
2469(initializes)X
2807(the)X
2932(anonymous)X
3328(page)X
3507(to)X
3596(zeroes.)X
3869(This)X
555 1784(routine)N
810(exists)X
1020(as)X
1115(an)X
1219(optimization)X
1651(to)X
1741(avoid)X
1947(having)X
2193(to)X
2283(copy)X
2466(a)X
2529(page)X
2708(of)X
2802(zeroes)X
3035(with)X
2 f
3204(anon_private)X
1 f
3644(\(\).)X
3765(Finally,)X
2 f
555 1880(anon_getpage)N
1 f
1022(\(\))X
1096(retrieves)X
1393(an)X
1489(anonymous)X
1878(page)X
2050(given)X
2248(an)X
2 f
2344(anon)X
1 f
2537(structure)X
2838(pointer.)X
3 f
555 2072(5.2.2.)N
4 f
775(vnode)X
3 f
991(Segment)X
1305(Fault)X
1507(Handling)X
1 f
755 2196(Page)N
937(fault)X
1110(handling)X
1416(is)X
1495(a)X
1557(central)X
1802(part)X
1953(of)X
2046(the)X
2170(new)X
2330(VM)X
2485(system.)X
2773(The)X
2924(fault)X
3097(handling)X
3403(code)X
3581(resolves)X
3869(both)X
555 2292(hardware)N
888(faults)X
1099(\(e.g.,)X
1295(hardware)X
1627(translation)X
1997(not)X
2131(valid)X
2323(or)X
2422(protection)X
2779(violation\))X
3122(and)X
3270(software)X
3579(pseudo-faults)X
555 2388(\(e.g.,)N
742(lock)X
904(down)X
1106(pages\).)X
1380(The)X
2 f
1529(as)X
1 f
1637(fault)X
1808(handing)X
2090(routine)X
2341(is)X
2418(called)X
2634(with)X
2800(a)X
2860(virtual)X
3093(address)X
3358(range,)X
3581(the)X
3703(fault)X
3873(type)X
555 2484(\(e.g.,)N
741(invalid)X
986(translation)X
1347(or)X
1437(protection)X
1785(violation\),)X
2139(and)X
2277(the)X
2397(type)X
2557(of)X
2646(attempted)X
2984(access)X
3212(\(read,)X
3420(write,)X
3627(execute\).)X
3962(It)X
555 2580(performs)N
872(a)X
935(segment)X
1229(lookup)X
1478(operation)X
1808(based)X
2018(on)X
2125(the)X
2250(virtual)X
2486(address)X
2754(and)X
2896(dispatches)X
3256(to)X
3344(the)X
3468(segment)X
3761(driver's)X
555 2676(fault)N
722(routine,)X
989(which)X
1205(is)X
1278(responsible)X
1663(for)X
1777(resolving)X
2095(the)X
2213(fault.)X
755 2800(The)N
2 f
900(vnode)X
1 f
1125(segment)X
1412(driver)X
1624(takes)X
1809(the)X
1927(following)X
2258(steps)X
2438(to)X
2520(handle)X
2754(a)X
2810(fault.)X
10 f
755 2924(\267)N
1 f
955(Verify)X
1185(page)X
1357(protections.)X
10 f
755 3048(\267)N
1 f
955(If)X
1029(needed,)X
1297(allocate)X
1567(an)X
2 f
1663(anon_map)X
1 f
2034(structure.)X
10 f
755 3172(\267)N
1 f
955(If)X
1029(needed,)X
1297(get)X
1415(the)X
1533(page)X
1705(from)X
1881(the)X
1999(object)X
2215(manager.)X
955 3268(Call)N
1108(the)X
2 f
1226(hat)X
1 f
1361(layer)X
1542(to)X
1624(load)X
1782(a)X
1838(translation)X
2196(to)X
2278(the)X
2396(page.)X
10 f
755 3392(\267)N
1 f
955(If)X
1029(needed,)X
1297(obtain)X
1517(a)X
1573(new)X
1727(page)X
1899(by)X
1999(performing)X
2380(copy-on-write.)X
955 3488(Call)N
1108(the)X
2 f
1226(hat)X
1 f
1361(layer)X
1542(to)X
1624(load)X
1782(a)X
1838(writable)X
2121(translation)X
2479(to)X
2561(the)X
2679(new)X
2833(page.)X
755 3612(Some)N
964(speci\256c)X
1236(examples)X
1566(of)X
2 f
1660(vnode)X
1 f
1892(segment)X
2186(fault)X
2360(handling)X
2666(and)X
2808(how)X
2972(anonymous)X
3367(memory)X
3660(is)X
3739(used)X
3912(are)X
555 3708(given)N
753(below.)X
1131 4188 MXY
29 0 Dl
1183 MX
29 0 Dl
1235 MX
28 0 Dl
1286 MX
29 0 Dl
1338 MX
29 0 Dl
1390 MX
29 0 Dl
0 -29 Dl
4136 MY
0 -29 Dl
4084 MY
0 -29 Dl
4032 MY
0 -28 Dl
3981 MY
0 -29 Dl
3929 MY
0 -29 Dl
-29 0 Dl
1367 MX
-29 0 Dl
1315 MX
-29 0 Dl
1263 MX
-28 0 Dl
1212 MX
-29 0 Dl
1160 MX
-29 0 Dl
0 29 Dl
3952 MY
0 29 Dl
4004 MY
0 28 Dl
4055 MY
0 29 Dl
4107 MY
0 29 Dl
4159 MY
0 29 Dl
4476 MY
29 0 Dl
1183 MX
29 0 Dl
1235 MX
28 0 Dl
1286 MX
29 0 Dl
1338 MX
29 0 Dl
1390 MX
29 0 Dl
0 -29 Dl
4424 MY
0 -29 Dl
4372 MY
0 -29 Dl
4320 MY
0 -28 Dl
4269 MY
0 -29 Dl
4217 MY
0 -29 Dl
-29 0 Dl
1367 MX
-29 0 Dl
1315 MX
-29 0 Dl
1263 MX
-28 0 Dl
1212 MX
-29 0 Dl
1160 MX
-29 0 Dl
0 29 Dl
4240 MY
0 29 Dl
4292 MY
0 28 Dl
4343 MY
0 29 Dl
4395 MY
0 29 Dl
4447 MY
0 29 Dl
932 4540(\(As)N
1068(Yet)X
1204(Unallocated\))X
1012 4636(Segment)N
1312(Private)X
993 4732(Anon_map)N
1369(Array)X
793 3974(0x30000)N
793 4262(0x32000)N
3189 4060(<vp1,)N
3394(0x6000>)X
3147 4188 MXY
0 -288 Dl
575 0 Dl
0 288 Dl
-575 0 Dl
3189 4348(<vp1,)N
3394(0x8000>)X
3147 4476 MXY
0 -288 Dl
575 0 Dl
0 288 Dl
-575 0 Dl
3045 4636(Address)N
3328(Space)X
3540(Contents)X
958 4044 MXY
29 0 Dl
1016 MX
29 0 Dl
1075 MX
29 0 Dl
1133 MX
29 0 Dl
1192 MX
28 0 Dl
1250 MX
29 0 Dl
1308 MX
29 0 Dl
1367 MX
28 0 Dl
1425 MX
29 0 Dl
1483 MX
29 0 Dl
1542 MX
29 0 Dl
1600 MX
29 0 Dl
1659 MX
28 0 Dl
1717 MX
29 0 Dl
1775 MX
29 0 Dl
1834 MX
28 0 Dl
1892 MX
29 0 Dl
1950 MX
29 0 Dl
2009 MX
29 0 Dl
2067 MX
29 0 Dl
2125 MX
29 0 Dl
2184 MX
29 0 Dl
2242 MX
29 0 Dl
2301 MX
28 0 Dl
2359 MX
29 0 Dl
2417 MX
29 0 Dl
2476 MX
28 0 Dl
2534 MX
29 0 Dl
2592 MX
29 0 Dl
2651 MX
29 0 Dl
2709 MX
29 0 Dl
2768 MX
28 0 Dl
2826 MX
29 0 Dl
2884 MX
29 0 Dl
2943 MX
28 0 Dl
3001 MX
29 0 Dl
3059 MX
29 0 Dl
3118 MX
29 0 Dl
3089 4058 MXY
58 -14 Dl
3089 4030 MXY
58 14 Dl
958 4332 MXY
29 0 Dl
1016 MX
29 0 Dl
1075 MX
29 0 Dl
1133 MX
29 0 Dl
1192 MX
28 0 Dl
1250 MX
29 0 Dl
1308 MX
29 0 Dl
1367 MX
28 0 Dl
1425 MX
29 0 Dl
1483 MX
29 0 Dl
1542 MX
29 0 Dl
1600 MX
29 0 Dl
1659 MX
28 0 Dl
1717 MX
29 0 Dl
1775 MX
29 0 Dl
1834 MX
28 0 Dl
1892 MX
29 0 Dl
1950 MX
29 0 Dl
2009 MX
29 0 Dl
2067 MX
29 0 Dl
2125 MX
29 0 Dl
2184 MX
29 0 Dl
2242 MX
29 0 Dl
2301 MX
28 0 Dl
2359 MX
29 0 Dl
2417 MX
29 0 Dl
2476 MX
28 0 Dl
2534 MX
29 0 Dl
2592 MX
29 0 Dl
2651 MX
29 0 Dl
2709 MX
29 0 Dl
2768 MX
28 0 Dl
2826 MX
29 0 Dl
2884 MX
29 0 Dl
2943 MX
28 0 Dl
3001 MX
29 0 Dl
3059 MX
29 0 Dl
3118 MX
29 0 Dl
3089 4346 MXY
58 -14 Dl
3089 4318 MXY
58 14 Dl
3780 3974(0x30000)N
3780 4262(0x32000)N
3 f
2139 4860(Figure)N
2386(2)X
1149 4956(<vp1,)N
1359(6000>)X
1585(Mapped)X
1889(Private)X
2159(to)X
2246(Address)X
2546(0x30000)X
2846(for)X
2969(0x4000)X
3229(Bytes)X
1 f
755 5176(Figure)N
986(2)X
1048(depicts)X
1297(a)X
1355(private)X
1600(mapping)X
1901(from)X
2078(offset)X
2282(0x6000)X
2543(in)X
2 f
2626(vnode)X
1 f
2852(vp1)X
2993(to)X
3076(address)X
3338(0x30000)X
3639(for)X
3754(a)X
3811(length)X
555 5272(of)N
647(0x4000)X
912(bytes)X
1106(using)X
1304(a)X
1365(system)X
1612(page)X
1789(size)X
1939(of)X
2031(0x2000.)X
2336(If)X
2415(a)X
2475(non-write)X
2811(fault)X
2982(occurs)X
3216(on)X
3320(an)X
3420(address)X
3685(within)X
3913(the)X
555 5368(segment,)N
865(the)X
2 f
986(vnode)X
1 f
1214(segment)X
1504(driver)X
1719(asks)X
1880(the)X
2 f
2001(vnode)X
1 f
2229(object)X
2448(manager)X
2748(for)X
2865(the)X
2985(page)X
3159(named)X
3395(by)X
3497(<vp1,)X
3704(0x6000)X
3966(+)X
555 5464(\()N
2 f
582(addr)X
1 f
760(-)X
814(0x30000\)>.)X
1233(The)X
2 f
1385(vnode)X
1 f
1617(object)X
1840(manager)X
2144(is)X
2224(responsible)X
2616(for)X
2736(creating)X
3021(and)X
3163(initializing)X
3535(the)X
3659(page)X
3837(when)X
555 5560(requested)N
889(to)X
977(do)X
1083(so)X
1180(by)X
1286(a)X
1348(segment)X
1640(driver.)X
1897(After)X
2092(obtaining)X
2419(the)X
2542(page,)X
2739(the)X
2 f
2862(vnode)X
1 f
3092(segment)X
3384(driver)X
3601(calls)X
3773(the)X
2 f
3896(hat)X
1 f
555 5656(layer)N
743(to)X
832(load)X
997(a)X
1060(translation)X
1425(to)X
1514(the)X
1639(page.)X
1858(The)X
2010(permissions)X
2419(passed)X
2660(to)X
2749(the)X
2 f
2874(hat)X
1 f
3016(layer)X
3204(from)X
3387(the)X
2 f
3512(vnode)X
1 f
3744(segment)X
555 5752(driver)N
771(are)X
894(for)X
1012(a)X
1072(read-only)X
1404(translation)X
1765(since)X
1953(this)X
2091(is)X
2167(a)X
2226(private)X
2472(mapping)X
2775(for)X
2892(which)X
3111(we)X
3228(want)X
3407(to)X
3492(catch)X
3685(a)X
3744(memory)X
555 5848(write)N
740(operation)X
1063(to)X
1145(initiate)X
1387(a)X
1443(copy-on-write)X
1918(operation.)X
2263 6144(6)N

7 p
%%Page: 7 7
10 s 0 xH 0 xS 1 f
1131 960 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1248 MY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1012 1360(Segment)N
1312(Private)X
993 1456(Anon_map)N
1369(Array)X
793 746(0x30000)N
793 1034(0x32000)N
1131 960 MXY
288 288 Dl
960 MY
-288 288 Dl
2035 1072(ref)N
2145(cnt)X
2119 1168(1)N
1995 1248 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1275 1104 MXY
720 0 Dl
1937 1118 MXY
58 -14 Dl
1937 1090 MXY
58 14 Dl
2283 1248 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
960 MY
288 288 Dl
960 MY
-288 288 Dl
1998 1360(anon)N
2174(structure)X
2475(for)X
2054 1456(<anon)N
2275(page1>)X
3189 832(<vp1,)N
3394(0x6000>)X
3147 960 MXY
0 -288 Dl
575 0 Dl
0 288 Dl
-575 0 Dl
3205 1120(<anon)N
3426(page1>)X
3147 1248 MXY
0 -288 Dl
575 0 Dl
0 288 Dl
-575 0 Dl
3045 1408(Address)N
3328(Space)X
3540(Contents)X
2427 1104 MXY
720 0 Dl
3089 1118 MXY
58 -14 Dl
3089 1090 MXY
58 14 Dl
958 816 MXY
29 0 Dl
1016 MX
29 0 Dl
1075 MX
29 0 Dl
1133 MX
29 0 Dl
1192 MX
28 0 Dl
1250 MX
29 0 Dl
1308 MX
29 0 Dl
1367 MX
28 0 Dl
1425 MX
29 0 Dl
1483 MX
29 0 Dl
1542 MX
29 0 Dl
1600 MX
29 0 Dl
1659 MX
28 0 Dl
1717 MX
29 0 Dl
1775 MX
29 0 Dl
1834 MX
28 0 Dl
1892 MX
29 0 Dl
1950 MX
29 0 Dl
2009 MX
29 0 Dl
2067 MX
29 0 Dl
2125 MX
29 0 Dl
2184 MX
29 0 Dl
2242 MX
29 0 Dl
2301 MX
28 0 Dl
2359 MX
29 0 Dl
2417 MX
29 0 Dl
2476 MX
28 0 Dl
2534 MX
29 0 Dl
2592 MX
29 0 Dl
2651 MX
29 0 Dl
2709 MX
29 0 Dl
2768 MX
28 0 Dl
2826 MX
29 0 Dl
2884 MX
29 0 Dl
2943 MX
28 0 Dl
3001 MX
29 0 Dl
3059 MX
29 0 Dl
3118 MX
29 0 Dl
3089 830 MXY
58 -14 Dl
3089 802 MXY
58 14 Dl
3780 746(0x30000)N
3780 1034(0x32000)N
3 f
2139 1632(Figure)N
2386(3)X
1380 1728(After)N
1584(Copy-On-Write)X
2147(Operation)X
2518(to)X
2605(Address)X
2905(0x32000)X
1 f
755 1920(Figure)N
987(3)X
1050(shows)X
1273(the)X
1394(results)X
1626(of)X
1715(a)X
1773(copy-on-write)X
2250(operation)X
2575(on)X
2677(address)X
2940(0x32000)X
3242(in)X
3326(Figure)X
3557(2.)X
3659(The)X
2 f
3806(vnode)X
1 f
555 2016(segment)N
851(driver)X
1072(has)X
1208(allocated)X
1527(an)X
2 f
1632(anon_map)X
1 f
2012(structure)X
2322(and)X
2467(initialized)X
2816(the)X
2943(second)X
3195(entry)X
3388(to)X
3478(point)X
3670(to)X
3760(an)X
3864(allo-)X
555 2112(cated)N
2 f
751(anon)X
1 f
949(structure)X
1255(that)X
1400(initially)X
1673(has)X
1805(a)X
1866 0.4531(reference)AX
2192(count)X
2395(of)X
2487(one.)X
2668(The)X
2 f
2818(anon_private)X
1 f
3258(\(\))X
3337(routine)X
3589(has)X
3721(allocated)X
555 2208(the)N
2 f
680(anon)X
1 f
880(structure)X
1188(in)X
1277(the)X
1402(array,)X
1615(returned)X
1910(a)X
1972(page)X
2150(named)X
2390(by)X
2496(that)X
2 f
2642(anon)X
1 f
2841(structure,)X
3168(and)X
3310(initialized)X
3656(to)X
3744(the)X
3868(con-)X
555 2304(tents)N
730(of)X
821(the)X
943(previous)X
1243(page)X
1419(at)X
1500(0x32000.)X
1843(After)X
2036(getting)X
2281(the)X
2402(anonymous)X
2794(page)X
2969(from)X
2 f
3148(anon_private)X
1 f
3588(\(\),)X
3685(the)X
2 f
3806(vnode)X
1 f
555 2400(segment)N
842(driver)X
1054(calls)X
1221(the)X
2 f
1339(hat)X
1 f
1474(layer)X
1655(to)X
1737(load)X
1895(a)X
1951(writable)X
2234(translation)X
2592(to)X
2674(the)X
2792(newly)X
3008(allocated)X
3318(and)X
3454(initialized)X
3794(page.)X
755 2524(Note)N
933(that)X
1075(as)X
1164(an)X
1262(optimization,)X
1708(the)X
2 f
1828(vnode)X
1 f
2055(segment)X
2344(driver)X
2558(is)X
2633(able)X
2789(to)X
2873(perform)X
3154(a)X
3212(copy-on-write)X
3688(operation,)X
555 2620(even)N
732(if)X
805(the)X
927(original)X
1200(translation)X
1562(was)X
1711(invalid,)X
1977(since)X
2166(the)X
2288(fault)X
2459(handler)X
2724(gets)X
2877(a)X
2937(fault)X
3108(type)X
3270(parameter)X
3616(\(read,)X
3826(write,)X
555 2716(execute\).)N
895(If)X
976(the)X
1101(\256rst)X
1252(fault)X
1426(taken)X
1627(in)X
1716(the)X
2 f
1841(segment)X
1 f
2144(described)X
2479(in)X
2568(Figure)X
2804(3)X
2871(is)X
2951(a)X
3014(write)X
3206(fault)X
3380(at)X
3464(address)X
3731(0x32000)X
555 2812(then)N
719(the)X
843(\256rst)X
993(operation)X
1322(is)X
1401(to)X
1489(obtain)X
1715(the)X
1839(page)X
2017(for)X
2137(<vp1,)X
2348(0x8000>)X
2659(and)X
2801(call)X
2943(the)X
2 f
3066(hat)X
1 f
3206(layer)X
3392(to)X
3479(load)X
3642(a)X
3703(read-only)X
555 2908(translation.)N
967(The)X
2 f
1126(vnode)X
1 f
1365(segment)X
1666(driver)X
1892(can)X
2038(then)X
2210(detect)X
2436(that)X
2590(it)X
2668(still)X
2821(needs)X
3038(to)X
3133(perform)X
3425(the)X
3556(copy-on-write)X
555 3004(operation)N
892(because)X
1181(the)X
1313(fault)X
1494(type)X
1666(was)X
1825(for)X
1953(a)X
2023(write)X
2222(access.)X
2502(If)X
2590(the)X
2722(copy-on-write)X
3210(operation)X
3546(is)X
3632(needed,)X
3913(the)X
2 f
555 3100(vnode)N
1 f
780(segment)X
1067(driver)X
1279(will)X
1423(call)X
2 f
1559(anon_private)X
1 f
1999(\(\))X
2073(to)X
2155(create)X
2368(a)X
2424(private)X
2667(copy)X
2843(of)X
2930(the)X
3048(page.)X
1226 3356(NULL)N
1189 3484 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
3772 MY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1070 3884(Segment)N
1370(Private)X
1051 3980(Anon_map)N
1427(Array)X
1189 3484 MXY
288 288 Dl
3484 MY
-288 288 Dl
851 3270(0x34000)N
851 3558(0x36000)N
2093 3596(ref)N
2203(cnt)X
2177 3692(1)N
2053 3772 MXY
0 -288 Dl
287 0 Dl
0 288 Dl
-287 0 Dl
1333 3628 MXY
720 0 Dl
1995 3642 MXY
58 -14 Dl
1995 3614 MXY
58 14 Dl
2340 3772 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
3484 MY
288 288 Dl
3484 MY
-288 288 Dl
2055 3884(anon)N
2231(structure)X
2532(for)X
2111 3980(<anon)N
2332(page2>)X
3438 3356(???)N
3204 3484 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3263 3644(<anon)N
3484(page2>)X
3204 3772 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3103 3932(Address)N
3386(Space)X
3598(Contents)X
2484 3628 MXY
720 0 Dl
3147 3642 MXY
57 -14 Dl
3147 3614 MXY
57 14 Dl
3838 3270(0x34000)N
3838 3558(0x36000)N
3 f
2139 4156(Figure)N
2386(4)X
1149 4252(Private)N
1419(Mapping)X
1749(to)X
1836(/dev/zero)X
2168(for)X
2291(0x4000)X
2551(bytes)X
2749(at)X
2836(Address)X
3136(0x34000)X
1624 4348(After)N
1828(a)X
1888(Page)X
2073(Fault)X
2275(at)X
2362(Address)X
2662(0x36000)X
1 f
755 4568(Figure)N
989(4)X
1054(depicts)X
1306(a)X
1366(private)X
1613(mapping)X
1917(from)X
2097(the)X
2219(anonymous)X
2612(clone)X
2810(device)X
3 f
3044(/dev/zero)X
1 f
3380(to)X
3466(address)X
3731(0x34000)X
555 4664(for)N
670(length)X
891(0x4000)X
1152(after)X
1321(a)X
1378(page)X
1551(fault)X
1719(at)X
1798(address)X
2060(0x36000.)X
2401(Since)X
2599(there)X
2780(is)X
2853(no)X
2953(primary)X
2 f
3227(vnode)X
1 f
3452(that)X
3592(was)X
3737(mapped,)X
555 4760(the)N
2 f
677(vnode)X
1 f
905(segment)X
1195(driver)X
1410(calls)X
2 f
1580(anon_zero)X
1 f
1931(\(\))X
2008(to)X
2093(allocate)X
2366(an)X
2 f
2465(anon)X
1 f
2661(structure)X
2965(and)X
3104(corresponding)X
3586(page)X
3761(and)X
3900(ini-)X
555 4856(tialize)N
771(the)X
889(page)X
1061(to)X
1143(zeroes.)X
755 4980(Figure)N
990(5)X
1056(shows)X
1282(what)X
1463(happens)X
1751(when)X
1950(the)X
2073(mapped)X
2352(private)X
2 f
2600(vnode)X
1 f
2830(segment)X
3122(shown)X
3356(in)X
3443(Figure)X
3677(4)X
3742(is)X
3820(dupli-)X
555 5076(cated.)N
793(Here)X
978(both)X
1148(segments)X
1474(have)X
1654(a)X
1718(private)X
1969 0.4531(reference)AX
2298(to)X
2388(the)X
2513(same)X
2705(anonymous)X
3101(page.)X
3320(When)X
3539(the)X
3664(segment)X
3958(is)X
555 5172(duplicated,)N
2 f
943(anon_dup)X
1 f
1276(\(\))X
1364(is)X
1450(called)X
1675(to)X
1770(increment)X
2124(the)X
2255 0.4531(reference)AX
2589(count)X
2800(on)X
2913(all)X
3026(the)X
3157(segment's)X
3515(allocated)X
2 f
3838(anon)X
1 f
555 5268(structures.)N
938(In)X
1036(this)X
1182(example,)X
1505(there)X
1697(is)X
1780(only)X
1952(one)X
2098(allocated)X
2 f
2418(anon)X
1 f
2621(structure)X
2932(and)X
3078(its)X
3183 0.4531(reference)AX
3514(count)X
3722(has)X
3859(been)X
555 5364(incremented)N
987(from)X
1178(one)X
1329(to)X
1426(two.)X
1621(Also,)X
1826(as)X
1927(part)X
2086(of)X
2187(the)X
2 f
2319(vnode)X
1 f
2558(segment)X
2859(duplication)X
3253(process)X
3528(for)X
3656(a)X
3726(privately)X
555 5460(mapped)N
856(segment,)X
1190(all)X
1317(the)X
2 f
1462(hat)X
1 f
1623(translations)X
2038(are)X
2183(changed)X
2497(to)X
2605(be)X
2727(read-only)X
3081(so)X
3198(that)X
3364(previously)X
3748(writable)X
555 5556(anonymous)N
944(pages)X
1147(are)X
1266(now)X
1424(set)X
1533(up)X
1633(for)X
1747(copy-on-write.)X
755 5680(Figure)N
993(6)X
1062(shows)X
1291(the)X
1418(result)X
1625(after)X
1801(the)X
1927(duplicated)X
2289(segment)X
2584(in)X
2674(Figure)X
2911(5)X
2979(handles)X
3252(a)X
3316(write)X
3509(fault)X
3684(at)X
3770(address)X
555 5776(0x36000.)N
907(When)X
1131(the)X
1261(segment)X
1560(fault)X
1739(handler)X
2012(calls)X
2 f
2191(anon_getpage)X
1 f
2658(\(\))X
2744(to)X
2838(return)X
3062(the)X
3192(page)X
3375(for)X
3500(the)X
3629(given)X
2 f
3838(anon)X
1 f
2263 6144(7)N

8 p
%%Page: 8 8
10 s 0 xH 0 xS 1 f
1226 832(NULL)N
1189 960 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1248 MY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1163 1408(Segment)N
1463(1)X
1226 1696(NULL)N
1189 1824 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
2112 MY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1163 2272(Segment)N
1463(2)X
1070 2512(Segment)N
1370(Private)X
1051 2608(Anon_map)N
1427(Array)X
851 746(0x34000)N
851 1034(0x36000)N
851 1610(0x34000)N
851 1898(0x36000)N
1189 960 MXY
288 288 Dl
960 MY
-288 288 Dl
1824 MY
288 288 Dl
1824 MY
-288 288 Dl
2093 1072(ref)N
2203(cnt)X
2177 1168(2)N
2053 1248 MXY
0 -288 Dl
287 0 Dl
0 288 Dl
-287 0 Dl
1333 1104 MXY
720 0 Dl
1995 1118 MXY
58 -14 Dl
1995 1090 MXY
58 14 Dl
1333 1968 MXY
720 -864 Dl
2027 1157 MXY
26 -53 Dl
2005 1139 MXY
48 -35 Dl
2340 1248 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
960 MY
288 288 Dl
960 MY
-288 288 Dl
2055 1360(anon)N
2231(structure)X
2532(for)X
2111 1456(<anon)N
2332(page2>)X
3438 832(???)N
3204 960 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3263 1120(<anon)N
3484(page2>)X
3204 1248 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3225 1408(Address)N
3508(Space)X
3720(1)X
3438 1696(???)N
3204 1824 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3263 1984(<anon)N
3484(page2>)X
3204 2112 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3225 2272(Address)N
3508(Space)X
3720(2)X
3103 2560(Address)N
3386(Space)X
3598(Contents)X
2484 1104 MXY
720 0 Dl
3147 1118 MXY
57 -14 Dl
3147 1090 MXY
57 14 Dl
2484 MX
720 864 Dl
3157 1933 MXY
47 35 Dl
3179 1914 MXY
25 54 Dl
3838 746(0x34000)N
3838 1034(0x36000)N
3838 1610(0x34000)N
3838 1898(0x36000)N
3 f
2139 2784(Figure)N
2386(5)X
1329 2880(After)N
1533(the)X
1660(Private)X
1930(Mapped)X
2234(Vnode)X
2476(Segment)X
2790(is)X
2863(Duplicated)X
1 f
1226 3232(NULL)N
1189 3360 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
3648 MY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1163 3808(Segment)N
1463(1)X
1226 4096(NULL)N
1189 4224 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
4512 MY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
1163 4672(Segment)N
1463(2)X
1070 4912(Segment)N
1370(Private)X
1051 5008(Anon_map)N
1427(Array)X
851 3146(0x34000)N
851 3434(0x36000)N
851 4010(0x34000)N
851 4298(0x36000)N
1189 3360 MXY
288 288 Dl
3360 MY
-288 288 Dl
4224 MY
288 288 Dl
4224 MY
-288 288 Dl
2093 3472(ref)N
2203(cnt)X
2177 3568(1)N
2053 3648 MXY
0 -288 Dl
287 0 Dl
0 288 Dl
-287 0 Dl
2093 4336(ref)N
2203(cnt)X
2177 4432(1)N
2053 4512 MXY
0 -288 Dl
287 0 Dl
0 288 Dl
-287 0 Dl
1333 3504 MXY
720 0 Dl
1995 3518 MXY
58 -14 Dl
1995 3490 MXY
58 14 Dl
1333 4368 MXY
720 0 Dl
1995 4382 MXY
58 -14 Dl
1995 4354 MXY
58 14 Dl
2340 3648 MXY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
4512 MY
0 -288 Dl
288 0 Dl
0 288 Dl
-288 0 Dl
3360 MY
288 288 Dl
3360 MY
-288 288 Dl
4224 MY
288 288 Dl
4224 MY
-288 288 Dl
2055 3760(anon)N
2231(structure)X
2532(for)X
2111 3856(<anon)N
2332(page2>)X
2055 4624(anon)N
2231(structure)X
2532(for)X
2111 4720(<anon)N
2332(page3>)X
3438 3232(???)N
3204 3360 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3263 3520(<anon)N
3484(page2>)X
3204 3648 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3225 3808(Address)N
3508(Space)X
3720(1)X
3438 4096(???)N
3204 4224 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3263 4384(<anon)N
3484(page3>)X
3204 4512 MXY
0 -288 Dl
576 0 Dl
0 288 Dl
-576 0 Dl
3225 4672(Address)N
3508(Space)X
3720(2)X
3103 4960(Address)N
3386(Space)X
3598(Contents)X
2484 3504 MXY
720 0 Dl
3147 3518 MXY
57 -14 Dl
3147 3490 MXY
57 14 Dl
2484 4368 MXY
720 0 Dl
3147 4382 MXY
57 -14 Dl
3147 4354 MXY
57 14 Dl
3838 3146(0x34000)N
3838 3434(0x36000)N
3838 4010(0x34000)N
3838 4298(0x36000)N
3 f
2139 5184(Figure)N
2386(6)X
1294 5280(After)N
1498(Write)X
1719(Fault)X
1921(on)X
2025(Address)X
2325(0x36000)X
2625(in)X
2711(Address)X
3011(Space)X
3231(2)X
1 f
555 5472(structure,)N
880(it)X
948(will)X
1096(return)X
1312(protections)X
1692(that)X
1836(force)X
2026(a)X
2086(read-only)X
2418(translation)X
2780(since)X
2968(the)X
3089 0.4531(reference)AX
3413(count)X
3614(on)X
3717(the)X
2 f
3838(anon)X
1 f
555 5568(structure)N
862(is)X
941(greater)X
1191(than)X
1355(one.)X
1537(The)X
1688(segment)X
1981(driver)X
2199(fault)X
2372(handler)X
2639(will)X
2789(then)X
2953(call)X
2 f
3094(anon_private)X
1 f
3534(\(\))X
3613(to)X
3700(allocate)X
3975(a)X
555 5664(new)N
2 f
709(anon)X
1 f
902(structure)X
1203(and)X
2 f
1339(page)X
1 f
1528(structure)X
1829(and)X
1965(to)X
2047(initialize)X
2347(the)X
2465(page)X
2637(to)X
2719(the)X
2837(contents)X
3124(of)X
3211(the)X
3329(previous)X
3625(page)X
3797(loaded)X
555 5760(in)N
657(the)X
795(MMU.)X
1075(In)X
1182(contrast)X
1476(to)X
1578(the)X
1716(case)X
1894(depicted)X
2205(in)X
2306(Figure)X
2554(3,)X
2 f
2653(anon_private)X
1 f
3093(\(\))X
3186(is)X
3278(copying)X
3575(from)X
3770(another)X
2263 6144(8)N

9 p
%%Page: 9 9
10 s 0 xH 0 xS 1 f
555 672(anonymous)N
945(page)X
1118(and)X
1255(will)X
1400(decrement)X
1756(the)X
1875 0.4531(reference)AX
2197(count)X
2396(of)X
2484(the)X
2603(old)X
2 f
2726(anon)X
1 f
2920(structure)X
3222(after)X
3391(the)X
2 f
3509(anon)X
1 f
3702(pointer)X
3949(in)X
555 768(the)N
677(segment's)X
2 f
1026(anon_map)X
1 f
1401(array)X
1591(is)X
1668(changed)X
1959(to)X
2044(point)X
2231(to)X
2316(the)X
2437(newly)X
2656(allocated)X
2 f
2969(anon)X
1 f
3165(structure.)X
3509(Since)X
3710(the)X
3831(refer-)X
555 864(ence)N
724(count)X
923(on)X
1024(the)X
1143(original)X
2 f
1413(anon)X
1 f
1607(structure)X
1909(reverts)X
2149(to)X
2232(one,)X
2388(this)X
2523(means)X
2748(that)X
2888(the)X
3006(original)X
3275(segment)X
3562(will)X
3706(no)X
3806(longer)X
555 960(have)N
735(to)X
825(do)X
933(a)X
997(copy-on-write)X
1480(operation)X
1811(for)X
1933(a)X
1997(subsequent)X
2381(write)X
2573(fault)X
2747(at)X
2832(address)X
3100(0x36000.)X
3447(If)X
3528(a)X
3591(fault)X
3765(were)X
3949(to)X
555 1056(occur)N
761(at)X
846(0x36000)X
1153(in)X
1242(the)X
1367(original)X
1642(segment,)X
2 f
1955(anon_getpage)X
1 f
2422(\(\))X
2502(would)X
2728(not)X
2856(enforce)X
3124(a)X
3186(read-only)X
3520(mapping,)X
3846(since)X
555 1152(the)N
673 0.4531(reference)AX
994(count)X
1192(for)X
1306(the)X
2 f
1424(anon)X
1 f
1617(structure)X
1918(is)X
1991(now)X
2149(one.)X
3 f
555 1344(5.3.)N
715(Kernel)X
971(Transient)X
4 f
1324(vnode)X
3 f
1540(Mapping)X
1870(Segment)X
1 f
755 1468(The)N
3 f
901(seg_map)X
1 f
1220(segment)X
1508(driver)X
1721(is)X
1795(a)X
1852(driver)X
2065(the)X
2184(kernel)X
2406(uses)X
2565(to)X
2648(get)X
2767(transient)X
3064(<)X
2 f
3109(vnode)X
1 f
3301(,)X
3342(offset>)X
3591(mappings.)X
3962(It)X
555 1564(supports)N
853(only)X
1022(shared)X
1258(mappings.)X
1635(The)X
1786(most)X
1967(important)X
2304(service)X
2558(it)X
2628(provides)X
2930(to)X
3018(the)X
2 f
3142(as)X
1 f
3252(layer)X
3439(is)X
3518(fault)X
3691(resolution)X
555 1660(for)N
671(kernel)X
894(page)X
1068(faults.)X
1308(The)X
1455(seg_map)X
1762(driver)X
1976(manages)X
2279(a)X
2337(large)X
2520(window)X
2800(of)X
2889(kernel)X
3111(virtual)X
3341(space)X
3541(and)X
3678(provides)X
3975(a)X
555 1756(view)N
735(onto)X
901(a)X
961(varying)X
1230(subset)X
1454(of)X
1545(the)X
1667(system's)X
1971(pages.)X
2217(The)X
2365(seg_map)X
2673(driver)X
2888(manages)X
3192(its)X
3290(own)X
3451(virtual)X
3683(space)X
3885(as)X
3975(a)X
555 1852(cache,)N
786(so)X
884(that)X
1031(recently)X
1317 0.4028(referenced)AX
1685(<)X
2 f
1730(vnode)X
1 f
1922(,)X
1969(offset>)X
2224(pairs)X
2407(are)X
2533(likely)X
2742(to)X
2831(be)X
2933(loaded)X
3173(in)X
3261(the)X
3385(MMU)X
3611(and)X
3753(no)X
3859(page)X
555 1948(fault)N
722(will)X
866(be)X
962(taken)X
1156(when)X
1350(the)X
1468(virtual)X
1697(address)X
1958(within)X
2182(the)X
2300(seg_map)X
2605(segment)X
2892(are)X
3011 0.3625(referenced.)AX
755 2072(This)N
920(segment)X
1210(driver)X
1425(provides)X
1724(fast)X
1863(map)X
2024(and)X
2163(unmap)X
2404(operations)X
2761(using)X
2956(two)X
3098(segment)X
3387(driver-speci\256c)X
3873(sub-)X
555 2168(routines:)N
2 f
880(segmap_getmap)X
1 f
1414(\(\))X
1513(and)X
2 f
1673(segmap_release)X
1 f
2203(\(\).)X
2341(Given)X
2581(a)X
2661(<)X
2 f
2706(vnode)X
1 f
2898(,)X
2962(offset>)X
3234(pair,)X
2 f
3423(segmap_getmap)X
1 f
3957(\(\))X
555 2264(returns)N
806(a)X
870(virtual)X
1107(address)X
1376(within)X
1607(the)X
1732(seg_map)X
2044(segment)X
2338(that)X
2485(is)X
2565(initialized)X
2912(to)X
3001(map)X
3166(part)X
3318(of)X
3412(the)X
2 f
3537(vnode.)X
1 f
3789(This)X
3958(is)X
555 2360(similar)N
799(to)X
883(the)X
1003(traditional)X
9 s
1352(UNIX)X
2 f
10 s
1554(bread)X
1 f
1754(\(\))X
1830(function)X
2119(used)X
2288(in)X
2372(the)X
2492(``block)X
2745(IO)X
2851(system'')X
3148(to)X
3231(obtain)X
3452(a)X
3509(buffer)X
3727(that)X
3868(con-)X
555 2456(tains)N
729(some)X
920(data)X
1076(from)X
1254(a)X
1312(block)X
1512(device.)X
1784(The)X
2 f
1931(segmap_release)X
1 f
2461(\(\))X
2537(function)X
2826(takes)X
3013(a)X
3071(virtual)X
3302(address)X
3565(returned)X
3855(from)X
2 f
555 2552(segmap_getmap)N
1 f
1089(\(\))X
1189(and)X
1351(handles)X
1642(releasing)X
1978(the)X
2122(mapping.)X
2 f
2488(segmap_release)X
1 f
3018(\(\))X
3118(also)X
3293(handles)X
3583(writing)X
3859(back)X
555 2648(modi\256ed)N
862(pages.)X
2 f
1107(segmap_release)X
1 f
1637(\(\))X
1713(performs)X
2025(a)X
2083(similar)X
2327(function)X
2616(to)X
2700(the)X
2820(traditional)X
9 s
3169(UNIX)X
2 f
10 s
3371(brelse)X
1 f
3580(\(\))X
3656(/)X
2 f
3700(bdwrite)X
1 f
3957(\(\))X
555 2744(/)N
2 f
597(bwrite)X
1 f
814(\(\))X
888(/)X
2 f
930(bawrite)X
1 f
1187(\(\))X
1261(``block)X
1513(IO)X
1618(system'')X
1914(procedures)X
2287(depending)X
2641(on)X
2741(the)X
2859(\257ags)X
3030(given)X
3228(to)X
2 f
3310(segmap_release)X
1 f
3840(\(\).)X
755 2868(The)N
905(seg_map)X
1215(driver)X
1432(is)X
1510(simply)X
1752(used)X
1924(as)X
2016(an)X
2117(optimization)X
2546(in)X
2633(the)X
2756(kernel)X
2982(over)X
3150(the)X
3273(standard)X
2 f
3570(vnode)X
1 f
3799(driver.)X
555 2964(It)N
635(is)X
719(important)X
1060(to)X
1152(be)X
1258(able)X
1422(to)X
1514(do)X
1624(fast)X
1770(map)X
1938(and)X
2084(unmap)X
2332(operations)X
2696(in)X
2788(the)X
2916(kernel)X
3147(to)X
3239(implement)X
2 f
3611(read)X
1 f
3771(\(2\))X
3895(and)X
2 f
555 3060(write)N
1 f
732(\(2\))X
848(system)X
1092(calls.)X
1301(The)X
1448(basic)X
1635(algorithm)X
1968(for)X
2084(the)X
2 f
2204(vnode)X
1 f
2431(read)X
2592(and)X
2730(write)X
2917(routines)X
3196(is)X
3270(to)X
3353(get)X
3472(a)X
3529(mapping)X
3830(to)X
3913(the)X
555 3156(\256le,)N
699(copy)X
877(the)X
997(data)X
1153(from/to)X
1415(the)X
1535(mapping,)X
1857(and)X
1995(then)X
2155(unmap)X
2395(the)X
2515(\256le.)X
2679(Note)X
2857(that)X
2999(the)X
3119(kernel)X
3341(accesses)X
3635(the)X
3754(\256le)X
3877(data)X
555 3252(just)N
692(as)X
781(user)X
937(processes)X
1267(do)X
1369(by)X
1471(using)X
1666(a)X
1724(mapping)X
2026(to)X
2110(the)X
2230(\256le.)X
2394(The)X
2 f
2540(vnode)X
1 f
2766(routines)X
3045(that)X
3186(implement)X
3549(read)X
3709(and)X
3846(write)X
555 3348(use)N
2 f
696(segmap_getmap)X
1 f
1230(\(\))X
1318(and)X
2 f
1468(segmap_release)X
1 f
1998(\(\))X
2085(to)X
2180(provide)X
2458(the)X
2589(fast)X
2738(map)X
2909(and)X
3058(unmap)X
3309(operations)X
3676(within)X
3913(the)X
555 3444(kernel's)N
834(address)X
1095(space.)X
3 f
555 3636(5.4.)N
715(Device)X
963(Driver)X
1211(Segment)X
1 f
755 3760(The)N
3 f
902(seg_dev)X
1 f
1191(segment)X
1480(driver)X
1694(manages)X
1997(objects)X
2245(controlled)X
2591(by)X
2692(character)X
3009(special)X
3253 0.4219(\(``raw''\))AX
3557(device)X
3788(drivers)X
555 3856(that)N
697(provide)X
964(an)X
2 f
1062(mmap)X
1 f
1292(interface.)X
1635(The)X
1781(most)X
1957(common)X
2258(use)X
2386(of)X
2474(the)X
2593(seg_dev)X
2877(driver)X
3090(is)X
3164(for)X
3279(mapped)X
3554(frame)X
3763(buffers,)X
555 3952(though)N
800(it)X
867(is)X
943(also)X
1095(used)X
1265(for)X
1382(mappings)X
1716(to)X
1801(machine-speci\256c)X
2368(memory)X
2658(\256les)X
2814(such)X
2984(as)X
3074(physical)X
3363(memory,)X
3672(kernel)X
3895(vir-)X
555 4048(tual)N
706(memory,)X
1024(Multibus)X
1343(memory,)X
1661(or)X
1759(VMEbus)X
2079(memory.)X
2417(This)X
2590(driver)X
2813(currently)X
3133(only)X
3305(supports)X
3606(shared)X
3846(map-)X
555 4144(pings)N
751(and)X
890(does)X
1060(not)X
1185(deal)X
1342(with)X
1507(anonymous)X
1898(private)X
2143(memory)X
2432(pages.)X
2677(The)X
2824(driver)X
3038(is)X
3113(simple)X
3348(since)X
3535(it)X
3601(doesn't)X
3859(have)X
555 4240(to)N
647(worry)X
869(about)X
1077(a)X
1143(many)X
1351(operations)X
1715(that)X
1865(don't)X
2064(make)X
2268(sense)X
2471(for)X
2594(these)X
2788(types)X
2986(of)X
3082(objects)X
3338(\(e.g.,)X
3530(swap)X
3724(out\).)X
3922(To)X
555 4336(resolve)N
815(a)X
879(fault,)X
1074(it)X
1146(simply)X
1391(calls)X
1566(a)X
1630(function)X
1925(to)X
2015(return)X
2235(an)X
2339(opaque)X
2599(``cookie'')X
2949(from)X
3133(the)X
3259(device)X
3496(driver,)X
3735(which)X
3958(is)X
555 4432(then)N
724(handed)X
987(to)X
1080(the)X
1209(machine-speci\256c)X
2 f
1784(hat)X
1 f
1930(layer)X
2122(to)X
2215(load)X
2384(a)X
2451(translation)X
2820(to)X
2912(the)X
3040(physical)X
3337(page)X
3519(denoted)X
3803(by)X
3913(the)X
555 4528(cookie.)N
3 f
555 4720(5.5.)N
715(Kernel)X
971(Memory)X
1286(Segment)X
1 f
755 4844(The)N
3 f
901(seg_kmem)X
1 f
1283(segment)X
1571(driver)X
1784(is)X
1858(an)X
1955(example)X
2248(of)X
2336(the)X
2455(use)X
2583(of)X
2671(a)X
2728(machine)X
3021(independent)X
3434(concept)X
3704(to)X
3786(solve)X
3975(a)X
555 4940(machine)N
849(dependent)X
1201(problem.)X
1530(The)X
1677(kernel's)X
1958(address)X
2221(space)X
2422(is)X
2497(described)X
2827(by)X
2929(an)X
2 f
3027(as)X
1 f
3120(structure)X
3423(just)X
3559(like)X
3700(the)X
3819(user's)X
555 5036(address)N
820(space.)X
1063(The)X
1212(seg_kmem)X
1583(segment)X
1874(driver)X
2090(is)X
2167(used)X
2338(as)X
2429(a)X
2489(catch-all)X
2789(to)X
2874(map)X
3035(miscellaneous)X
3512(entities)X
3766(into)X
3913(the)X
555 5132(kernel's)N
851(address)X
1129(space.)X
1385(These)X
1614(entities)X
1881(includes)X
2184(the)X
2318(kernel's)X
2613(text,)X
2789(data,)X
2979(bss,)X
3137(and)X
3289(dynamically)X
3721(allocated)X
555 5228(memory)N
848(space.)X
1093(This)X
1261(driver)X
1478(also)X
1632(manages)X
1938(other)X
2128(machine)X
2425(dependent)X
2780(portions)X
3067(of)X
3159(the)X
3282(kernel's)X
3566(address)X
3832(space)X
555 5324(\(e.g.)N
718(Sun's)X
920(Direct)X
1141(Virtual)X
1388(Memory)X
1684(Access)X
1932(space)X
2131([6]\).)X
755 5448(The)N
918(seg_kmem)X
1303(driver)X
1533(currently)X
1860(only)X
2039(supports)X
2347(non-paged)X
2723(memory)X
3027(whose)X
3269(MMU)X
3506(translations)X
3912(are)X
555 5544(always)N
801(locked)X
8 s
1015 5519(7)N
10 s
5544(.)Y
1110(In)X
1200(the)X
1321(previous)X
1620(4.2BSD-based)X
2108(VM)X
2260(system,)X
2525(the)X
2646(management)X
3079(of)X
3168(the)X
3288(kernel's)X
3569(address)X
3832(space)X
8 s
10 f
555 5624(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5699(7)N
8 s
691 5718(This)N
827(means)X
1012(that)X
1130(the)X
2 f
1230(hat)X
1 f
1345(layer)X
1494(cannot)X
1686(remove)X
1899(any)X
2013(of)X
2088(these)X
2241(translations)X
2558(without)X
2776(explicitly)X
3040(being)X
3204(told)X
3326(to)X
3397(do)X
3482(so)X
3560(by)X
3645(the)X
555 5798(seg_kmem)N
848(driver.)X
10 s
2263 6144(9)N

10 p
%%Page: 10 10
10 s 0 xH 0 xS 1 f
555 672(for)N
680(things)X
906(like)X
1056(device)X
1296(registers)X
1598(was)X
1753(done)X
1939(by)X
2049(calls)X
2226(to)X
2318(a)X
2 f
2384(mapin)X
1 f
2597(\(\))X
2681(procedure)X
3033(that)X
3183(set)X
3302(up)X
3412(MMU)X
3642(translations)X
555 768(using)N
756(a)X
820(machine-dependent)X
1476(page)X
1655(table)X
1838(entry.)X
2070(For)X
2208(kernel)X
2436(and)X
2579(driver)X
2798(compatibility)X
3251(reasons,)X
3539(the)X
3664(seg_kmem)X
555 864(driver)N
767(supports)X
1058(a)X
2 f
1114(mapin)X
1 f
1327(-like)X
1494(interface)X
1796(as)X
1883(a)X
1939(set)X
2048(of)X
2135(segment)X
2422(driver-speci\256c)X
2906(procedures.)X
3 f
555 1056(6.)N
655(Hardware)X
1027(Address)X
1327(Translation)X
1746(Layer)X
1 f
755 1180(The)N
2 f
911(hardware)X
1253(address)X
1533(translation)X
1 f
1926(\()X
2 f
1953(hat)X
1 f
2055(\))X
2112(layer)X
2303(is)X
2386(responsible)X
2781(for)X
2905(managing)X
3251(the)X
3379(machine)X
3681(dependent)X
555 1276(memory)N
858(management)X
1303(unit.)X
1502(It)X
1586(provides)X
1897(the)X
2030(interface)X
2347(between)X
2650(the)X
2783(machine)X
3090(dependent)X
3455(and)X
3606(the)X
3739(machine)X
555 1372(independent)N
974(parts)X
1157(of)X
1250(the)X
1374(VM)X
1529(system.)X
1817(The)X
1968(machine)X
2266(independent)X
2684(code)X
2862(above)X
3080(the)X
2 f
3204(hat)X
1 f
3345(layer)X
3532(knows)X
3767(nothing)X
555 1468(about)N
761(the)X
887(implementation)X
1417(details)X
1654(below)X
1878(the)X
2 f
2004(hat)X
1 f
2147(layer.)X
2376(The)X
2529(clean)X
2726(separation)X
3083(of)X
3177(machine)X
3476(independent)X
3895(and)X
555 1564(dependent)N
909(layers)X
1125(of)X
1216(the)X
1338(VM)X
1491(system)X
1737(allows)X
1969(for)X
2086(better)X
2292(understandability)X
2871(and)X
3010(faster)X
3212(porting)X
3466(to)X
3551(new)X
3708(machines)X
555 1660(with)N
717(different)X
1014(MMUs.)X
755 1784(The)N
2 f
904(hat)X
1 f
1043(layer)X
1228(exports)X
1488(a)X
1548(set)X
1661(of)X
1752(procedures)X
2129(for)X
2246(use)X
2376(by)X
2479(the)X
2600(machine)X
2895(independent)X
3310(segment)X
3600(drivers.)X
3886(The)X
555 1880(higher)N
791(levels)X
1009(cannot)X
1254(look)X
1427(at)X
1516(the)X
1645(current)X
1904(mappings,)X
2266(they)X
2435(can)X
2578(only)X
2751(determine)X
3103(if)X
3183(any)X
3329(mappings)X
3670(exist)X
3851(for)X
3975(a)X
555 1976(given)N
761(page.)X
981(The)X
1134(machine)X
1434(independent)X
1854(levels)X
2069(call)X
2212(down)X
2417(to)X
2506(the)X
2 f
2631(hat)X
1 f
2773(layer)X
2961(to)X
3050(set)X
3166(up)X
3273(translations)X
3669(as)X
3763(needed.)X
555 2072(The)N
703(basic)X
891(dependency)X
1298(here)X
1460(is)X
1536(the)X
1657(ability)X
1884(to)X
1968(handle)X
2204(and)X
2342(recover)X
2606(from)X
2784(page)X
2958(faults)X
3158(\(including)X
3509(copy-on-write\).)X
555 2168(The)N
2 f
711(hat)X
1 f
857(layer)X
1049(is)X
1133(free)X
1290(to)X
1383(remove)X
1655(translations)X
2055(as)X
2153(it)X
2228(sees)X
2392(\256t)X
2488(if)X
2567(the)X
2695(translation)X
3063(was)X
3218(not)X
3350(set)X
3469(up)X
3579(to)X
3671(be)X
3777(locked.)X
555 2264(There)N
770(exists)X
979(a)X
1042(call)X
1185(back)X
1364(mechanism)X
1756(from)X
1939(the)X
2064(hat)X
2189(layer)X
2377(to)X
2466(the)X
2591(segment)X
2885(driver)X
3104(so)X
3202(that)X
3349(the)X
3474(virtual)X
3710 0.4531(reference)AX
555 2360(and)N
705(modi\256ed)X
1023(bits)X
1172(can)X
1318(be)X
1428(maintained)X
1817(when)X
2024(a)X
2093(translation)X
2464(is)X
2550(take)X
2717(away)X
2920(by)X
3033(the)X
2 f
3164(hat)X
1 f
3312(layer.)X
3546(This)X
3721(ability)X
3958(is)X
555 2456(needed)N
803(for)X
917(alternate)X
1214(paging)X
1452(techniques)X
1815(in)X
1897(which)X
2113(per)X
2236(address)X
2497(space)X
2696(management)X
3126(of)X
3213(the)X
3331(working)X
3618(set)X
3727(is)X
3800(done.)X
3 f
555 2648(6.1.)N
4 f
715(hat)X
3 f
841(Procedures)X
1 f
755 2772(Table)N
978(1)X
1058(lists)X
1226(the)X
1364(machine)X
1676(independent)X
2 f
2108(hat)X
1 f
2263(interfaces.)X
2656(All)X
2798(these)X
3003(procedures)X
3396(must)X
3591(be)X
3706(provided,)X
555 2868(although)N
870(they)X
1043(may)X
1216(not)X
1353(necessarily)X
1745(do)X
1860(anything)X
2175(if)X
2259(not)X
2396(required)X
2699(by)X
2814(the)X
2 f
2947(hat)X
1 f
3097(implementation)X
3634(for)X
3763(a)X
3833(given)X
555 2964(machine.)N
10 f
619 3124(_)N
627(___________________________________________________________________________________)X
3 f
1491 3220(Operation)N
3198(Function)X
1 f
10 f
619 3228(_)N
627(___________________________________________________________________________________)X
619 3244(_)N
627(___________________________________________________________________________________)X
7 f
659 3332(hat_init\(\))N
1 f
2795(One)X
2949(time)X
2 f
3111(hat)X
1 f
3246(initialization.)X
10 f
619 3348(_)N
627(___________________________________________________________________________________)X
7 f
659 3444(hat_alloc\(as\))N
1 f
2795(Allocate)X
2 f
3087(hat)X
1 f
3222(structure)X
3523(for)X
2 f
3637(as)X
1 f
3708(.)X
10 f
619 3460(_)N
627(___________________________________________________________________________________)X
7 f
659 3556(hat_free\(as\))N
1 f
2795(Release)X
3065(all)X
2 f
3165(hat)X
1 f
3300(resources)X
3624(for)X
2 f
3738(as)X
1 f
3809(.)X
10 f
619 3564(_)N
627(___________________________________________________________________________________)X
619 3580(_)N
627(___________________________________________________________________________________)X
7 f
659 3668(hat_pageunload\(pp\))N
1 f
2795(Unload)X
3051(all)X
3151(translations)X
3540(to)X
3622(page)X
2 f
3794(pp.)X
1 f
10 f
619 3684(_)N
627(___________________________________________________________________________________)X
7 f
659 3780(hat_pagesync\(pp\))N
1 f
2795(Sync)X
2975(ref)X
3085(and)X
3221(mod)X
3383(bits)X
3518(to)X
3600(page)X
2 f
3772(pp.)X
1 f
10 f
619 3788(_)N
627(___________________________________________________________________________________)X
619 3804(_)N
627(___________________________________________________________________________________)X
7 f
659 3892(hat_unlock\(seg,)N
1427(addr\))X
1 f
2795(Unlock)X
3051(translation)X
3409(at)X
2 f
3487(addr.)X
1 f
10 f
619 3908(_)N
627(___________________________________________________________________________________)X
7 f
659 4004(hat_chgprot\(seg,)N
1475(addr,)X
1763(len,)X
2003(prot\))X
1 f
2795(Change)X
3060(protection)X
3405(values.)X
10 f
619 4020(_)N
627(___________________________________________________________________________________)X
7 f
659 4116(hat_unload\(seg,)N
1427(addr,)X
1715(len\))X
1 f
2795(Unload)X
3051(translations.)X
10 f
619 4132(_)N
627(___________________________________________________________________________________)X
7 f
659 4228(hat_memload\(seg,)N
1475(addr,)X
1763(pp,)X
1955(prot,)X
2243(flags\))X
1 f
2795(Load)X
2980(translation)X
3338(to)X
3420(page)X
2 f
3592(pp.)X
1 f
10 f
619 4244(_)N
627(___________________________________________________________________________________)X
7 f
659 4340(hat_devload\(seg,)N
1475(addr,)X
1763(pf,)X
1955(prot,)X
2243(flags\))X
1 f
2795(Load)X
2980(translation)X
3338(to)X
3420(cookie)X
2 f
3654(pf.)X
1 f
10 f
619 4356(_)N
627(___________________________________________________________________________________)X
619(\207)X
4324(\207)Y
4244(\207)Y
4164(\207)Y
4084(\207)Y
4004(\207)Y
3924(\207)Y
3844(\207)Y
3764(\207)Y
3684(\207)Y
3604(\207)Y
3524(\207)Y
3444(\207)Y
3364(\207)Y
3284(\207)Y
3204(\207)Y
3947 4356(\207)N
4324(\207)Y
4244(\207)Y
4164(\207)Y
4084(\207)Y
4004(\207)Y
3924(\207)Y
3844(\207)Y
3764(\207)Y
3684(\207)Y
3604(\207)Y
3524(\207)Y
3444(\207)Y
3364(\207)Y
3284(\207)Y
3204(\207)Y
3 f
2155 4596(Table)N
2370(1)X
4 f
2040 4692(hat)N
3 f
2166(operations)X
555 4980(6.2.)N
4 f
715(hat)X
3 f
841(Implementations)X
1 f
755 5104(Several)N
2 f
1023(hat)X
1 f
1165(implementations)X
1725(have)X
1904(already)X
2168(been)X
2347(completed.)X
2748(The)X
2900(\256rst)X
3051(implementations)X
3610(were)X
3793(for)X
3913(the)X
555 5200(Sun)N
707(MMU)X
935([6].)X
1097(The)X
1250(MMUs)X
1509(in)X
1599(the)X
1724(current)X
1979(Sun-2/3/4)X
2321(family)X
2557(are)X
2683(quite)X
2870(similar.)X
3159(All)X
3288(use)X
3422(a)X
3485(\256xed)X
3672(number)X
3944(of)X
555 5296(context,)N
839(segment,)X
1154(and)X
1298(page)X
1477(table)X
1660(registers)X
1959(in)X
2048(special)X
2298(hardware)X
2625(registers)X
2924(to)X
3013(provide)X
3285(mapping)X
3592(control.)X
3886(The)X
555 5392(Sun-2)N
767(MMU)X
988(has)X
1116(a)X
1173(separate)X
1458(context)X
1715(when)X
1910(running)X
2180(in)X
2263(supervisor)X
2618(mode)X
2817(whereas)X
3102(the)X
3221(Sun-3)X
3433(and)X
3569(Sun-4)X
3780(MMUs)X
555 5488(have)N
735(the)X
861(kernel)X
1090(mapped)X
1372(in)X
1462(each)X
1638(user)X
1800(context.)X
2103(The)X
2255(maximum)X
2606(virtual)X
2842(address)X
3110(space)X
3316(for)X
3437(the)X
3562(Sun-2,)X
3800(Sun-3,)X
555 5584(and)N
691(Sun-4)X
902(MMUs)X
1153(are)X
1272(16)X
1372(megabytes,)X
1755(256)X
1895(megabytes,)X
2278(and)X
2414(4)X
2474(gigabytes)X
2801(respectively.)X
755 5708(Some)N
959(machines)X
1284(in)X
1367(the)X
1486(Sun-3)X
1698(and)X
1835(Sun-4)X
2047(families)X
2326(use)X
2454(a)X
2511(virtual)X
2741(address)X
3003(write-back)X
3368(cache.)X
3613(The)X
3759(use)X
3887(of)X
3975(a)X
555 5804(virtual)N
797(address)X
1071(cache)X
1288(allows)X
1530(for)X
1657(faster)X
1869(memory)X
2169(access)X
2408(time)X
2583(on)X
2696(cache)X
2913(hits,)X
3081(but)X
3216(can)X
3361(be)X
3470(a)X
3539(cause)X
3751(of)X
3850(great)X
2243 6144(10)N

11 p
%%Page: 11 11
10 s 0 xH 0 xS 1 f
555 672(trouble)N
808(to)X
896(the)X
1020(kernel)X
1247(in)X
1335(the)X
1459(old)X
1587(VM)X
1742(system)X
1990([7].)X
2150(Since)X
2354(the)X
2 f
2478(hat)X
1 f
2618(layer)X
2804(has)X
2936(information)X
3339(about)X
3542(all)X
3647(the)X
3770(transla-)X
555 768(tions)N
731(to)X
814(a)X
871(given)X
1070(page,)X
1263(it)X
1328(can)X
1460(manage)X
1730(all)X
1830(the)X
1948(details)X
2177(of)X
2264(the)X
2382(virtual)X
2611(address)X
2872(cache.)X
3116(It)X
3185(can)X
3317(verify)X
3529(the)X
3647(current)X
3895(vir-)X
555 864(tual)N
700(address)X
966(alignment)X
1311(for)X
1430(the)X
1553(page)X
1730(and)X
1870(decide)X
2104(to)X
2190(trade)X
2375(translations)X
2768(if)X
2841(an)X
2941(attempt)X
3205(to)X
3291(load)X
3453(a)X
3513(non-cache)X
3868(con-)X
555 960(sistent)N
786(address)X
1053(occurs.)X
1329(In)X
1422(the)X
1546(old)X
1674(4.2BSD-based)X
2165(VM)X
2320(system)X
2568(the)X
2692(additional)X
3038(support)X
3304(needed)X
3558(for)X
3678(the)X
3802(virtual)X
555 1056(address)N
826(cache)X
1040(permeated)X
1405(many)X
1613(areas)X
1809(of)X
1906(the)X
2034(system.)X
2326(Under)X
2557(the)X
2685(new)X
2849(VM)X
3008(system,)X
3280(support)X
3550(for)X
3674(the)X
3802(virtual)X
555 1152(address)N
816(cache)X
1020(is)X
1093(isolated)X
1362(within)X
1586(the)X
2 f
1704(hat)X
1 f
1839(layer.)X
755 1276(Other)N
2 f
975(hat)X
1 f
1127(implementations)X
1697(have)X
1886(been)X
2075(done)X
2268(for)X
2399(more)X
2601(traditional)X
2967(page)X
3155(table-based)X
3557(systems.)X
3886(The)X
555 1372(Motorola)N
876(68030)X
1099(has)X
1229(a)X
1288(\257exible)X
1551(on-chip)X
1818(MMU.)X
2080(The)X
2 f
2227(hat)X
1 f
2364(layer)X
2547(chooses)X
2823(to)X
2907(manage)X
3179(it)X
3245(using)X
3440(a)X
3498(three)X
3681(level)X
3859(page)X
555 1468(table)N
733(to)X
817(support)X
1079(mapping)X
1381(a)X
1439(large)X
1622(sparse)X
1845(virtual)X
2076(address)X
2339(space)X
2540(with)X
2704(minimal)X
2991(overhead.)X
3347(The)X
3493(Intel)X
3661(80386)X
3882(also)X
555 1564(has)N
685(an)X
784(on-chip)X
1052(MMU,)X
1295(but)X
1420(it)X
1487(has)X
1617(a)X
1676(\256xed)X
1859(two)X
2002(level)X
2181(translation)X
2542(scheme)X
2806(of)X
2895(4KB)X
3068(pages.)X
3313(The)X
3460(problem)X
3749(with)X
3913(the)X
555 1660(80386)N
778(MMU)X
1001(is)X
1077(that)X
1220(the)X
1341(kernel)X
1565(can)X
1700(write)X
1888(all)X
1991(pages)X
2197(regardless)X
2546(of)X
2636(the)X
2757(page)X
2931(protections)X
3309(\(i.e.,)X
3476(the)X
3596(write)X
3783(protec-)X
555 1756(tion)N
700(only)X
863(applies)X
1111(to)X
1194(non-supervisor)X
1696(mode)X
1895(accesses\)!)X
2263(This)X
2426(means)X
2652(that)X
2792(explicit)X
3052(checks)X
3291(must)X
3466(be)X
3562(performed)X
3917(for)X
555 1852(kernel)N
780(write)X
969(accesses)X
1266(to)X
1352(read-only)X
1684(pages)X
1891(so)X
1986(that)X
2130(kernel)X
2355(protection)X
2704(faults)X
2906(can)X
3042(be)X
3142(simulated.)X
3516(Another)X
3802(imple-)X
555 1948(mentation)N
916(has)X
1064(been)X
1257(done)X
1453(for)X
1587(IBM)X
1778(370/XA)X
2076(compatible)X
2472(main)X
2672(frames.)X
2971(The)X
3136(biggest)X
3407(problem)X
3714(with)X
3896(this)X
555 2044(machine's)N
907(architecture)X
1309(for)X
1425(the)X
1545(new)X
1701(VM)X
1852(system)X
2096(is)X
2171(that)X
2312(an)X
2409(attempted)X
2746(write)X
2932(access)X
3159(to)X
3242(a)X
3299(read-only)X
3628(page)X
3801(causes)X
555 2140(an)N
661(protection)X
1016(exception)X
1358(that)X
1508(can)X
1650(leave)X
1850(the)X
1978(machine)X
2280(in)X
2371(an)X
2476(unpredictable)X
2942(state)X
3118(for)X
3241(certain)X
3489(instructions)X
3891(that)X
555 2236(modify)N
816(registers)X
1118(as)X
1215(a)X
1281(side)X
1440(effect.)X
1694(These)X
1916(instructions)X
2319(cannot)X
2563(be)X
2669(reliably)X
2943(restarted)X
3249(thus)X
3411(breaking)X
3721(copy-on-)X
555 2332(write)N
741(fault)X
909(handling.)X
1250(The)X
1396(implementation)X
1919(resorts)X
2154(to)X
2237(special)X
2481(work)X
2666(arounds)X
2940(for)X
3054(the)X
3172(few)X
3313(instructions)X
3706(that)X
3846(exhi-)X
555 2428(bit)N
659(this)X
794(problem)X
8 s
1061 2403(8)N
10 s
2428(.)Y
3 f
555 2620(7.)N
655(File)X
804(System)X
1069(Changes)X
1 f
755 2744(The)N
903(VM)X
1055(system)X
1300(required)X
1591(changes)X
1873(to)X
1958(several)X
2209(other)X
2397(parts)X
2575(of)X
2664(the)X
2784(SunOS)X
3032(kernel.)X
3295(The)X
3442(VM)X
3593(system)X
3837(relies)X
555 2840(heavily)N
823(on)X
935(the)X
2 f
1065(vnode)X
1 f
1302(object)X
1530(managers,)X
1890(and)X
2038(required)X
2338(changes)X
2629(to)X
2723(the)X
2 f
2853(vnode)X
1 f
3090(interface)X
3404(as)X
3503(well)X
3672(as)X
3770(to)X
3863(each)X
2 f
555 2936(vnode)N
1 f
780(object)X
996(type)X
1154(implementation.)X
1716(It)X
1785(took)X
1947(us)X
2038(several)X
2286(attempts)X
2577(to)X
2659(get)X
2777(the)X
2895(new)X
2 f
3049(vnode)X
1 f
3274(interface)X
3576(right.)X
755 3060(Our)N
911(initial)X
1128(attempt)X
1399(gave)X
1582(the)X
1711(core)X
1881(VM)X
2041(code)X
2224(responsibility)X
2690(for)X
2815(all)X
2926(decisions)X
3254(about)X
3462(operations)X
3826(it)X
3900(ini-)X
555 3156(tiated.)N
796(We)X
931(repeatedly)X
1289(encounted)X
1642(problems)X
1963(induced)X
2240(by)X
2343(not)X
2467(having)X
2707(appropriate)X
3095(information)X
3495(available)X
3807(within)X
555 3252(the)N
680(VM)X
836(code)X
1015(at)X
1100(sites)X
1269(where)X
1493(it)X
1564(had)X
1707(to)X
1796(make)X
1997(decisions,)X
2342(and)X
2485(realized)X
2767(that)X
2914(the)X
3039(proper)X
3276(approach)X
3598(was)X
3749(to)X
3837(make)X
555 3348(decisions)N
874(at)X
953(locations)X
1263(possessing)X
1626(the)X
1745(requisite)X
2042(information.)X
2481(The)X
2627(primary)X
2902(effect)X
3107(of)X
3195(this)X
3331(shift)X
3494(in)X
3576(responsibility)X
555 3444(was)N
704(to)X
790(give)X
952(the)X
2 f
1074(vnode)X
1 f
1303(drivers)X
1550(control)X
1801(on)X
1905(each)X
2077(page)X
2253 0.4028(reference.)AX
2618(This)X
2784(allows)X
3017(the)X
2 f
3139(vnode)X
1 f
3367(drivers)X
3613(to)X
3698(recognize)X
555 3540(and)N
699(act)X
821(on)X
929(each)X
1105(new)X
1267 0.4028(reference.)AX
1636(These)X
1856(actions)X
2111(include)X
2375(validating)X
2723(the)X
2849(page,)X
3049(handling)X
3357(any)X
3501(needed)X
3757(backing)X
555 3636(store)N
731(allocation,)X
1087(starting)X
1347 0.3611(read-ahead)AX
1721(operations,)X
2095(and)X
2231(updating)X
2531(\256le)X
2653(attributes.)X
3 f
555 3828(7.1.)N
715(File)X
864(Caching)X
1 f
755 3952(Traditionally,)N
1214(buffers)X
1463(in)X
1546(the)X
9 s
1663(UNIX)X
10 s
1864(buffer)X
2082(cache)X
2287(have)X
2460(been)X
2633(described)X
2962(by)X
3063(a)X
3120(device)X
3351(number)X
3617(and)X
3754(a)X
3811(physi-)X
555 4048(cal)N
680(block)X
889(number)X
1165(on)X
1276(that)X
1427(device.)X
1708(This)X
1881(use)X
2019(of)X
2117(physical)X
2415(layout)X
2646(information)X
3055(requires)X
3345(all)X
3456(\256le)X
3589(system)X
3842(types)X
555 4144(implemented)N
1000(on)X
1107(top)X
1236(of)X
1330(a)X
1392(a)X
1454(block)X
1658(device)X
1894(to)X
1982(translate)X
2280(\()X
2 f
2307(bmap)X
1 f
2485(\))X
2538(each)X
2712(logical)X
2956(block)X
3160(to)X
3248(a)X
3310(physical)X
3603(block)X
3807(on)X
3913(the)X
555 4240(device)N
785(before)X
1011(it)X
1075(can)X
1207(be)X
1303(looked)X
1541(up)X
1641(in)X
1723(the)X
1841(buffer)X
2058(cache.)X
755 4364(In)N
849(the)X
974(new)X
1135(VM)X
1291(system,)X
1560(the)X
1685(physical)X
1979(memory)X
2273(in)X
2362(the)X
2487(system)X
2736(is)X
2816(used)X
2990(as)X
3084(a)X
2 f
3147(logical)X
1 f
3408(cache;)X
3640(each)X
3814(buffer)X
555 4460(\(page\))N
787(in)X
875(the)X
999(cache)X
1209(is)X
1287(described)X
1620(by)X
1725(an)X
1826(object)X
2047(name)X
2246(\()X
2 f
2273(vnode)X
1 f
2465(\))X
2517(and)X
2658(a)X
2719(\(page-aligned\))X
3213(offset)X
3421(within)X
3650(that)X
3795(object.)X
555 4556(Each)N
744(\256le)X
874(is)X
955(named)X
1196(as)X
1290(a)X
1353(separate)X
2 f
1644(vnode,)X
1 f
1896(so)X
1994(the)X
2119(VM)X
2275(system)X
2524(need)X
2703(not)X
2832(have)X
3011(any)X
3154(knowledge)X
3533(of)X
3627(the)X
3752(way)X
3913(the)X
2 f
555 4652(vnode)N
1 f
784(object)X
1004(manager)X
1305(\(\256le)X
1458(system)X
1704(type\))X
1893(stores)X
2104(the)X
2 f
2226(vnode.)X
1 f
2475(A)X
2557(segment)X
2848(driver)X
3064(simply)X
3305(asks)X
3466(the)X
2 f
3587(vnode)X
1 f
3815(object)X
555 4748(manager)N
854(for)X
970(a)X
1028(range)X
1229(of)X
1318(logical)X
1558(pages)X
1763(within)X
1989(the)X
2 f
2109(vnode)X
1 f
2336(being)X
2536(mapped.)X
2851(The)X
2997(\256le)X
3120(system)X
3363(independent)X
3776(code)X
3949(in)X
555 4844(the)N
686(segment)X
986(drivers)X
1242(only)X
1417(has)X
1557(to)X
1652(deal)X
1819(with)X
1994(offsets)X
2241(into)X
2398(a)X
2 f
2467(vnode)X
1 f
2705(and)X
2854(does)X
3034(not)X
3169(have)X
3354(to)X
3449(maintain)X
3761(any)X
3909(\256le)X
555 4940(system-speci\256c)N
1078(mapping)X
1387(information)X
1794(that)X
1943(is)X
2025(already)X
2291(kept)X
2458(in)X
2549(the)X
2675(\256le)X
2805(system-speci\256c)X
3327(data)X
3489(structures.)X
3869(This)X
555 5036(provides)N
856(a)X
917(much)X
1120(cleaner)X
1378(separation)X
1733(between)X
2026(the)X
2149(segment)X
2441(and)X
2 f
2582(vnode)X
1 f
2812(abstractions)X
3220(and)X
3361(puts)X
3519(few)X
3664(constraints)X
555 5132(on)N
655(the)X
773(implementation)X
1295(of)X
1382(a)X
2 f
1438(vnode)X
1 f
1663(object)X
1879(manager)X
8 s
2156 5107(9)N
10 s
5132(.)Y
755 5256(The)N
906(smallest)X
1194(mapping)X
1500(unit)X
1650(relevant)X
1935(to)X
2022(the)X
2145(VM)X
2299(system)X
2546(is)X
2624(a)X
2685(system)X
2932(page.)X
3149(However,)X
3489(the)X
3612(system)X
3859(page)X
555 5352(size)N
710(is)X
793(not)X
925(necessarily)X
1312(related)X
1561(to)X
1653(the)X
1781(block)X
1989(sizes)X
2174(that)X
2323(a)X
2388(\256le)X
2519(system)X
2770(implementation)X
3301(might)X
3516(use.)X
3692(While)X
3917(we)X
8 s
10 f
555 5432(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5507(8)N
8 s
691 5526(Such)N
835(instructions)X
1150(are)X
1243(highly)X
1423(specialized)X
1722(and)X
1830(the)X
1924(standard)X
2156(compilers)X
2424(never)X
2581(generate)X
2812(them.)X
6 s
635 5601(9)N
8 s
691 5620(We)N
802(have)X
945(taken)X
1105(advantage)X
1385(of)X
1460(this)X
1575(and)X
1689(have)X
1831(implemented)X
2187(several)X
2389(interesting)X
2 f
2681(vnode)X
1 f
2866(object)X
3044(managers)X
3310(that)X
3428(are)X
3527(nothing)X
555 5700(like)N
667(typical)X
857(\256le)X
955(systems.)X
10 s
2243 6144(11)N

12 p
%%Page: 12 12
10 s 0 xH 0 xS 1 f
555 672(could)N
757(have)X
932(implemented)X
1373(a)X
1432(new)X
1589(\256le)X
1714(system)X
1959(type)X
2120(that)X
2263(used)X
2433(blocks)X
2665(that)X
2808(were)X
2988(the)X
3109(same)X
3297(size)X
3445(as)X
3535(a)X
3594(system)X
3839(page,)X
555 768(and)N
692(only)X
855(supported)X
1192(\256le)X
1315(systems)X
1589(that)X
1730(had)X
1867(this)X
2002(attribute,)X
2309(we)X
2423(did)X
2545(not)X
2667(feel)X
2808(this)X
2943(was)X
3088(an)X
3184(acceptable)X
3544(approach.)X
3899(We)X
555 864(needed)N
812(to)X
903(support)X
1172(existing)X
1454(\256le)X
1585(systems)X
1867(with)X
2038(widely)X
2285(varying)X
2559(block)X
2766(size.)X
2960(We)X
3100(also)X
3257(did)X
3387(not)X
3517(feel)X
3666(that)X
3814(it)X
3886(was)X
555 960(appropriate)N
944(to)X
1028(use)X
1157(only)X
1321(one)X
1459(system)X
1703(page)X
1877(size)X
2024(across)X
2247(a)X
2305(large)X
2488(range)X
2689(of)X
2778(machines)X
3103(of)X
3192(varying)X
3459(memory)X
3748(size)X
3895(and)X
555 1056(performance.)N
1024(We)X
1158(decided)X
1430(it)X
1496(was)X
1643(best)X
1794(to)X
1878(push)X
2051(the)X
2171(handling)X
2473(of)X
2562(block)X
2762(size)X
2909(issues)X
3122(into)X
3267(each)X
3436(\256le)X
3559(system)X
3802(imple-)X
555 1152(mentation,)N
915(since)X
1100(the)X
1218(issues)X
1429(would)X
1649(vary)X
1812(greatly)X
2055(depending)X
2409(on)X
2509(the)X
2627(\256le)X
2749(system)X
2991(type.)X
755 1276(The)N
904(smallest)X
1190(allocatable)X
1562(\256le)X
1688(system)X
1934(block)X
2136(is)X
2213(potentially)X
2579(smaller)X
2839(than)X
3001(the)X
3123(system)X
3369(page)X
3544(size,)X
3712(while)X
3913(the)X
555 1372(largest)N
795(\256le)X
923(system)X
1170(block)X
1373(may)X
1536(be)X
1637(much)X
1840(larger)X
2053(than)X
2216(the)X
2339(system)X
2586(page)X
2763(size.)X
2953(The)X
2 f
3103(vnode)X
1 f
3333(object)X
3554(manager)X
3856(must)X
555 1468(initialize)N
866(each)X
1045(page)X
1228(for)X
1352(a)X
1418(\256le)X
1550(to)X
1642(the)X
1770(proper)X
2010(contents.)X
2347(It)X
2426(may)X
2594(do)X
2704(this)X
2849(by)X
2959(reading)X
3230(a)X
3296(single)X
3517(block,)X
3745(multiple)X
555 1564(blocks,)N
808(or)X
899(possibly)X
1188(part)X
1336(of)X
1426(a)X
1485(block,)X
1706(as)X
1796(necessary.)X
2172(If)X
2249(the)X
2370(size)X
2518(of)X
2608(the)X
2729(\256le)X
2854(is)X
2930(not)X
3055(a)X
3114(multiple)X
3403(of)X
3493(the)X
3614(system)X
3859(page)X
555 1660(size,)N
720(the)X
2 f
838(vnode)X
1 f
1063(object)X
1279(manager)X
1576(must)X
1751(handle)X
1985(zeroing)X
2246(the)X
2364(remainder)X
2710(of)X
2797(the)X
2915(page)X
3087(past)X
3236(the)X
3354(end)X
3490(of)X
3577(the)X
3695(\256le.)X
755 1784(Using)N
970(a)X
1030(logical)X
1272(cache)X
1480(doesn't)X
1740(come)X
1938(without)X
2206(some)X
2399(cost.)X
2592(When)X
2807(trying)X
3021(to)X
3106(write)X
3294(a)X
3353(page)X
3528(back)X
3703(to)X
3788(the)X
3909(\256le)X
555 1880(system)N
803(device,)X
1059(the)X
1183(VOP_PUTPAGE)X
1769(routine)X
2022(\(discussed)X
2382(below\))X
2631(may)X
2795(need)X
2973(to)X
3060(map)X
3223(the)X
3346(logical)X
3589(page)X
3766(number)X
555 1976(within)N
789(the)X
917(object)X
1143(to)X
1235(a)X
1301(physical)X
1597(block)X
1804(number,)X
2098(or)X
2194(perhaps)X
2473(to)X
2564(a)X
2629(list)X
2755(of)X
2851(physical)X
3147(block)X
3354(numbers.)X
3699(If)X
3782(the)X
3909(\256le)X
555 2072(system-speci\256c)N
1072(information)X
1473(needed)X
1724(to)X
1809(perform)X
2091(the)X
2212(mapping)X
2515(function)X
2805(is)X
2881(not)X
3006(present)X
3261(in)X
3345(memory,)X
3654(then)X
3814(a)X
3872(read)X
555 2168(operation)N
888(may)X
1056(be)X
1161(required)X
1458(to)X
1549(get)X
1676(it.)X
1789(This)X
1960(complicates)X
2372(the)X
2499(work)X
2693(the)X
2820(page)X
3001(daemon)X
3284(must)X
3468(do)X
3577(when)X
3780(writing)X
555 2264(back)N
743(a)X
815(dirty)X
1002(page.)X
1230(File)X
1390(system)X
1648(implementations)X
2217(need)X
2405(to)X
2503(be)X
2614(careful)X
2873(to)X
2970(prevent)X
3246(the)X
3379(page)X
3566(daemon)X
3855(from)X
555 2360(deadlocking)N
974(waiting)X
1241(to)X
1330(allocate)X
1607(a)X
1670(page)X
1849(needed)X
2104(for)X
2225(a)X
2 f
2288(bmap)X
1 f
2479(-like)X
2653(operation)X
2983(while)X
3188(trying)X
3405(to)X
3493(push)X
3670(out)X
3798(a)X
3860(dirty)X
555 2456(page)N
727(when)X
921(there)X
1102(are)X
1221(no)X
1321(free)X
1467(pages)X
1670(available.)X
3 f
555 2648(7.2.)N
4 f
715(vnode)X
3 f
931(Interface)X
1264(Changes)X
1 f
755 2772(We)N
888(de\256ned)X
1145(three)X
1327(new)X
2 f
1482(vnode)X
1 f
1708(operations)X
2063(for)X
2177(dealing)X
2433(with)X
2595(the)X
2713(new)X
2867(abstractions)X
3270(of)X
3357(mappings)X
3688(in)X
3770(address)X
555 2868(spaces)N
790(and)X
930(pages.)X
1177(These)X
1393(new)X
2 f
1551(vnode)X
1 f
1780(operations)X
2138(replaced)X
2435(ones)X
2606(that)X
2750(dealt)X
2930(with)X
3096(the)X
3218(old)X
3344(buffer)X
3565(cache)X
3773(and)X
3913(the)X
555 2964(4.2BSD-based)N
1042(VM)X
1193(system)X
1437([2].)X
1593(The)X
1740(primary)X
2016(responsibility)X
2473(of)X
2562(the)X
2 f
2682(vnode)X
1 f
2909(page)X
3083(operations)X
3439(is)X
3514(to)X
3598(\256ll)X
3708(and)X
3846(drain)X
555 3060(physical)N
858(pages)X
1077(\(page-in)X
1381(and)X
1533(page-out\).)X
1917(It)X
2002(also)X
2166(provides)X
2477(an)X
2588(opportunity)X
2996(for)X
3125(the)X
3258(managers)X
3601(of)X
3703(particular)X
555 3156(objects)N
802(to)X
884(map)X
1042(the)X
1160(page)X
1332(abstractions)X
1735(to)X
1817(the)X
1935(representation)X
2410(used)X
2577(by)X
2677(the)X
2795(object)X
3011(being)X
3209(mapped.)X
755 3280(The)N
900(VOP_MAP\(\))X
1347(routine)X
1594(is)X
1667(used)X
1834(by)X
1934(the)X
2 f
2052(mmap)X
1 f
2281(system)X
2523(call)X
2659(and)X
2795(is)X
2868(responsible)X
3253(for)X
3367(handling)X
3667(\256le)X
3789(system)X
555 3376(dependent)N
912(argument)X
1241(checking,)X
1577(as)X
1670(well)X
1834(as)X
1927(setting)X
2166(up)X
2272(the)X
2396(requested)X
2730(mapping.)X
3076(After)X
3272(checking)X
3588(parameters)X
3967(it)X
555 3472(uses)N
716(two)X
859(address)X
1123(space)X
1325(operations)X
1682(to)X
1766(do)X
1868(most)X
2045(of)X
2134(the)X
2254(work.)X
2481(Any)X
2641(mappings)X
2974(in)X
3058(the)X
3178(address)X
3441(range)X
3642(speci\256ed)X
3949(in)X
555 3568(the)N
2 f
686(mmap)X
1 f
928(system)X
1183(call)X
1332(are)X
1464(\256rst)X
1621(removed)X
1935(by)X
2047(using)X
2252(the)X
2 f
2382(as_unmap)X
1 f
2724(\(\))X
2810(routine.)X
3109(Then)X
3306(the)X
2 f
3436(as_map)X
1 f
3698(\(\))X
3784(routine)X
555 3664(establishes)N
923(the)X
1042(new)X
1196(mapping)X
1496(in)X
1578(the)X
1696(given)X
1894(address)X
2155(space)X
2354(by)X
2454(calling)X
2692(the)X
2810(segment)X
3097(driver)X
3309(selected)X
3588(by)X
3688(the)X
2 f
3806(vnode)X
1 f
555 3760(object)N
771(manager.)X
755 3884(The)N
901(VOP_GETPAGE\(\))X
1541(routine)X
1789(is)X
1863(responsible)X
2249(for)X
2364(returning)X
2679(a)X
2736(list)X
2853(of)X
2940(pages)X
3143(from)X
3319(a)X
3375(range)X
3574(of)X
3661(a)X
2 f
3717(vnode.)X
1 f
3962(It)X
555 3980(typically)N
859(performs)X
1173(a)X
1233(page)X
1409(lookup)X
1655(operation)X
1981(to)X
2066(see)X
2192(if)X
2264(the)X
2385(pages)X
2591(are)X
2713(in)X
2798(memory.)X
3128(If)X
3205(the)X
3326(desired)X
3581(pages)X
3787(are)X
3909(not)X
555 4076(present,)N
834(the)X
959(routine)X
1213(does)X
1387(everything)X
1757(needed)X
2012(to)X
2101(read)X
2267(them)X
2454(in)X
2543(and)X
2686(initialize)X
2992(them.)X
3218(It)X
3293(has)X
3426(the)X
3550(opportunity)X
3949(to)X
555 4172(perform)N
835(operations)X
1189(appropriate)X
1575(to)X
1657(the)X
1775(underlying)X
2 f
2142(vnode)X
1 f
2367(object)X
2583(on)X
2683(each)X
2851(fault,)X
3038(such)X
3205(as)X
3292(updating)X
3592(the)X
3710 0.4531(reference)AX
555 4268(time)N
717(or)X
804(performing)X
1185(validity)X
1449(checks)X
1688(on)X
1788(cached)X
2032(pages.)X
755 4392(As)N
876(an)X
984(optimization,)X
1440(the)X
1570(VOP_GETPAGE\(\))X
2221(routine)X
2480(can)X
2624(return)X
2848(extra)X
3041(pages)X
3256(in)X
3349(addition)X
3642(to)X
3735(the)X
3864(ones)X
555 4488(requested.)N
935(This)X
1109(is)X
1194(appropriate)X
1592(when)X
1798(a)X
1866(physical)X
2165(read)X
2336(operation)X
2671(is)X
2756(needed)X
3016(to)X
3110(initialize)X
3422(the)X
3552(pages)X
3766(and)X
3913(the)X
2 f
555 4584(vnode)N
1 f
793(object)X
1022(manager)X
1332(tries)X
1503(to)X
1598(perform)X
1889(the)X
2019(I/O)X
2158(operation)X
2493(using)X
2698(a)X
2766(size)X
2923(optimal)X
3199(for)X
3325(the)X
3455(particular)X
3795(object.)X
555 4680(Before)N
802(this)X
945(is)X
1026(done)X
1210(the)X
1336(segment)X
1630(driver)X
1849(is)X
1929(consulted,)X
2283(using)X
2483(a)X
2546(``kluster'')X
2899(segment)X
3193(function,)X
3507(so)X
3605(that)X
3752(the)X
3877(seg-)X
555 4776(ment)N
788(driver)X
1053(has)X
1233(the)X
1404(opportunity)X
1850(to)X
1985(in\257uence)X
2352(the)X
2 f
2523(vnode)X
1 f
2801(object)X
3069(manager's)X
3476(decisions.)X
3886(The)X
555 4872(VOP_GETPAGE\(\))N
1196(routine)X
1445(also)X
1596(handles)X
1863 0.3611(read-ahead)AX
2239(if)X
2310(it)X
2376(detects)X
2621(a)X
2679(sequential)X
3025(access)X
3252(pattern)X
3496(on)X
3597(the)X
2 f
3716(vnode.)X
1 f
3962(It)X
555 4968(uses)N
735(the)X
875(same)X
1082(segment)X
1391(kluster)X
1651(function)X
1960(to)X
2064(verify)X
2298(that)X
2460(the)X
2600(segment)X
2909(driver)X
3143(believes)X
3448(that)X
3609(it)X
3694(would)X
3935(be)X
555 5064(worthwhile)N
944(to)X
1029(perform)X
1311(the)X
1432 0.3611(read-ahead)AX
1809(operation.)X
2175(The)X
2323(I/O)X
2453(klustering)X
2796(and)X
2935 0.3611(read-ahead)AX
3312(conditions)X
3668(allow)X
3869(both)X
555 5160(the)N
2 f
681(vnode)X
1 f
914(object)X
1138(manager)X
1443(and)X
1587(the)X
1713(segment)X
2008(driver)X
2228(controlling)X
2607(a)X
2671(mapping)X
2979(onto)X
3149(this)X
3292(object)X
3516(to)X
3605(have)X
3784(control)X
555 5256(over)N
719(how)X
878(these)X
1064(conditions)X
1418(are)X
1538(handled.)X
1853(Thus,)X
2054(for)X
2169(these)X
2355(conditions)X
2709(we)X
2823(have)X
2995(set)X
3104(up)X
3204(our)X
3331(object-oriented)X
3837(inter-)X
555 5352(faces)N
755(to)X
851(allow)X
1063(distributed)X
1439(control)X
1700(among)X
1951(different)X
2261(abstractions)X
2677(that)X
2830(have)X
3015(different)X
3325(pieces)X
3559(of)X
3659(knowledge)X
555 5448(about)N
758(a)X
819(particular)X
1152(problem.)X
1483(The)X
2 f
1632(vnode)X
1 f
1861(object)X
2081(manager)X
2382(has)X
2513(knowledge)X
2889(about)X
3091(preferred)X
3411(I/O)X
3542(size)X
3691(and)X
3831(refer-)X
555 5544(ence)N
727(patterns)X
1004(to)X
1089(the)X
1210(underlying)X
1580(object,)X
1819(whereas)X
2106(the)X
2227(segment)X
2517(driver)X
2732(has)X
2862(the)X
2983(knowledge)X
3358(about)X
3559(the)X
3680(view)X
3859(esta-)X
555 5640(blished)N
810(to)X
896(this)X
1035(object)X
1255(and)X
1395(may)X
1557(have)X
1733(advice)X
1967(passed)X
2205(in)X
2291(from)X
2471(above)X
2686(the)X
2807(address)X
3071(space)X
3273(regarding)X
3604(the)X
3725(expected)X
555 5736 0.4531(reference)AN
876(pattern)X
1119(to)X
1201(the)X
1319(virtual)X
1548(address)X
1809(space.)X
2243 6144(12)N

13 p
%%Page: 13 13
10 s 0 xH 0 xS 1 f
755 672(The)N
909(other)X
1102(new)X
2 f
1264(vnode)X
1 f
1497(operation)X
1828(for)X
1950(page)X
2130(management)X
2568(is)X
2649(VOP_PUTPAGE\(\).)X
3331(This)X
3501(operation)X
3832(is)X
3913(the)X
555 768(complement)N
983(of)X
1082(VOP_GETPAGE\(\))X
1733(and)X
1881(handles)X
2158(writing)X
2421(back)X
2605(potentially)X
2979(dirty)X
3162(pages.)X
3417(A)X
3507(\257ags)X
3689(parameter)X
555 864(controls)N
841(whether)X
1128(the)X
1254(write)X
1447(back)X
1627(operation)X
1958(is)X
2039(performed)X
2401(asynchronously)X
2931(and)X
3074(whether)X
3360(the)X
3485(pages)X
3695(should)X
3935(be)X
555 960(invalidated)N
931(after)X
1099(being)X
1297(written)X
1544(back.)X
755 1084(The)N
906(VOP_GETPAGE\(\))X
1551(and)X
1692(VOP_PUTPAGE\(\))X
2331(interfaces)X
2669(deal)X
2828(with)X
2995(offsets)X
3234(and)X
3375(pages)X
3583(in)X
3670(the)X
3793(logical)X
555 1180(\256le.)N
721(No)X
843(information)X
1245(about)X
1447(the)X
1569(physical)X
1860(layout)X
2084(of)X
2174(the)X
2295(\256le)X
2420(is)X
2496(visible)X
2732(above)X
2947(the)X
2 f
3068(vnode)X
1 f
3296(interface.)X
3641(This)X
3806(means)X
555 1276(that)N
706(the)X
835(work)X
1031(of)X
1129(translating)X
1498(from)X
1684(logical)X
1932(blocks)X
2171(to)X
2263(physical)X
2560(disk)X
2723(blocks)X
2962(\(the)X
2 f
3117(bmap)X
1 f
3338(function\))X
3662(is)X
3745(all)X
3855(done)X
555 1372(within)N
786(the)X
2 f
910(vnode)X
1 f
1141(routines)X
1425(that)X
1571(implement)X
1939(the)X
2063(VOP_GETPAGE\(\))X
2708(and)X
2850(VOP_PUTPAGE\(\))X
3490(interfaces.)X
3869(This)X
555 1468(is)N
631(a)X
690(clean)X
883(and)X
1022(logical)X
1262(separation)X
1614(of)X
1703(the)X
1823(\256le)X
1947(object)X
2165(abstractions)X
2570(from)X
2748(the)X
2868(VM)X
3019(abstractions)X
3424(and)X
3562(contrasts)X
3869(with)X
555 1564(the)N
679(old)X
807(4.2BSD-based)X
1298(implementation)X
1826(where)X
2049(the)X
2173(physical)X
2465(locations)X
2779(of)X
2871(\256le)X
2998(system)X
3245(blocks)X
3479(appeared)X
3795(in)X
3882(VM)X
555 1660(data)N
709(structures.)X
3 f
555 1852(8.)N
655(UFS)X
826(File)X
975(System)X
1240(Rework)X
1 f
755 1976(Another)N
1038(dif\256cult)X
1311(issue)X
1491(pertinent)X
1796(to)X
1878(the)X
1996(conversion)X
2368(to)X
2450(a)X
2506(memory-mapped,)X
3094(page-based)X
3476(system)X
3718(is)X
3791(how)X
3949(to)X
555 2072(convert)N
821(existing)X
1099(\256le)X
1226(systems.)X
1544(The)X
1694(most)X
1874(notable)X
2134(of)X
2225(these)X
2414(in)X
2500(SunOS)X
2750(is)X
2827(the)X
2949(4.2BSD)X
3228(\256le)X
3354(system)X
3600([8],)X
3738(which)X
3958(is)X
555 2168(known)N
806(in)X
901(SunOS)X
1160(as)X
1260(the)X
9 s
1389(UNIX)X
10 s
1602(File)X
1759(System)X
2027(\(UFS\).)X
2299(The)X
2456(relevant)X
2747(characteristics)X
3239(of)X
3338(this)X
3485(\256le)X
3619(system)X
3873(type)X
555 2264(include)N
814(support)X
1077(for)X
1194(two)X
1337(different)X
1637(blocking)X
1940(sizes)X
2119(\(a)X
2205(large)X
2389(basic)X
2577(block)X
2778(size)X
2926(for)X
3042(speed,)X
3267(and)X
3405(a)X
3463(smaller)X
3721(fragment)X
555 2360(size)N
703(to)X
788(avoid)X
989(excessive)X
1320(disk)X
1476(waste\),)X
1729(the)X
1850(ability)X
2077(to)X
2162(have)X
2337(unallocated)X
2730(blocks)X
2961(\(``holes''\))X
3314(in)X
3398(the)X
3518(middle)X
3762(of)X
3851(a)X
3909(\256le)X
555 2456(which)N
771(read)X
930(back)X
1102(as)X
1189(zeroes,)X
1435(and)X
1571(the)X
1689(need)X
1861(to)X
2 f
1943(bmap)X
1 f
2154(from)X
2330(logical)X
2568(blocks)X
2797(in)X
2879(the)X
2997(\256le)X
3119(to)X
3201(physical)X
3488(disk)X
3641(blocks.)X
3 f
555 2648(8.1.)N
715(Sparse)X
966(UFS)X
1137(File)X
1286(Management)X
2 f
755 2772(ufs_getpage)N
1 f
1155(\(\))X
1240(is)X
1324(the)X
1453(UFS)X
1630(routine)X
1888(that)X
2039(implements)X
2443(the)X
2572(VOP_GETPAGE\(\))X
3222(interface.)X
3575(When)X
3798(a)X
3864(fault)X
555 2868(occurs)N
788(on)X
891(a)X
950(UFS)X
1118(\256le,)X
1262(the)X
1382(segment)X
1671(driver)X
1885(fault)X
2054(routine)X
2303(calls)X
2472(this)X
2609(routine,)X
2878(passing)X
3140(it)X
3206(the)X
3326(type)X
3486(of)X
3575(the)X
3695(attempted)X
555 2964(access)N
794(\(e.g.,)X
990(read)X
1162(or)X
1262(write)X
1460(access\).)X
1766(It)X
1848(uses)X
2019(this)X
2167(access)X
2406(type)X
2577(information)X
2988(to)X
3083(determine)X
3437(what)X
3626(to)X
3720(do)X
3832(if)X
3913(the)X
555 3060(requested)N
893(page)X
1075(corresponds)X
1493(to)X
1585(an)X
1691(as)X
1787(yet)X
1914(unallocated)X
2313(section)X
2569(of)X
2665(a)X
2730(sparse)X
2960(\256le.)X
3131(If)X
3214(a)X
3279(write)X
3473(access)X
3708(to)X
3799(one)X
3944(of)X
555 3156(these)N
742(holes)X
933(in)X
1017(the)X
1137(\256le)X
1260(is)X
1334(attempted,)X
2 f
1691(ufs_getpage)X
1 f
2091(\(\))X
2166(will)X
2311(attempt)X
2572(to)X
2655(allocate)X
2926(the)X
3045(needed)X
3294(block\(s\))X
3578(of)X
3666(\256le)X
3789(system)X
555 3252(storage.)N
852(If)X
931(the)X
1053(allocation)X
1393(fails)X
1555(because)X
1834(there)X
2019(is)X
2096(no)X
2200(more)X
2389(space)X
2592(available)X
2906(in)X
2992(the)X
3114(\256le)X
3240(system,)X
3506(or)X
3597(the)X
3719(user)X
3877(pro-)X
555 3348(cess)N
713(has)X
844(exceeded)X
1168(its)X
1267(disk)X
1424(quota)X
1626(limit,)X
2 f
1820(ufs_getpage)X
1 f
2220(\(\))X
2298(returns)X
2545(the)X
2667(error)X
2848(back)X
3023(to)X
3108(the)X
3229(calling)X
3470(procedure)X
3815(which)X
555 3444(then)N
713(propagates)X
1081(back)X
1253(to)X
1335(the)X
1453(caller)X
1652(of)X
1739(address)X
2000(space)X
2199(fault)X
2366(routine.)X
755 3568(When)N
2 f
968(ufs_getpage)X
1 f
1368(\(\))X
1443(handles)X
1708(a)X
1764(read)X
1923(access)X
2149(to)X
2231(a)X
2287(page)X
2459(that)X
2599(does)X
2766(not)X
2888(have)X
3060(all)X
3160(its)X
3255(disk)X
3408(blocks)X
3637(allocated,)X
3967(it)X
555 3664(zeroes)N
786(out)X
913(the)X
1036(part)X
1186(of)X
1278(the)X
1401(page)X
1578(that)X
1723(is)X
1801(not)X
1928(backed)X
2181(by)X
2286(an)X
2387(allocated)X
2702(disk)X
2860(block)X
3063(and)X
3204(arranges)X
3502(for)X
3621(the)X
3744(segment)X
555 3760(driver)N
770(requesting)X
1127(the)X
1248(page)X
1423(to)X
1508(establish)X
1810(a)X
1868(read-only)X
2198(translation)X
2558(to)X
2642(it.)X
2748(Thus)X
2930(no)X
3032(allocation)X
3370(is)X
3445(done)X
3623(when)X
3819(a)X
3877(pro-)X
555 3856(cess)N
712(tries)X
873(to)X
958(read)X
1120(a)X
1179(hole)X
1340(from)X
1519(a)X
1578(UFS)X
1747(\256le.)X
1912(However,)X
2250(an)X
2349(attempted)X
2687(write)X
2874(access)X
3102(to)X
3186(such)X
3355(a)X
3413(page)X
3587(causes)X
3819(a)X
3877(pro-)X
555 3952(tection)N
820(fault)X
1014(and)X
2 f
1177(ufs_getpage)X
1 f
1577(\(\))X
1677(can)X
1835(perform)X
2140(the)X
2284(needed)X
2558(\256le)X
2706(system)X
2974(block)X
3198(allocation)X
3560(as)X
3673(previously)X
555 4048(described.)N
3 f
555 4240(8.2.)N
715(UFS)X
886(File)X
1035(Times)X
1 f
755 4364(Another)N
1040(set)X
1151(of)X
1240(problems)X
1559(resulted)X
1834(from)X
2011(handling)X
2312(the)X
2431(\256le)X
2554(access)X
2781(and)X
2918(modi\256ed)X
3223(times.)X
3457(The)X
3603(obvious)X
3877(way)X
555 4460(to)N
644(handle)X
885(this)X
1027(problem)X
1321(is)X
1401(to)X
1490(simply)X
1734(update)X
1975(the)X
2100(access)X
2333(time)X
2502(in)X
2 f
2591(ufs_getpage)X
1 f
2991(\(\))X
3072(any)X
3215(time)X
3384(a)X
3446(page)X
3624(is)X
3703(requested)X
555 4556(and)N
695(to)X
781(update)X
1019(the)X
1141(modi\256cation)X
1569(time)X
1735(in)X
2 f
1821(ufs_putpage)X
1 f
2225(\(\))X
2303(any)X
2443(time)X
2609(a)X
2668(dirty)X
2842(page)X
3017(is)X
3093(written)X
3343(back.)X
3558(However,)X
3896(this)X
555 4652(approach)N
870(has)X
997(some)X
1186(problems.)X
755 4776(The)N
909(\256rst)X
1062(problem)X
1358(is)X
1440(that)X
1589(the)X
1716(UFS)X
1891(implementation)X
2422(has)X
2557(never)X
2764(marked)X
3033(the)X
3159(access)X
3393(time)X
3563(when)X
3765(doing)X
3975(a)X
2 f
555 4872(write)N
1 f
758(to)X
846(the)X
970(\256le)X
8 s
1072 4847(10)N
10 s
4872(.)Y
1202(The)X
1353(second)X
1602(problem)X
1895(is)X
1974(related)X
2218(to)X
2305(getting)X
2552(the)X
2675(correct)X
2924(modi\256cation)X
3353(time)X
3520(when)X
3719(writing)X
3975(a)X
555 4968(\256le.)N
718(When)X
931(doing)X
1134(a)X
2 f
1191(write)X
1 f
1368(\(2\))X
1483(system)X
1726(call,)X
1883(the)X
2002(\256le)X
2125(is)X
2199(marked)X
2461(with)X
2624(the)X
2742(current)X
2990(time.)X
3192(When)X
3404(dirty)X
3575(pages)X
3778(created)X
555 5064(by)N
659(the)X
2 f
781(write)X
1 f
982(operation)X
1309(are)X
1432(actually)X
1710(pushed)X
1961(back)X
2137(to)X
2223(backing)X
2501(store)X
2681(in)X
2 f
2767(ufs_putpage)X
1 f
3171(\(\),)X
3268(we)X
3385(don't)X
3577(want)X
3756(to)X
3841(over-)X
555 5160(ride)N
700(the)X
818(modi\256cation)X
1242(time)X
1404(already)X
1661(stored)X
1877(in)X
1959(the)X
2 f
2077(inode)X
1 f
8 s
2268 5135(11)N
10 s
5160(.)Y
755 5284(To)N
864(solve)X
1053(these)X
1238(problems,)X
2 f
1576(inode)X
1 f
1787(\257ags)X
1958(are)X
2077(set)X
2186(in)X
2268(the)X
2386(``upper)X
2643(layers'')X
2909(of)X
2996(the)X
3114(UFS)X
3280(code)X
3452(\(e.g.,)X
3635(when)X
3829(doing)X
555 5380(a)N
621(\256le)X
753(read)X
922(or)X
1019(write)X
1214(operation\))X
1574(and)X
1719(examined)X
2060(in)X
2151(the)X
2278(``lower)X
2544(layers'')X
2819(of)X
2915(the)X
3042(UFS)X
3217(code)X
3398(\()X
2 f
3425(ufs_getpage)X
1 f
3812(\(\))X
3895(and)X
2 f
555 5476(ufs_putpage)N
1 f
946(\(\)\).)X
2 f
1089(ufs_getpage)X
1 f
1489(\(\))X
1565(examines)X
1890(the)X
2 f
2009(inode)X
1 f
2221(\257ags)X
2393(to)X
2476(determine)X
2818(whether)X
3098(to)X
3181(update)X
3416(the)X
2 f
3535(inode)X
1 f
3726('s)X
3805(access)X
8 s
10 f
555 5556(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5631(10)N
8 s
715 5650(The)N
830(``read'')X
1039(that)X
1151(is)X
1210(sometimes)X
1500(needed)X
1696(to)X
1762(perform)X
1983(a)X
2 f
2027(write)X
1 f
2186(operation)X
2443(never)X
2600(causes)X
2782(the)X
2876(\256le's)X
3020(access)X
3198(time)X
3328(to)X
3394(be)X
3470(updated.)X
6 s
635 5725(11)N
8 s
715 5744(The)N
2 f
830(inode)X
1 f
999(is)X
1058(the)X
1152(\256le)X
1250(system)X
1444(private)X
2 f
1637(vnode)X
1 f
1816(information)X
2134(used)X
2267(by)X
2347(the)X
2441(UFS)X
2575(\256le)X
2673(system)X
2867([2].)X
10 s
2243 6144(13)N

14 p
%%Page: 14 14
10 s 0 xH 0 xS 1 f
555 672(time)N
721(based)X
928(on)X
1032(whether)X
1315(a)X
1375(read)X
1538(or)X
1629(write)X
1818(operation)X
2144(is)X
2220(currently)X
2533(in)X
2618(progress.)X
2 f
2953(ufs_putpage)X
1 f
3357(\(\))X
3434(can)X
3569(use)X
3699(the)X
2 f
3820(inode)X
1 f
555 768(\257ags)N
750(to)X
856(determine)X
1220(whether)X
1522(it)X
1609(needs)X
1835(to)X
1940(update)X
2197(the)X
2 f
2338(inode)X
1 f
2529('s)X
2630(modi\256cation)X
3077(time)X
3262(based)X
3488(on)X
3611(whether)X
3913(the)X
555 864(modi\256cation)N
979(time)X
1141(has)X
1268(been)X
1440(set)X
1549(since)X
1734(the)X
1852(last)X
1983(time)X
2145(the)X
2 f
2263(inode)X
1 f
2474(was)X
2619(written)X
2866(back)X
3038(to)X
3120(disk.)X
3 f
555 1056(8.3.)N
715(UFS)X
886(Control)X
1173(Information)X
1 f
755 1180(Another)N
1043(dif\256cult)X
1321(issue)X
1505(related)X
1748(to)X
1834(the)X
1956(UFS)X
2126(\256le)X
2252(system)X
2498(and)X
2638(the)X
2760(VM)X
2913(system)X
3159(is)X
3236(dealing)X
3496(with)X
3662(the)X
3784(control)X
555 1276(information)N
956(that)X
1098(the)X
2 f
1218(vnode)X
1 f
1445(driver)X
1659(uses)X
1819(to)X
1903(manage)X
2175(the)X
2295(logical)X
2535(\256le.)X
2699(For)X
2832(the)X
2952(UFS)X
3120(implementation,)X
3664(the)X
3784(control)X
555 1372(information)N
960(consists)X
1240(of)X
1334(the)X
2 f
1459(inodes,)X
1 f
1728(indirect)X
1999(blocks,)X
2254(cylinder)X
2543(groups,)X
2807(and)X
2949(super)X
3149(blocks.)X
3424(The)X
3575(control)X
3828(infor-)X
555 1468(mation)N
803(is)X
882(not)X
1010(part)X
1161(of)X
1254(the)X
1378(logical)X
1622(\256le)X
1749(and)X
1890(thus)X
2048(the)X
2171(control)X
2423(information)X
2826(still)X
2970(needs)X
3178(to)X
3265(be)X
3366(named)X
3605(by)X
3710(the)X
3833(block)X
555 1564(device)N
792(offsets,)X
1053(not)X
1182(the)X
1307(logical)X
1552(\256le)X
1681(offsets.)X
1962(To)X
2078(provide)X
2350(the)X
2475(greatest)X
2752(\257exibility)X
3089(we)X
3210(decided)X
3487(to)X
3576(retain)X
3785(the)X
3909(old)X
555 1660(buffer)N
776(cache)X
984(code)X
1160(with)X
1326(certain)X
1569(modi\256cations)X
2028(for)X
2146(optional)X
2432(use)X
2563(by)X
2666(\256le)X
2791(system)X
3036(implementations.)X
3632(The)X
3780(biggest)X
555 1756(driving)N
808(force)X
995(behind)X
1234(this)X
1370(is)X
1444(that)X
1585(we)X
1700(did)X
1823(not)X
1946(want)X
2123(to)X
2206(rely)X
2352(on)X
2453(the)X
2572(system)X
2815(page)X
2988(size)X
3134(being)X
3333(smaller)X
3590(than)X
3749(or)X
3837(equal)X
555 1852(to)N
642(the)X
765(size)X
915(of)X
1007(control)X
1259(information)X
1662(boundaries)X
2039(for)X
2158(all)X
2263(\256le)X
2390(system)X
2637(implementations.)X
3234(Other)X
3441(reasons)X
3706(for)X
3824(main-)X
555 1948(taining)N
803(parts)X
985(of)X
1078(the)X
1201(old)X
1328(buffer)X
1550(cache)X
1759(code)X
1936(included)X
2237(some)X
2431(compatibility)X
2882(issues)X
3098(for)X
3217(customer)X
3536(written)X
3788(drivers)X
555 2044(and)N
695(\256le)X
821(systems.)X
1137(In)X
1227(current)X
1478(versions)X
1768(of)X
1858(SunOS,)X
2127(what's)X
2364(left)X
2494(of)X
2584(the)X
2705(old)X
2830(buffer)X
3050(cache)X
3257(is)X
3333(used)X
3503(strictly)X
3748(for)X
3865(UFS)X
555 2140(control)N
803(buffers.)X
1092(We)X
1225(did)X
1348(improve)X
1636(the)X
1755(old)X
1878(buffer)X
2096(code)X
2269(so)X
2361(that)X
2502(buffers)X
2750(are)X
2869(allocated)X
3179(and)X
3315(freed)X
3501(dynamically.)X
3957(If)X
555 2236(no)N
666(\256le)X
799(system)X
1052(types)X
1252(choose)X
1506(to)X
1599(use)X
1737(the)X
1866(old)X
1999(buffer)X
2227(cache)X
2442(code)X
2625(\(e.g.,)X
2818(a)X
2884(diskless)X
3167(system\),)X
3466(then)X
3634(no)X
3744(physical)X
555 2332(memory)N
848(will)X
998(be)X
1100(allocated)X
1416(to)X
1503(this)X
1643(pool.)X
1850(When)X
2067(the)X
2190(buffer)X
2412(cache)X
2621(is)X
2699(being)X
2902(used)X
3074(\(e.g.,)X
3262(for)X
3381(control)X
3633(information)X
555 2428(for)N
678(UFS)X
853(\256le)X
984(systems\),)X
1313(memory)X
1609(allocated)X
1928(to)X
2019(the)X
2145(buffer)X
2370(pool)X
2540(will)X
2692(be)X
2796(freed)X
2990(when)X
3192(demand)X
3474(for)X
3596(these)X
3789(system)X
555 2524(resources)N
879(decreases.)X
3 f
555 2716(9.)N
655(System)X
920(Changes)X
1 f
755 2840(With)N
937(the)X
1057(conversion)X
1431(to)X
1515(the)X
1635(new)X
1790(VM)X
1940(system,)X
2203(many)X
2402(closely)X
2650(related)X
2890(parts)X
3067(of)X
3155(the)X
3274(SunOS)X
3521(kernel)X
3743(required)X
555 2936(change)N
803(as)X
890(well.)X
1088(For)X
1219(the)X
1337(most)X
1512(part)X
1657(time)X
1819(constraints)X
2186(persuaded)X
2532(us)X
2623(to)X
2705(retain)X
2908(the)X
3026(old)X
3148(algorithms)X
3510(and)X
3646(policies.)X
3 f
555 3128(9.1.)N
715(Paging)X
1 f
755 3252(The)N
904(use)X
1034(of)X
1124(the)X
1245(global)X
1468(clock)X
1665(replacement)X
2081(algorithm)X
2415(implemented)X
2856(in)X
2941(4.2BSD)X
3219(and)X
3358(extended)X
3671(in)X
3756(4.3BSD)X
555 3348(is)N
645(retained)X
941(under)X
1161(the)X
1295(new)X
1465(VM)X
1630(system.)X
1928(The)X
2089(``clock)X
2353(hands'')X
2630(now)X
2804(sweep)X
3041(over)X
2 f
3220(page)X
1 f
3425(structures,)X
3793(calling)X
2 f
555 3444(hat_pagesync)N
1 f
1009(\(\))X
1085(on)X
1187(each)X
1357(eligible)X
2 f
1619(page)X
1 f
1810(to)X
1894(sync)X
2062(back)X
2235(the)X
2354 0.4531(reference)AX
2676(and)X
2813(modi\256ed)X
3118(bits)X
3254(from)X
3431(all)X
3532(the)X
3651(hat)X
3770(transla-)X
555 3540(tions)N
738(to)X
828(that)X
976(page.)X
1196(If)X
1278(a)X
1342(dirty)X
1521(page)X
1701(needs)X
1912(to)X
2002(be)X
2105(written)X
2359(back,)X
2558(the)X
2683(page)X
2862(daemon)X
3143(uses)X
3308(VOP_PUTPAGE\(\))X
3949(to)X
555 3636(write)N
740(back)X
912(the)X
1030(dirty)X
1201(page.)X
3 f
555 3828(9.2.)N
715(Swapping)X
1 f
755 3952(We)N
895(retained)X
1182(the)X
1308(basic)X
1501(notion)X
1733(of)X
1828(``swapping'')X
2271(a)X
2335(process.)X
2644(Under)X
2873(the)X
2999(new)X
3160(VM)X
3316(system)X
3565(there)X
3753(is)X
3833(much)X
555 4048(more)N
743(sharing)X
1002(going)X
1207(on)X
1310(than)X
1470(was)X
1617(present)X
1871(in)X
1955(4.2BSD)X
2232(where)X
2451(the)X
2571(only)X
2735(sharing)X
2993(was)X
3140(done)X
3318(explicitly)X
3642(via)X
3762(the)X
2 f
3882(text)X
1 f
555 4144(table.)N
787(Now)X
978(a)X
1049(process's)X
1383(address)X
1659(space)X
1873(may)X
2046(have)X
2233(several)X
2496(shared)X
2741(mappings,)X
3107(making)X
3382(it)X
3461(more)X
3661(dif\256cult)X
3949(to)X
555 4240(understand)N
937(the)X
1065(memory)X
1362(demands)X
1677(for)X
1801(an)X
1907(address)X
2178(space.)X
2427(This)X
2599(fact)X
2749(is)X
2831(made)X
3034(more)X
3228(obvious)X
3510(with)X
3681(the)X
3808(use)X
3944(of)X
555 4336(shared)N
785(libraries)X
1068([9,)X
1175(10].)X
755 4460(The)N
912(address)X
1185(space)X
1395(provides)X
1702(an)X
1809(address)X
2081(space)X
2291(swap)X
2487(out)X
2620(operation)X
2 f
2954(as_swapout)X
1 f
3344(\(\))X
3429(which)X
3656(the)X
3785(SunOS)X
555 4556(kernel)N
787(uses)X
956(when)X
1161(swapping)X
1499(out)X
1632(a)X
1699(process.)X
2011(This)X
2184(procedure)X
2537(handles)X
2812(writing)X
3073(back)X
3255(dirty)X
3436(pages)X
3649(that)X
3799(the)X
2 f
3927(as)X
1 f
555 4652(maps)N
750(and)X
892(that)X
1038(no)X
1144(longer)X
1375(have)X
1553(any)X
1695(MMU)X
1921(translations)X
2316(after)X
2490(all)X
2596(the)X
2720(resources)X
3050(for)X
3170(the)X
2 f
3294(as)X
1 f
3403(being)X
3606(swapped)X
3912(are)X
555 4748(freed.)N
787(The)X
2 f
938(as_swapout)X
1 f
1328(\(\))X
1408(operation)X
1737(returns)X
1986(the)X
2110(number)X
2381(of)X
2474(bytes)X
2669(actually)X
2949(freed)X
3141(by)X
3247(the)X
3371(swap)X
3561(out)X
3688(operation.)X
555 4844(The)N
702(swapper)X
992(saves)X
1188(this)X
1325(value)X
1521(as)X
1610(a)X
1668(working)X
1957(set)X
2068(estimate)X
8 s
2335 4819(12)N
10 s
4844(,)Y
2441(using)X
2636(it)X
2702(later)X
2867(to)X
2950(determine)X
3292(when)X
3487(enough)X
3744(memory)X
555 4940(has)N
683(become)X
953(available)X
1263(to)X
1345(swap)X
1530(the)X
1648(process)X
1909(back)X
2081(in.)X
2203(Also)X
2374(written)X
2621(back)X
2793(on)X
2893(a)X
2949(process)X
3210(swap)X
3395(out)X
3517(operation)X
3840(is)X
3913(the)X
555 5036(process's)N
874(user)X
1028(area,)X
1203(which)X
1419(is)X
1492(set)X
1601(up)X
1701(to)X
1783(look)X
1945(like)X
2085(anonymous)X
2474(memory)X
2761(pages.)X
755 5160(The)N
2 f
909(as)X
1 f
1022(and)X
1167(segment)X
1463(structures)X
1803(used)X
1978(to)X
2068(describe)X
2364(the)X
2490(machine)X
2790(independent)X
3210(mappings)X
3549(of)X
3644(the)X
3770(address)X
555 5256(space)N
761(for)X
882(the)X
1007(process)X
1275(are)X
1401(currently)X
1718(not)X
1847(swapped)X
2155(out)X
2284(with)X
2453(the)X
2578(process)X
2846(since)X
3038(we)X
3159(don't)X
3355(yet)X
3480(have)X
3659(the)X
3783(needed)X
555 5352(support)N
817(in)X
901(the)X
1021(kernel)X
1244(dynamic)X
1542(memory)X
1831(allocator.)X
2174(This)X
2338(differs)X
2569(from)X
2746(the)X
2865(4.2BSD)X
3141(VM)X
3291(implementation)X
3814(where)X
555 5448(the)N
673(page)X
845(tables)X
1052(used)X
1219(to)X
1301(describe)X
1589(the)X
1707(address)X
1968(space)X
2167(are)X
2286(written)X
2533(back)X
2705(as)X
2792(part)X
2937(of)X
3024(the)X
3142(swap)X
3327(out)X
3449(operation.)X
8 s
10 f
555 5570(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5645(12)N
8 s
715 5664(Unfortunately,)N
1105(a)X
1149(poor)X
1282(one;)X
1408(this)X
1517(is)X
1576(an)X
1652(opportunity)X
1967(for)X
2057(future)X
2225(improvement.)X
10 s
2243 6144(14)N

15 p
%%Page: 15 15
10 s 0 xH 0 xS 1 f
3 f
555 672(9.3.)N
715(System)X
980(Calls)X
1 f
755 796(We)N
902(rewrote)X
1183(many)X
1396(traditional)X
9 s
1758(UNIX)X
10 s
1973(system)X
2230(calls)X
2412(to)X
2509(manipulate)X
2900(the)X
3033(process's)X
3367(user)X
3536(address)X
3812(space.)X
555 892(These)N
773(calls)X
946(include)X
2 f
1208(fork,)X
1396(exec,)X
1599(brk,)X
1 f
1765(and)X
2 f
1907(ptrace.)X
1 f
2171(For)X
2307(example,)X
2624(the)X
2 f
2747(fork)X
1 f
2914(system)X
3161(call)X
3302(uses)X
3465(an)X
3566(address)X
3832(space)X
555 988(duplication)N
942(operation.)X
1312(An)X
2 f
1437(exec)X
1 f
1621(system)X
1870(call)X
2013(destroys)X
2307(the)X
2432(old)X
2561(address)X
2829(space.)X
3075(For)X
3213(a)X
3276(demand)X
3556(paged)X
3774(execut-)X
555 1084(able)N
716(it)X
787(then)X
952(creates)X
1203(a)X
1266(new)X
1427(address)X
1695(space)X
1901(using)X
2101(mappings)X
2439(to)X
2528(the)X
2652(executable)X
3022(\256le.)X
3190(For)X
3327(further)X
3572(discussion)X
3931(on)X
555 1180(how)N
713(these)X
898(system)X
1140(calls)X
1307(were)X
1484(implemented)X
1922(as)X
2009(address)X
2270(space)X
2469(operations)X
2823(see)X
2946([1].)X
755 1304(Memory)N
1055(management)X
1489(related)X
1731(system)X
1976(calls)X
2146(based)X
2352(on)X
2455(the)X
2576(original)X
2848(4.2BSD)X
3126(speci\256cation)X
3554([11])X
3711(that)X
3854(were)X
555 1400(implemented)N
1003(include)X
2 f
1269(mmap,)X
1528(munmap,)X
1867(mprotect,)X
2215(madvise,)X
1 f
2541(and)X
2 f
2687(mincore.)X
1 f
3012(In)X
3108(addition,)X
3419(the)X
2 f
3546(msync)X
1 f
3789(system)X
555 1496(call)N
691(was)X
836(de\256ned)X
1092(and)X
1228(implemented.)X
1706(For)X
1837(further)X
2076(discussion)X
2429(on)X
2529(these)X
2714(system)X
2956(calls)X
3123(see)X
3246([1].)X
3 f
555 1688(9.4.)N
715(User)X
896(Area)X
1 f
755 1812(The)N
9 s
913(UNIX)X
10 s
1128(user)X
1296(area)X
1465(is)X
1552(typically)X
1866(used)X
2047(to)X
2143(hold)X
2319(the)X
2451(process's)X
2784(supervisor)X
3152(state)X
3333(stack)X
3532(and)X
3682(other)X
3881(per-)X
555 1908(process)N
822(information)X
1226(that)X
1372(is)X
1451(needed)X
1705(only)X
1873(when)X
2073(the)X
2196(process)X
2462(is)X
2540(in)X
2627(core.)X
2831(Currently)X
3163(the)X
3286(user)X
3445(area)X
3605(for)X
3724(a)X
3785(SunOS)X
9 s
555 2004(UNIX)N
10 s
756(process)X
1018(is)X
1092(still)X
1232(at)X
1311(a)X
1368(\256xed)X
1549(virtual)X
1779(address)X
2041(as)X
2129(is)X
2203(done)X
2380(with)X
2543(most)X
2718(traditional)X
9 s
3065(UNIX)X
10 s
3265(systems.)X
3578(However,)X
3913(the)X
555 2100(user)N
711(area)X
868(is)X
943(specially)X
1250(managed)X
1562(so)X
1654(context)X
1911(switching)X
2243(can)X
2376(be)X
2473(done)X
2650(as)X
2738(quickly)X
2999(as)X
3087(possible)X
3370(using)X
3564(a)X
3621(\256xed)X
3802(virtual)X
555 2196(address.)N
864(There)X
1080(are)X
1207(several)X
1463(reasons)X
1732(why)X
1898(we)X
2020(want)X
2204(to)X
2293(convert)X
2561(to)X
2650(a)X
2713(scheme)X
2981(where)X
3205(the)X
3330(user)X
3491(areas)X
3684(are)X
3810(at)X
3895(dif-)X
555 2292(ferent)N
771(virtual)X
1008(addresses)X
1343(in)X
1432(the)X
1557(kernel's)X
1843(address)X
2111(space.)X
2357(Among)X
2624(them)X
2811(are)X
2937(faster)X
3143(context)X
3406(switching)X
8 s
3717 2267(13)N
10 s
2292(,)Y
3828(better)X
555 2388(support)N
819(for)X
937(multi-threaded)X
1433(address)X
1698(spaces,)X
1952(and)X
2092(a)X
2152(more)X
2341(uniform)X
2623(treatment)X
2949(of)X
3039(kernel)X
3263(memory.)X
3593(In)X
3683(particular,)X
555 2484(we)N
671(are)X
792(moving)X
1058(toward)X
1303(a)X
3 f
1361(seg_u)X
1 f
1574(driver)X
1788(that)X
1930(can)X
2064(be)X
2162(used)X
2331(to)X
2415(manage)X
2687(a)X
2744(chunk)X
2961(of)X
3049(kernel)X
3271(virtual)X
3501(memory)X
3789(for)X
3904(use)X
555 2580(as)N
642(u-areas.)X
3 f
555 2772(10.)N
695(Performance)X
1 f
755 2896(A)N
842(project)X
1094(goal)X
1260(for)X
1382(the)X
1508(new)X
1670(VM)X
1827(work)X
2020(was)X
2173(to)X
2263(provide)X
2536(more)X
2729(functionality)X
3166(without)X
3438(degrading)X
3787(perfor-)X
555 2992(mance.)N
838(However,)X
1186(we)X
1313(have)X
1497(found)X
1716(that)X
1868(certain)X
2119(benchmarks)X
2539(show)X
2740(substantial)X
3114(performance)X
3553(improvements)X
555 3088(because)N
835(of)X
927(the)X
1050(much)X
1252(larger)X
1464(cache)X
1672(available)X
1986(for)X
2104(I/O)X
2235(operations.)X
2633(There)X
2845(is)X
2922(still)X
3065(much)X
3267(that)X
3411(can)X
3547(be)X
3647(done)X
3827(to)X
3913(the)X
555 3184(system)N
797(as)X
884(a)X
940(whole)X
1156(by)X
1256(taking)X
1476(advantage)X
1822(of)X
1909(the)X
2027(new)X
2181(facilities.)X
755 3308(Table)N
965(2)X
1032(shows)X
1259(some)X
1454(benchmarks)X
1868(that)X
2014(highlight)X
2328(the)X
2452(effects)X
2693(of)X
2786(the)X
2910(new)X
3070(VM)X
3225(system)X
3473(and)X
3615(dynamically)X
555 3404(linked)N
781(shared)X
1017(libraries)X
1306([9,)X
1419(10])X
1552(over)X
1721(SunOS)X
1973(Release)X
2249(3.2.)X
2 f
2415(Dynamic)X
1 f
2744(linking)X
2996(refers)X
3206(to)X
3294(delaying)X
3596(the)X
3720(\256nal)X
3887(link)X
555 3500(edit)N
697(process)X
960(until)X
1128(run)X
1257(time.)X
1461(The)X
1608(traditional)X
9 s
1957(UNIX)X
10 s
2158(model)X
2379(is)X
2453(based)X
2657(on)X
2 f
2758(static)X
1 f
2965(linking)X
3212(in)X
3295(which)X
3512(executable)X
3877(pro-)X
555 3596(grams)N
771(are)X
890(completely)X
1266(bound)X
1486(to)X
1568(all)X
1668(their)X
1835(libraries)X
2118(routines)X
2396(at)X
2474(program)X
2766(link)X
2910(time)X
3072(using)X
2 f
3265(ld)X
1 f
3340(\(1\).)X
755 3720(Running)N
1060(a)X
1126(new)X
1290(VM)X
1449(kernel)X
1680(with)X
1852(same)X
2047(3.2)X
2177(binaries)X
2461(clearly)X
2710(shows)X
2940(that)X
3090(the)X
3218(new)X
3382(VM)X
3540(system)X
3791(and)X
3936(its)X
555 3816(associated)N
909(\256le)X
1035(system)X
1281(changes)X
1563(has)X
1693(a)X
1752(positive)X
2028(performance)X
2458(impact.)X
2739(The)X
2887(effect)X
3094(of)X
3184(the)X
3305(larger)X
3516(system)X
3761(caching)X
555 3912(effects)N
790(can)X
922(be)X
1018(seen)X
1181(in)X
1263(the)X
1381(read)X
1540(times.)X
755 4036(One)N
914(way)X
1073(that)X
1218(the)X
1341(system)X
1588(uses)X
1751(the)X
1873(new)X
2031(VM)X
2184(architecture)X
2588(is)X
2665(a)X
2725(dynamically)X
3145(linked)X
3369(shared)X
3603(library)X
3841(facil-)X
555 4132(ity.)N
701(The)X
2 f
848(fork)X
1 f
1012(and)X
2 f
1150(exec)X
1 f
1329(benchmarks)X
1739(show)X
1930(that)X
2071(the)X
2190(\257exibility)X
2521(provided)X
2827(by)X
2928(this)X
3064(facility)X
3312(is)X
3386(not)X
3509(free.)X
3696(However,)X
555 4228(the)N
674(bene\256ts)X
944(of)X
1032(the)X
1151(VM)X
1301(architecture)X
1701(that)X
1841(provides)X
2137(copy-on-write)X
2612(facilities)X
2908(more)X
3093(than)X
3251(compensate)X
3650(for)X
3764(the)X
3882(cost)X
555 4324(of)N
650(duplicating)X
1038(mappings)X
1377(to)X
1467(shared)X
1705(libraries)X
1996(in)X
2086(the)X
2 f
2212(fork)X
1 f
2382(benchmark.)X
2806(The)X
2 f
2958(exec)X
1 f
3142(benchmark)X
3526(is)X
3606(the)X
3731(only)X
3900(test)X
555 4420(that)N
704(showed)X
977(performance)X
1412(degradation)X
1819(from)X
2003(dynamically)X
2427(linked)X
2655(executables)X
3058(over)X
3229(statically)X
3546(linked)X
3774(execut-)X
555 4516(ables)N
753(run)X
893(with)X
1068(a)X
1136(SunOS)X
1394(Release)X
1676(3.2)X
1808(kernel.)X
2081(These)X
2305(numbers)X
2613(show)X
2814(that)X
2966(the)X
3096(startup)X
3346(cost)X
3507(associated)X
3869(with)X
555 4612(dynamically)N
973(linking)X
1221(at)X
1301(run)X
1430(time)X
1594(is)X
1669(currently)X
1981(about)X
2181(74)X
2283(milliseconds.)X
2749(These)X
2963(results)X
3194(are)X
3314(preliminary)X
3709(and)X
3846(more)X
555 4708(work)N
747(will)X
898(be)X
1001(undertaken)X
1385(to)X
1474(streamline)X
1835(startup)X
2080(costs)X
2267(for)X
2388(dynamically)X
2811(linked)X
3038(executables.)X
3480(We)X
3619(feel)X
3767(that)X
3913(the)X
555 4804(added)N
773(functionality)X
1208(provided)X
1519(by)X
1625(the)X
1749(dynamic)X
2051(binding)X
2320(facilities)X
2621(more)X
2811(than)X
2974(offsets)X
3213(the)X
3336(performance)X
3768(loss)X
3917(for)X
555 4900(programs)N
878(dominated)X
1236(by)X
1336(start)X
1494(up)X
1594(costs.)X
3 f
555 5092(11.)N
695(Future)X
951(Work)X
1 f
755 5216(The)N
909(largest)X
1152(remaining)X
1506(task)X
1664(is)X
1746(to)X
1837(incorporate)X
2232(better)X
2443(resource)X
2744(control)X
2999(policies)X
3276(so)X
3375(that)X
3523(the)X
3649(system)X
3899(can)X
555 5312(make)N
770(more)X
975(intelligent)X
1339(decisions)X
1677(based)X
1900(on)X
2020(increased)X
2364(system)X
2626(knowledge.)X
3058(We)X
3210(plan)X
3388(to)X
3490(investigate)X
3877(new)X
555 5408(management)N
988(policies)X
1260(for)X
1377(page)X
1552(replacement)X
1968(and)X
2107(for)X
2224(better)X
2429(integration)X
2798(of)X
2887(memory)X
3176(and)X
3314(processor)X
3644(scheduling.)X
555 5504(We)N
698(believe)X
961(that)X
1112(the)X
1241(VM)X
1401(abstractions)X
1815(already)X
2083(devised)X
2359(will)X
2514(provide)X
2790(the)X
2919(hooks)X
3140(needed)X
3398(to)X
3490(do)X
3600(this.)X
3785(SunOS)X
8 s
10 f
555 5584(\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211\211)N
6 s
1 f
635 5659(13)N
8 s
715 5678(This)N
848(is)X
910(especially)X
1184(true)X
1302(with)X
1435(a)X
1482(virtual)X
1668(address)X
1878(cache)X
2041(and)X
2152(a)X
2199(\256xed)X
2346(user)X
2471(area)X
2595(virtual)X
2781(address,)X
3006(since)X
3155(the)X
3251(old)X
3351(user)X
3475(area)X
3598(must)X
555 5758(be)N
631(\257ushed)X
832(before)X
1010(the)X
1104(mapping)X
1344(to)X
1410(the)X
1504(new)X
1626(user)X
1748(area)X
1869(at)X
1931(the)X
2025(same)X
2172(virtual)X
2355(address)X
2562(can)X
2666(be)X
2742(established.)X
10 s
2243 6144(15)N

16 p
%%Page: 16 16
10 s 0 xH 0 xS 1 f
10 f
574 736(_)N
591(_____________________________________________________________________________________)X
3 f
989 832(Kernel)N
1245(Tested)X
1 f
1987(SunOS)X
2233(3.2)X
2473(Pre-release)X
2851(New)X
3023(VM)X
3272(Pre-release)X
3650(New)X
3822(VM)X
10 f
574 848(_)N
591(_____________________________________________________________________________________)X
3 f
920 944(Binaries)N
1224(Executed)X
1 f
2110(3.2)X
2762(3.2)X
3281(Dynamically)X
3715(Linked)X
10 f
574 952(_)N
591(_____________________________________________________________________________________)X
574 968(_)N
591(_____________________________________________________________________________________)X
3 f
946 1056(Tests)N
1144(Performed)X
1967(Time)X
2165(\(secs\))X
2619(Time)X
2817(\(secs\))X
3418(Time)X
3616(\(secs\))X
1 f
10 f
574 1072(_)N
591(_____________________________________________________________________________________)X
2 f
614 1168(exec)N
1 f
778(112k)X
958(program)X
1250(100)X
1390(times)X
2110(7.3)X
2762(3.3)X
3541(10.7)X
2 f
614 1264(fork)N
1 f
763(112k)X
943(program)X
1235(200)X
1375(times)X
2110(8.8)X
2762(4.4)X
3561(7.7)X
614 1360(Recursive)N
955(stat)X
1086(of)X
1173(125)X
1313(directories)X
2110(4.9)X
2762(1.4)X
3561(1.3)X
614 1456(Page)N
790(out)X
912(1)X
972(Mb)X
1103(to)X
1185(swap)X
1370(space)X
2110(2.0)X
2762(2.0)X
3561(0.8)X
614 1552(Page)N
790(in)X
872(1)X
932(Mb)X
1063(from)X
1239(swap)X
1424(space)X
2110(4.6)X
2762(3.8)X
3561(3.5)X
614 1648(Demand)N
906(page)X
1078(in)X
1160(1)X
1220(Mb)X
1351(executable)X
2110(1.7)X
2762(0.9)X
3561(0.8)X
614 1744(Sequentially)N
1034(read)X
1193(1)X
1253(Mb)X
1384(\256le)X
1506(\(1st)X
1646(time\))X
2110(1.6)X
2762(1.5)X
3561(1.5)X
614 1840(Sequentially)N
1034(read)X
1193(1)X
1253(Mb)X
1384(\256le)X
1506(\(2nd)X
1673(time\))X
2110(1.6)X
2762(0.4)X
3561(0.4)X
614 1936(Random)N
905(read)X
1064(of)X
1151(1)X
1211(Mb)X
1342(\256le)X
2110(5.7)X
2762(0.7)X
3561(0.8)X
614 2032(Create)N
844(and)X
980(delete)X
1192(100)X
1332(tmp)X
1476(\256les)X
2110(6.3)X
2762(4.7)X
3561(4.7)X
10 f
574 2048(_)N
591(_____________________________________________________________________________________)X
574(\207)X
2016(\207)Y
1936(\207)Y
1856(\207)Y
1776(\207)Y
1696(\207)Y
1616(\207)Y
1536(\207)Y
1456(\207)Y
1376(\207)Y
1296(\207)Y
1216(\207)Y
1136(\207)Y
1056(\207)Y
976(\207)Y
896(\207)Y
816(\207)Y
3991 2048(\207)N
2016(\207)Y
1936(\207)Y
1856(\207)Y
1776(\207)Y
1696(\207)Y
1616(\207)Y
1536(\207)Y
1456(\207)Y
1376(\207)Y
1296(\207)Y
1216(\207)Y
1136(\207)Y
1056(\207)Y
976(\207)Y
896(\207)Y
816(\207)Y
3 f
2155 2288(Table)N
2370(2)X
1589 2384(System)N
1854(Benchmark)X
2274(Tests)X
2472(on)X
2576(a)X
2636(Sun-3/160)X
1462 2480(with)N
1633(4)X
1693(Megabytes)X
2083(of)X
2170(Memory)X
2485(and)X
2633(an)X
2737(Eagle)X
2948(Disk)X
1 f
555 2672(kernel)N
779(ports)X
962(to)X
1046(different)X
1345(uniprocessor)X
1777(and)X
1915(multiprocessor)X
2413(machine)X
2707(bases)X
2903(will)X
3049(provide)X
3316(further)X
3557(understanding)X
555 2768(of)N
642(the)X
760(usability)X
1055(of)X
1142(the)X
1260(abstractions)X
1663(and)X
1799(our)X
1926(success)X
2187(in)X
2269(isolating)X
2564(machine)X
2856(dependencies.)X
755 2892(Other)N
964(future)X
1182(work)X
1373(involves)X
1670(taking)X
1896(advantage)X
2248(of)X
2341(the)X
2465(foundation)X
2838(established)X
3220(with)X
3387(the)X
3510(new)X
3669(VM)X
3823(archi-)X
555 2988(tecture)N
798(\320)X
902(both)X
1068(at)X
1150(the)X
1272(kernel)X
1496(and)X
1635(user)X
1792(level.)X
2011(Specialized)X
2404(segment)X
2694(drivers)X
2940(can)X
3075(be)X
3174(used)X
3344(at)X
3425(the)X
3546(kernel)X
3770(level)X
3949(to)X
555 3084(more)N
751(elegantly)X
1076(support)X
1346(various)X
1612(unique)X
1860(hardware)X
2190(devices)X
2461(and)X
2607(to)X
2699(support)X
2969(new)X
3133(functionality)X
3572(such)X
3749(as)X
3846(map-)X
555 3180(pings)N
750(to)X
834(other)X
1021(address)X
1284(spaces.)X
1556(Shared)X
1801(libraries)X
2086(are)X
2207(an)X
2305(example)X
2599(of)X
2688(the)X
2807(usefulness)X
3162(of)X
3250(mapped)X
3525(\256les)X
3679(at)X
3758(the)X
3877(user)X
555 3276(level.)N
777(We)X
915(expect)X
1151(to)X
1239(\256nd)X
1389(the)X
1513(features)X
1794(of)X
1887(the)X
2011(new)X
2171(VM)X
2326(system)X
2573(used)X
2745(in)X
2832(various)X
3093(new)X
3252(facilities)X
3553(yet)X
3676(to)X
3763(be)X
3864(ima-)X
555 3372(gined.)N
801(As)X
918(new)X
1080(uses)X
1246(for)X
1368(the)X
1494(VM)X
1651(system)X
1900(are)X
2026(better)X
2236(understood,)X
2639(we)X
2760(can)X
2899(re\256ne)X
3109(and)X
3252(complete)X
3573(the)X
3698(interfaces)X
555 3468(that)N
695(have)X
867(not)X
989(yet)X
1107(been)X
1279(fully)X
1450(de\256ned.)X
3 f
555 3660(12.)N
695(Conclusions)X
1 f
755 3784(From)N
948(our)X
1075(experience)X
1444(in)X
1526(implementing)X
1990(the)X
2108(new)X
2262(VM)X
2411(system,)X
2673(we)X
2787(draw)X
2968(the)X
3086(following)X
3417(conclusions.)X
10 f
755 3908(\267)N
3 f
955(Object)X
1216(oriented)X
1530(programming)X
2035(works.)X
1 f
2313(The)X
2467(design)X
2705(of)X
2801(the)X
2928(new)X
3091(VM)X
3249(system)X
3500(was)X
3654(done)X
3838(using)X
955 4004(object-oriented)N
1467(techniques.)X
1876(This)X
2044(provided)X
2355(a)X
2417(coherent)X
2720(framework)X
3099(in)X
3187(which)X
3409(we)X
3529(could)X
3732(view)X
3913(the)X
955 4100(system.)N
10 f
755 4224(\267)N
3 f
955(The)X
1114(balance)X
1402(of)X
1494(responsibility)X
1980(is)X
2058(important.)X
1 f
2470(When)X
2687(partitioning)X
3085(a)X
3146(problem)X
3438(amongst)X
3734(different)X
955 4320(abstractions,)N
1388(it)X
1462(is)X
1545(critical)X
1798(that)X
1948(the)X
2076(system)X
2328(be)X
2434(structured)X
2785(so)X
2886(that)X
3036(each)X
3214(abstraction)X
3596(has)X
3733(the)X
3860(right)X
955 4416(level)N
1132(of)X
1220(responsibility.)X
1716(When)X
1929(an)X
2026(abstraction)X
2399(gets)X
2549(control)X
2797(at)X
2876(the)X
2995(right)X
3167(time)X
3329(it)X
3393(has)X
3520(the)X
3638(opportunity)X
955 4512(to)N
1037(recognize)X
1370(and)X
1506(act)X
1620(on)X
1720(events)X
1945(that)X
2085(make)X
2279(sense)X
2473(for)X
2587(that)X
2727(abstraction.)X
10 f
755 4636(\267)N
3 f
955(The)X
1111(layering)X
1414(in)X
1503(the)X
1632(new)X
1792(VM)X
1948(system)X
2202(is)X
2277(effective.)X
1 f
2626(For)X
2759(example,)X
3073(the)X
2 f
3193(hat)X
1 f
3330(layer)X
3513(provides)X
3811(all)X
3913(the)X
955 4732(machine)N
1256(dependent)X
1615(MMU)X
1844(translation)X
2211(control)X
2467(and)X
2612(has)X
2748(been)X
2929(found)X
3145(to)X
3235(be)X
3339(easily)X
3554(ported)X
3787(to)X
3877(new)X
955 4828(hardware)N
1291(architectures.)X
1778(The)X
1939(use)X
2082(of)X
2185(segment)X
2488(drivers)X
2747(has)X
2890(proven)X
3149(to)X
3247(make)X
3456(the)X
3589(system)X
3846(more)X
955 4924(extensible.)N
10 f
755 5048(\267)N
3 f
955(Performance)X
1423(did)X
1553(not)X
1684(suffer.)X
1 f
1945(Although)X
2267(the)X
2385(new)X
2539(VM)X
2688(system)X
2930(provides)X
3226(considerably)X
3656(more)X
3841(func-)X
955 5144(tionality,)N
1274(it)X
1351(did)X
1485(so)X
1588(without)X
1864(any)X
2012(performance)X
2451(loss.)X
2647(Performance)X
3090(often)X
3287(improved)X
3626(because)X
3913(the)X
955 5240(new)N
1112(VM)X
1263(system)X
1507(better)X
1712(uses)X
1872(memory)X
2161(resources)X
2487(as)X
2576(a)X
2634(cache.)X
2880(By)X
2995(carefully)X
3303(designing)X
3636(the)X
3756(abstrac-)X
955 5336(tions)N
1135(with)X
1302(optimizations)X
1762(for)X
1881(critical)X
2129(functions,)X
2472(we)X
2591(reduced)X
2871(the)X
2994(cost)X
3148(sometimes)X
3515(associated)X
3869(with)X
955 5432(object-oriented)N
1461(techniques)X
1824(to)X
1906(provide)X
2171(clean)X
2361(abstractions)X
2764(that)X
2904(are)X
3023(still)X
3162(ef\256cient.)X
2243 6144(16)N

17 p
%%Page: 17 17
10 s 0 xH 0 xS 1 f
3 f
555 672(13.)N
695(Acknowledgements)X
1 f
755 796(I)N
811(would)X
1040(like)X
1189(to)X
1280(thank)X
1487(Rob)X
1649(Gingell,)X
1938(Dave)X
2137(Labuda,)X
2427(Bill)X
2575(Shannon,)X
2903(and)X
3047(especially)X
3396(Glenn)X
3620(Skinner,)X
3917(for)X
555 892(reviewing)N
899(this)X
1037(paper)X
1239(and)X
1378(helping)X
1641(to)X
1726(make)X
1923(it)X
1990(presentable)X
2379(and)X
2518(for)X
2635(their)X
2805(work)X
2993(with)X
3158(the)X
3279(new)X
3436(VM)X
3588(system.)X
3873(And)X
555 988(most)N
732(of)X
821(all)X
923(I)X
971(would)X
1192(like)X
1333(to)X
1416(give)X
1575(a)X
1632(big)X
1755(thank)X
1954(you)X
2095(to)X
2178(my)X
2301(understanding)X
2776(wife)X
2940(Laurel,)X
3191(who)X
3350(continued)X
3687(to)X
3770(tolerate)X
555 1084(me)N
673(during)X
902(the)X
1020(countless)X
1338(extra)X
1519(hours)X
1717(I)X
1764(put)X
1886(into)X
2030(this)X
2165(project.)X
3 f
555 1276(14.)N
695(References)X
1 f
755 1400([1])N
955(Gingell,)X
1238(R.)X
1334(A.,)X
1455(J.)X
1529(P.)X
1616(Moran,)X
1873(W.)X
1992(A.)X
2093(Shannon,)X
2415(``Virtual)X
2718(Memory)X
3016(Architecture)X
3440(in)X
3524(SunOS'',)X
2 f
3846(Sum-)X
955 1496(mer)N
1100(Conference)X
1490(Proceedings,)X
1931(Phoenix)X
2214(1987)X
1 f
(,)S
2414(USENIX)X
2728(Association,)X
3146(1987.)X
755 1620([2])N
955(Kleiman,)X
1282(S.)X
1377(R.,)X
1501(``Vnodes:)X
1853(An)X
1982(Architecture)X
2415(for)X
2540(Multiple)X
2845(File)X
2999(System)X
3264(Types)X
3490(in)X
3582(Sun)X
3736(UNIX'',)X
2 f
955 1716(Summer)N
1238(Conference)X
1628(Proceedings,)X
2069(Atlanta)X
2324(1986)X
1 f
(,)S
2524(USENIX)X
2838(Association,)X
3256(1986.)X
755 1840([3])N
955(Stroustrup,)X
1350(B.,)X
2 f
1484(The)X
1645(C++)X
1847(Programming)X
2337(Language)X
1 f
(,)S
2718(Addison-Wesley)X
3298(Publishing)X
3680(Company,)X
955 1936(1986.)N
755 2060([4])N
955(Rashid,)X
1230(R.,)X
1356(A.)X
1467(Tevanian,)X
1818(M.)X
1941(Young,)X
2211(D.)X
2321(Golub,)X
2573(R.)X
2678(Baron,)X
2926(D.)X
3036(Black,)X
3275(W.)X
3403(Bolosky,)X
3721(J.)X
3804(Chew,)X
955 2156 0.1937(``Machine-Independent)AN
1743(Virtual)X
1999(Memory)X
2304(Management)X
2752(for)X
2875(Paged)X
3100(Uniprocessor)X
3556(and)X
3700(Multipro-)X
955 2252(cessor)N
1176(Architectures'',)X
2 f
1703(Operating)X
2052(Systems)X
2326(Review)X
1 f
2558(,)X
2598(Volume)X
2876(21,)X
2996(No.)X
3134(4,)X
3214(October,)X
3513(1987.)X
755 2376([5])N
955(Kepecs,)X
1235(J.)X
1309(H.,)X
1430(``Lightweight)X
1898(Processes)X
2233(for)X
2350(UNIX)X
2574(Implementation)X
3104(and)X
3243(Applications'',)X
2 f
3748(Summer)X
955 2472(Conference)N
1345(Proceedings,)X
1786(Portland)X
2090(1985)X
1 f
(,)S
2290(USENIX)X
2604(Association,)X
3022(1985.)X
755 2596([6])N
955(Sun)X
1099(Microsystems)X
1568(Inc.,)X
2 f
1731(Sun-3)X
1938(Architecture:)X
2406(A)X
2475(Sun)X
2615(Technical)X
2951(Report)X
1 f
3169(,)X
3209(1985.)X
755 2720([7])N
955(Cheng,)X
1220(R.,)X
1349(``Virtual)X
1666(Address)X
1965(Cache)X
2202(in)X
9 s
2298(UNIX)X
10 s
('',)S
2 f
2588(Summer)X
2887(Conference)X
3292(Proceedings,)X
3748(Phoenix)X
955 2816(1987)N
1 f
(,)S
1155(USENIX)X
1469(Association,)X
1887(1987.)X
755 2940([8])N
955(McKusick,)X
1341(M.)X
1464(K.,)X
1594(W.)X
1722(N.)X
1832(Joy,)X
1995(S.)X
2091(J.)X
2174(Lef\257er,)X
2445(R.)X
2550(S.)X
2645(Fabry,)X
2883(``A)X
3026(Fast)X
3190(File)X
3345(System)X
3611(for)X
3736(UNIX'',)X
2 f
955 3036(Transactions)N
1392(on)X
1492(Computer)X
1832(Systems)X
1 f
2086(,)X
2126(Volume)X
2404(2,)X
2484(No.)X
2622(3,)X
2702(August,)X
2973(1984.)X
755 3160([9])N
955(Gingell,)X
1247(R.)X
1351(A.,)X
1480(M.)X
1602(Lee,)X
1774(X.)X
1883(T.)X
1983(Dang,)X
2208(M.)X
2330(S.)X
2425(Weeks,)X
2695(``Shared)X
3003(Libraries)X
3324(in)X
3417(SunOS'',)X
2 f
3748(Summer)X
955 3256(Conference)N
1345(Proceedings,)X
1786(Phoenix)X
2069(1987)X
1 f
(,)S
2269(USENIX)X
2583(Association,)X
3001(1987.)X
755 3380([10])N
955(Gingell,)X
1250(R.)X
1358(A.,)X
1491(``Evolution)X
1895(of)X
1997(the)X
2130(SunOS)X
2391(Programming)X
2866(Environment'',)X
2 f
3393(Spring)X
3641(Conference)X
955 3476(Proceedings,)N
1396(London)X
1660(1988)X
1 f
(,)S
1860(EUUG,)X
2123(1988.)X
755 3600([11])N
955(Joy,)X
1117(W.)X
1243(N.,)X
1371(R.)X
1474(S.)X
1568(Fabry,)X
1805(S.)X
1899(J.)X
1980(Lef\257er,)X
2249(M.)X
2370(K.)X
2478(McKusick,)X
2 f
2862(4.2BSD)X
3139(System)X
3392(Manual)X
1 f
3641(,)X
3691(Computer)X
955 3696(Systems)N
1260(Research)X
1594(Group,)X
1858(Computer)X
2216(Science)X
2504(Division,)X
2837(University)X
3213(of)X
3318(California,)X
3701(Berkeley,)X
955 3792(1983.)N
2243 6144(17)N

17 p
%%Trailer
xt

xs



